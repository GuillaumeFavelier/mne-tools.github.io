<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Compute all-to-all connectivity in sensor space &mdash; MNE 0.11.dev0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.11.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="MNE 0.11.dev0 documentation" href="../../index.html" />
    <link rel="up" title="Examples Gallery" href="../index.html" />
    <link rel="next" title="Brainstorm tutorial datasets" href="../datasets/plot_brainstorm_data.html" />
    <link rel="prev" title="Compute Phase Slope Index (PSI) in source space for a visual stimulus" href="plot_mne_inverse_psi_visual.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body role="document">





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/mne_logo_small.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.11.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../tutorials.html">Tutorials</a></li>
                <li><a href="../index.html">Gallery</a></li>
                <li><a href="../../manual/index.html">Manual</a></li>
                <li><a href="../../python_reference.html">API</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
                <li><a href="../../cite.html">Cite</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new.html">What&#8217;s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Cite MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">Related publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manual/index.html">Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_setup.html">Advanced installation and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mne_cpp.html">MNE with CPP</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Compute all-to-all connectivity in sensor space</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Compute all-to-all connectivity in sensor space</a></li>
</ul>

  <li>
    <a href="plot_mne_inverse_psi_visual.html" title="Previous Chapter: Compute Phase Slope Index (PSI) in source space for a visual stimulus"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Compute Phase...</span>
    </a>
  </li>
  <li>
    <a href="../datasets/plot_brainstorm_data.html" title="Next Chapter: Brainstorm tutorial datasets"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Brainstorm tu... &raquo;</span>
    </a>
  </li>
<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12">
      
  <div class="section" id="compute-all-to-all-connectivity-in-sensor-space">
<span id="sphx-glr-auto-examples-connectivity-plot-sensor-connectivity-py"></span><h1>Compute all-to-all connectivity in sensor space<a class="headerlink" href="#compute-all-to-all-connectivity-in-sensor-space" title="Permalink to this headline">Â¶</a></h1>
<p>Computes the Phase Lag Index (PLI) between all gradiometers and shows the
connectivity in 3D using the helmet geometry. The left visual stimulation data
are used which produces strong connectvitiy in the right occipital sensors.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Author: Martin Luessi &lt;mluessi@nmr.mgh.harvard.edu&gt;</span>
<span class="c">#</span>
<span class="c"># License: BSD (3-clause)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne</span> <span class="kn">import</span> <span class="n">io</span>
<span class="kn">from</span> <span class="nn">mne.connectivity</span> <span class="kn">import</span> <a href="../../generated/mne.connectivity.spectral_connectivity.html#mne.connectivity.spectral_connectivity"><span class="n">spectral_connectivity</span></a>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">sample</span>

<span class="k">print</span><span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-horizontal">Set parameters</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">data_path</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">data_path</span><span class="p">()</span>
<span class="n">raw_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis_filt-0-40_raw.fif&#39;</span>
<span class="n">event_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis_filt-0-40_raw-eve.fif&#39;</span>

<span class="c"># Setup for reading the raw data</span>
<span class="n">raw</span> <span class="o">=</span> <a href="../../generated/mne.io.Raw.html#mne.io.Raw"><span class="n">io</span><span class="o">.</span><span class="n">Raw</span></a><span class="p">(</span><span class="n">raw_fname</span><span class="p">)</span>
<span class="n">events</span> <span class="o">=</span> <a href="../../generated/mne.read_events.html#mne.read_events"><span class="n">mne</span><span class="o">.</span><span class="n">read_events</span></a><span class="p">(</span><span class="n">event_fname</span><span class="p">)</span>

<span class="c"># Add a bad channel</span>
<span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s">&#39;bads&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&#39;MEG 2443&#39;</span><span class="p">]</span>

<span class="c"># Pick MEG gradiometers</span>
<span class="n">picks</span> <span class="o">=</span> <a href="../../generated/mne.pick_types.html#mne.pick_types"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="s">&#39;grad&#39;</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">exclude</span><span class="o">=</span><span class="s">&#39;bads&#39;</span><span class="p">)</span>

<span class="c"># Create epochs for the visual condition</span>
<span class="n">event_id</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="n">epochs</span> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">event_id</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span>
                    <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">reject</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">grad</span><span class="o">=</span><span class="mf">4000e-13</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="mf">150e-6</span><span class="p">))</span>

<span class="c"># Compute connectivity for band containing the evoked response.</span>
<span class="c"># We exclude the baseline period</span>
<span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span> <span class="o">=</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">9.</span>
<span class="n">sfreq</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s">&#39;sfreq&#39;</span><span class="p">]</span>  <span class="c"># the sampling frequency</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c"># exclude the baseline period</span>
<span class="n">con</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">n_epochs</span><span class="p">,</span> <span class="n">n_tapers</span> <span class="o">=</span> <a href="../../generated/mne.connectivity.spectral_connectivity.html#mne.connectivity.spectral_connectivity"><span class="n">spectral_connectivity</span></a><span class="p">(</span>
    <span class="n">epochs</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;pli&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;multitaper&#39;</span><span class="p">,</span> <span class="n">sfreq</span><span class="o">=</span><span class="n">sfreq</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span>
    <span class="n">faverage</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span> <span class="n">mt_adaptive</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c"># the epochs contain an EOG channel, which we remove now</span>
<span class="n">ch_names</span> <span class="o">=</span> <span class="n">epochs</span><span class="o">.</span><span class="n">ch_names</span>
<span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">ch_names</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;MEG&#39;</span><span class="p">)]</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">con</span><span class="p">[</span><span class="n">idx</span><span class="p">][:,</span> <span class="n">idx</span><span class="p">]</span>

<span class="c"># con is a 3D array where the last dimension is size one since we averaged</span>
<span class="c"># over frequencies in a single band. Here we make it 2D</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">con</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c"># Now, visualize the connectivity in 3D</span>
<span class="kn">from</span> <span class="nn">mayavi</span> <span class="kn">import</span> <span class="n">mlab</span>  <span class="c"># noqa</span>

<a href="http://docs.enthought.com/mayavi/mayavi/auto/mlab_figure.html#mayavi.mlab.figure"><span class="n">mlab</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

<span class="c"># Plot the sensor locations</span>
<span class="n">sens_loc</span> <span class="o">=</span> <span class="p">[</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s">&#39;chs&#39;</span><span class="p">][</span><span class="n">picks</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s">&#39;loc&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">]</span>
<span class="n">sens_loc</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="n">sens_loc</span><span class="p">)</span>

<span class="n">pts</span> <span class="o">=</span> <a href="http://docs.enthought.com/mayavi/mayavi/auto/mlab_helper_functions.html#mayavi.mlab.points3d"><span class="n">mlab</span><span class="o">.</span><span class="n">points3d</span></a><span class="p">(</span><span class="n">sens_loc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sens_loc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sens_loc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span>

<span class="c"># Get the strongest connections</span>
<span class="n">n_con</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c"># show up to 20 connections</span>
<span class="n">min_dist</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c"># exclude sensors that are less than 5cm apart</span>
<span class="n">threshold</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.sort.html#numpy.sort"><span class="n">np</span><span class="o">.</span><span class="n">sort</span></a><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">)[</span><span class="o">-</span><span class="n">n_con</span><span class="p">]</span>
<span class="n">ii</span><span class="p">,</span> <span class="n">jj</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.where.html#numpy.where"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">con</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">)</span>

<span class="c"># Remove close connections</span>
<span class="n">con_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">con_val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">):</span>
    <span class="k">if</span> <a href="http://docs.scipy.org/doc/scipy-0.11.0/reference/generated/scipy.linalg.norm.html#scipy.linalg.norm"><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span></a><span class="p">(</span><span class="n">sens_loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">sens_loc</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">min_dist</span><span class="p">:</span>
        <span class="n">con_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
        <span class="n">con_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>

<span class="n">con_val</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="n">con_val</span><span class="p">)</span>

<span class="c"># Show the connections as tubes between sensors</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">con_val</span><span class="p">)</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">con_val</span><span class="p">)</span>
<span class="k">for</span> <span class="n">val</span><span class="p">,</span> <span class="n">nodes</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">con_val</span><span class="p">,</span> <span class="n">con_nodes</span><span class="p">):</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">sens_loc</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="n">sens_loc</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">points</span> <span class="o">=</span> <a href="http://docs.enthought.com/mayavi/mayavi/auto/mlab_helper_functions.html#mayavi.mlab.plot3d"><span class="n">mlab</span><span class="o">.</span><span class="n">plot3d</span></a><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span> <span class="p">[</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">],</span> <span class="p">[</span><span class="n">val</span><span class="p">,</span> <span class="n">val</span><span class="p">],</span>
                         <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">tube_radius</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
                         <span class="n">colormap</span><span class="o">=</span><span class="s">&#39;RdBu&#39;</span><span class="p">)</span>
    <span class="n">points</span><span class="o">.</span><span class="n">module_manager</span><span class="o">.</span><span class="n">scalar_lut_manager</span><span class="o">.</span><span class="n">reverse_lut</span> <span class="o">=</span> <span class="bp">True</span>


<a href="http://docs.enthought.com/mayavi/mayavi/auto/mlab_decorations.html#mayavi.mlab.scalarbar"><span class="n">mlab</span><span class="o">.</span><span class="n">scalarbar</span></a><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;Phase Lag Index (PLI)&#39;</span><span class="p">,</span> <span class="n">nb_labels</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c"># Add the sensor names for the connections shown</span>
<span class="n">nodes_shown</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">con_nodes</span><span class="p">]</span> <span class="o">+</span>
                       <span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">con_nodes</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes_shown</span><span class="p">:</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">sens_loc</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
    <a href="http://docs.enthought.com/mayavi/mayavi/auto/mlab_other_functions.html#mayavi.mlab.text3d"><span class="n">mlab</span><span class="o">.</span><span class="n">text3d</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">ch_names</span><span class="p">[</span><span class="n">picks</span><span class="p">[</span><span class="n">node</span><span class="p">]],</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">view</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">88.7</span><span class="p">,</span> <span class="mf">40.8</span><span class="p">,</span> <span class="mf">0.76</span><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="o">-</span><span class="mf">3.9e-4</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.5e-3</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e-2</span><span class="p">]))</span>
<a href="http://docs.enthought.com/mayavi/mayavi/auto/mlab_camera.html#mayavi.mlab.view"><span class="n">mlab</span><span class="o">.</span><span class="n">view</span></a><span class="p">(</span><span class="o">*</span><span class="n">view</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_sensor_connectivity_000.png" class="align-center" src="../../_images/sphx_glr_plot_sensor_connectivity_000.png" />
<p><strong>Script output</strong>:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre>Opening raw data file /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/sample_audvis_filt-0-40_raw.fif...
    Read a total of 4 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
        Average EEG reference (1 x 60)  idle
Current compensation grade : 0
    Range : 6450 ... 48149 =     42.956 ...   320.665 secs
Ready.
73 matching events found
4 projection items activated
Connectivity computation...
Reading 606 ... 711  =      4.036 ...     4.735 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 1026 ... 1131  =      6.833 ...     7.532 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for 20706 connections
    using t=0.000s..0.699s for estimation (106 points)
    frequencies: 4.2Hz..8.5Hz (4 points)
    connectivity scores will be averaged for each band
    using multitaper spectrum estimation with 7 DPSS windows
    the following metrics will be computed: PLI
    computing connectivity for epochs 1..2
Reading 1436 ... 1541  =      9.564 ...    10.263 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 1851 ... 1956  =     12.327 ...    13.027 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 3..4
Reading 2259 ... 2364  =     15.045 ...    15.744 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 2664 ... 2769  =     17.742 ...    18.441 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 5..6
Reading 3101 ... 3206  =     20.652 ...    21.351 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 3501 ... 3606  =     23.316 ...    24.015 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 7..8
Reading 3931 ... 4036  =     26.180 ...    26.879 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 4356 ... 4461  =     29.010 ...    29.710 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 9..10
Reading 4798 ... 4903  =     31.954 ...    32.653 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 5191 ... 5296  =     34.571 ...    35.271 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 5591 ... 5696  =     37.235 ...    37.934 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 11..12
Reading 5994 ... 6099  =     39.919 ...    40.618 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 6799 ... 6904  =     45.280 ...    45.980 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 13..14
Reading 7194 ... 7299  =     47.911 ...    48.610 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 7587 ... 7692  =     50.528 ...    51.227 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 15..16
Reading 8039 ... 8144  =     53.538 ...    54.238 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 8454 ... 8559  =     56.302 ...    57.002 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 17..18
Reading 8884 ... 8989  =     59.166 ...    59.865 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 9287 ... 9392  =     61.850 ...    62.549 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 9712 ... 9817  =     64.680 ...    65.380 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 10154 ... 10259  =     67.624 ...    68.323 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 19..20
Reading 10569 ... 10674  =     70.388 ...    71.087 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 10984 ... 11089  =     73.152 ...    73.851 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 21..22
Reading 11422 ... 11527  =     76.069 ...    76.768 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 11834 ... 11939  =     78.813 ...    79.512 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 23..24
Reading 12249 ... 12354  =     81.576 ...    82.276 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 12639 ... 12744  =     84.174 ...    84.873 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 25..26
Reading 13052 ... 13157  =     86.924 ...    87.624 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 13474 ... 13579  =     89.735 ...    90.434 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 27..28
Reading 13880 ... 13985  =     92.439 ...    93.138 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 14307 ... 14412  =     95.282 ...    95.982 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 29..30
Reading 15150 ... 15255  =    100.897 ...   101.596 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 15557 ... 15662  =    103.607 ...   104.306 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 31..32
Reading 16007 ... 16112  =    106.604 ...   107.303 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 16420 ... 16525  =    109.355 ...   110.054 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 33..34
Reading 16837 ... 16942  =    112.132 ...   112.831 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 17260 ... 17365  =    114.949 ...   115.648 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 35..36
Reading 17717 ... 17822  =    117.992 ...   118.692 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 18144 ... 18249  =    120.836 ...   121.535 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 37..38
Reading 18559 ... 18664  =    123.600 ...   124.299 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 18997 ... 19102  =    126.517 ...   127.216 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 19417 ... 19522  =    129.314 ...   130.013 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 39..40
Reading 19857 ... 19962  =    132.244 ...   132.944 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 20267 ... 20372  =    134.975 ...   135.674 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 41..42
Reading 20674 ... 20779  =    137.686 ...   138.385 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 21072 ... 21177  =    140.336 ...   141.035 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 43..44
Reading 21479 ... 21584  =    143.047 ...   143.746 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 21917 ... 22022  =    145.964 ...   146.663 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 45..46
Reading 22310 ... 22415  =    148.581 ...   149.280 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 22752 ... 22857  =    151.525 ...   152.224 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 47..48
Reading 23140 ... 23245  =    154.109 ...   154.808 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 23547 ... 23652  =    156.819 ...   157.519 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 23970 ... 24075  =    159.636 ...   160.336 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 49..50
Reading 24382 ... 24487  =    162.380 ...   163.080 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 24845 ... 24950  =    165.464 ...   166.163 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 51..52
Reading 25257 ... 25362  =    168.208 ...   168.907 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 25647 ... 25752  =    170.805 ...   171.504 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 53..54
Reading 26047 ... 26152  =    173.469 ...   174.168 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 26438 ... 26543  =    176.073 ...   176.772 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 55..56
Reading 26882 ... 26987  =    179.030 ...   179.729 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 27295 ... 27400  =    181.780 ...   182.480 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 57..58
Reading 27700 ... 27805  =    184.478 ...   185.177 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 28123 ... 28228  =    187.295 ...   187.994 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 28567 ... 28672  =    190.252 ...   190.951 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 59..60
Reading 29015 ... 29120  =    193.235 ...   193.935 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 29437 ... 29542  =    196.046 ...   196.745 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 61..62
Reading 29842 ... 29947  =    198.743 ...   199.442 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 30272 ... 30377  =    201.607 ...   202.306 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 63..64
Reading 30700 ... 30805  =    204.457 ...   205.156 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 31127 ... 31232  =    207.301 ...   208.000 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 65..66
Reading 31940 ... 32045  =    212.715 ...   213.415 secs...
[done]
Applying baseline correction ... (mode: mean)
    computing connectivity for epochs 67..67
    assembling connectivity matrix
[Connectivity computation done]
</pre></div>
</div>
<p><strong>Total running time of the script:</strong>
(0 minutes 10.600 seconds)</p>
<p><strong>Download Python source code:</strong> <a class="reference download internal" href="../../_downloads/plot_sensor_connectivity.py"><code class="xref download docutils literal"><span class="pre">plot_sensor_connectivity.py</span></code></a></p>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2012-2015, MNE Developers.<br/>
    </p>
  </div>
</footer>
  </body>
</html>