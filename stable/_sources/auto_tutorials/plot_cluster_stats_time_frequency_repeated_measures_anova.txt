

.. _sphx_glr_auto_tutorials_plot_cluster_stats_time_frequency_repeated_measures_anova.py:


.. _tut_stats_cluster_sensor_rANOVA_tfr

====================================================================
Mass-univariate twoway repeated measures ANOVA on single trial power
====================================================================

This script shows how to conduct a mass-univariate repeated measures
ANOVA. As the model to be fitted assumes two fully crossed factors,
we will study the interplay between perceptual modality
(auditory VS visual) and the location of stimulus presentation
(left VS right). Here we use single trials as replications
(subjects) while iterating over time slices plus frequency bands
for to fit our mass-univariate model. For the sake of simplicity we
will confine this analysis to one single channel of which we know
that it exposes a strong induced response. We will then visualize
each effect by creating a corresponding mass-univariate effect
image. We conclude with accounting for multiple comparisons by
performing a permutation clustering test using the ANOVA as
clustering function. The results final will be compared to
multiple comparisons using False Discovery Rate correction.


.. code-block:: python

    # Authors: Denis Engemann <denis.engemann@gmail.com>
    #          Eric Larson <larson.eric.d@gmail.com>
    #          Alexandre Gramfort <alexandre.gramfort@telecom-paristech.fr>
    #
    # License: BSD (3-clause)

    import numpy as np
    import matplotlib.pyplot as plt

    import mne
    from mne import io
    from mne.time_frequency import single_trial_power
    from mne.stats import f_threshold_mway_rm, f_mway_rm, fdr_correction
    from mne.datasets import sample

    print(__doc__)




.. rst-class:: sphx-glr-horizontal





Set parameters


.. code-block:: python

    data_path = sample.data_path()
    raw_fname = data_path + '/MEG/sample/sample_audvis_raw.fif'
    event_fname = data_path + '/MEG/sample/sample_audvis_raw-eve.fif'
    event_id = 1
    tmin = -0.2
    tmax = 0.5

    # Setup for reading the raw data
    raw = io.Raw(raw_fname)
    events = mne.read_events(event_fname)

    include = []
    raw.info['bads'] += ['MEG 2443']  # bads

    # picks MEG gradiometers
    picks = mne.pick_types(raw.info, meg='grad', eeg=False, eog=True,
                           stim=False, include=include, exclude='bads')

    ch_name = raw.info['ch_names'][picks[0]]

    # Load conditions
    reject = dict(grad=4000e-13, eog=150e-6)
    event_id = dict(aud_l=1, aud_r=2, vis_l=3, vis_r=4)
    epochs = mne.Epochs(raw, events, event_id, tmin, tmax,
                        picks=picks, baseline=(None, 0),
                        reject=reject)

    # make sure all conditions have the same counts, as the ANOVA expects a
    # fully balanced data matrix and does not forgive imbalances that generously
    # (risk of type-I error)
    epochs.equalize_event_counts(event_id, copy=False)
    # Time vector
    times = 1e3 * epochs.times  # change unit to ms

    # Factor to downs-sample the temporal dimension of the PSD computed by
    # single_trial_power.
    decim = 2
    frequencies = np.arange(7, 30, 3)  # define frequencies of interest
    sfreq = raw.info['sfreq']  # sampling in Hz
    n_cycles = frequencies / frequencies[0]
    baseline_mask = times[::decim] < 0

    # now create TFR representations for all conditions
    epochs_power = []
    for condition in [epochs[k].get_data()[:, 97:98, :] for k in event_id]:
        this_power = single_trial_power(condition, sfreq=sfreq,
                                        frequencies=frequencies, n_cycles=n_cycles,
                                        decim=decim)
        this_power = this_power[:, 0, :, :]  # we only have one channel.
        # Compute ratio with baseline power (be sure to correct time vector with
        # decimation factor)
        epochs_baseline = np.mean(this_power[:, :, baseline_mask], axis=2)
        this_power /= epochs_baseline[..., np.newaxis]
        epochs_power.append(this_power)




.. rst-class:: sphx-glr-horizontal



**Script output**:

.. rst-class:: sphx-glr-script-out

  ::

    Opening raw data file /home/jaakko/examples/MNE-sample-data/MEG/sample/sample_audvis_raw.fif...
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
    Current compensation grade : 0
        Range : 25800 ... 192599 =     42.956 ...   320.670 secs
    Ready.
    Adding average EEG reference projection.
    1 projection items deactivated
    289 matching events found
    4 projection items activated
    Reading 2057 ... 2477  =      3.425 ...     4.124 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 2425 ... 2845  =      4.038 ...     4.737 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 2851 ... 3271  =      4.747 ...     5.446 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 3299 ... 3719  =      5.493 ...     6.192 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 3732 ... 4152  =      6.214 ...     6.913 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 4105 ... 4525  =      6.835 ...     7.534 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 4530 ... 4950  =      7.542 ...     8.242 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 4919 ... 5339  =      8.190 ...     8.889 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 5320 ... 5740  =      8.858 ...     9.557 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 5745 ... 6165  =      9.565 ...    10.264 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 6181 ... 6601  =     10.291 ...    10.990 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 6599 ... 7019  =     10.987 ...    11.686 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 7015 ... 7435  =     11.680 ...    12.379 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 7405 ... 7825  =     12.329 ...    13.028 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 7792 ... 8212  =     12.973 ...    13.673 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 8612 ... 9032  =     14.339 ...    15.038 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 9036 ... 9456  =     15.045 ...    15.744 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 9508 ... 9928  =     15.830 ...    16.530 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 9930 ... 10350  =     16.533 ...    17.232 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 10291 ... 10711  =     17.134 ...    17.833 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 10656 ... 11076  =     17.742 ...    18.441 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 11087 ... 11507  =     18.459 ...    19.159 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 11540 ... 11960  =     19.214 ...    19.913 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 11990 ... 12410  =     19.963 ...    20.662 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 12406 ... 12826  =     20.655 ...    21.355 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 12791 ... 13211  =     21.297 ...    21.996 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 13210 ... 13630  =     21.994 ...    22.693 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 13643 ... 14063  =     22.715 ...    23.414 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 14006 ... 14426  =     23.319 ...    24.019 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 14485 ... 14905  =     24.117 ...    24.816 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 14960 ... 15380  =     24.908 ...    25.607 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 15340 ... 15760  =     25.540 ...    26.240 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 15726 ... 16146  =     26.183 ...    26.882 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 16206 ... 16626  =     26.982 ...    27.682 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 17040 ... 17460  =     28.371 ...    29.070 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 17426 ... 17846  =     29.014 ...    29.713 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 17861 ... 18281  =     29.738 ...    30.437 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 18250 ... 18670  =     30.386 ...    31.085 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 18729 ... 19149  =     31.183 ...    31.882 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 19195 ... 19615  =     31.959 ...    32.658 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 19566 ... 19986  =     32.577 ...    33.276 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 19940 ... 20360  =     33.199 ...    33.899 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 20320 ... 20740  =     33.832 ...    34.531 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 20766 ... 21186  =     34.575 ...    35.274 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 21175 ... 21595  =     35.256 ...    35.955 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 21610 ... 22030  =     35.980 ...    36.679 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 21975 ... 22395  =     36.587 ...    37.287 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 22367 ... 22787  =     37.240 ...    37.939 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 22802 ... 23222  =     37.964 ...    38.664 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 23181 ... 23601  =     38.595 ...    39.295 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 23549 ... 23969  =     39.208 ...    39.907 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 23977 ... 24397  =     39.921 ...    40.620 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 24349 ... 24769  =     40.540 ...    41.239 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 24762 ... 25182  =     41.228 ...    41.927 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 25126 ... 25546  =     41.834 ...    42.533 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 25961 ... 26381  =     43.224 ...    43.923 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 26332 ... 26752  =     43.842 ...    44.541 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 26755 ... 27175  =     44.546 ...    45.245 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 27198 ... 27618  =     45.284 ...    45.983 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 27574 ... 27994  =     45.910 ...    46.609 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 27992 ... 28412  =     46.606 ...    47.305 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 28400 ... 28820  =     47.285 ...    47.984 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 28779 ... 29199  =     47.916 ...    48.615 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 29180 ... 29600  =     48.584 ...    49.283 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 29543 ... 29963  =     49.188 ...    49.887 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 29958 ... 30378  =     49.879 ...    50.578 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 30349 ... 30769  =     50.530 ...    51.229 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 30797 ... 31217  =     51.276 ...    51.975 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 31263 ... 31683  =     52.052 ...    52.751 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 31692 ... 32112  =     52.766 ...    53.465 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32159 ... 32579  =     53.543 ...    54.243 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32528 ... 32948  =     54.158 ...    54.857 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32993 ... 33413  =     54.932 ...    55.631 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 33819 ... 34239  =     56.307 ...    57.007 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 34209 ... 34629  =     56.957 ...    57.656 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 34643 ... 35063  =     57.679 ...    58.378 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 35115 ... 35535  =     58.465 ...    59.164 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 35538 ... 35958  =     59.169 ...    59.869 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 35948 ... 36368  =     59.852 ...    60.551 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 36363 ... 36783  =     60.543 ...    61.242 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 36762 ... 37182  =     61.207 ...    61.907 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 37149 ... 37569  =     61.852 ...    62.551 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 37612 ... 38032  =     62.622 ...    63.322 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 38003 ... 38423  =     63.273 ...    63.973 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 38467 ... 38887  =     64.046 ...    64.745 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 38849 ... 39269  =     64.682 ...    65.381 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 39261 ... 39681  =     65.368 ...    66.067 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 39723 ... 40143  =     66.137 ...    66.836 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 40151 ... 40571  =     66.850 ...    67.549 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 40618 ... 41038  =     67.627 ...    68.327 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 41044 ... 41464  =     68.337 ...    69.036 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 41891 ... 42311  =     69.747 ...    70.446 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 42278 ... 42698  =     70.391 ...    71.090 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 42746 ... 43166  =     71.170 ...    71.870 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 43143 ... 43563  =     71.831 ...    72.531 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 43538 ... 43958  =     72.489 ...    73.188 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 43939 ... 44359  =     73.157 ...    73.856 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 44339 ... 44759  =     73.823 ...    74.522 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 44743 ... 45163  =     74.495 ...    75.195 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 45208 ... 45628  =     75.270 ...    75.969 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 45688 ... 46108  =     76.069 ...    76.768 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 46071 ... 46491  =     76.706 ...    77.406 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 46522 ... 46942  =     77.457 ...    78.157 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 46904 ... 47324  =     78.093 ...    78.793 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 47338 ... 47758  =     78.816 ...    79.515 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 47798 ... 48218  =     79.582 ...    80.281 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 48252 ... 48672  =     80.338 ...    81.037 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 48620 ... 49040  =     80.950 ...    81.650 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 48999 ... 49419  =     81.581 ...    82.281 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 49804 ... 50224  =     82.922 ...    83.621 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 50166 ... 50586  =     83.524 ...    84.224 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 50559 ... 50979  =     84.179 ...    84.878 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 50974 ... 51394  =     84.870 ...    85.569 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 51384 ... 51804  =     85.552 ...    86.252 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 51762 ... 52182  =     86.182 ...    86.881 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 52210 ... 52630  =     86.928 ...    87.627 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 52619 ... 53039  =     87.609 ...    88.308 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 53014 ... 53434  =     88.266 ...    88.965 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 53441 ... 53861  =     88.977 ...    89.676 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 53899 ... 54319  =     89.740 ...    90.439 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 54289 ... 54709  =     90.389 ...    91.088 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 54704 ... 55124  =     91.080 ...    91.779 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 55097 ... 55517  =     91.734 ...    92.434 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 55520 ... 55940  =     92.439 ...    93.138 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 55991 ... 56411  =     93.223 ...    93.922 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 56414 ... 56834  =     93.927 ...    94.626 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 56795 ... 57215  =     94.561 ...    95.261 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 57230 ... 57650  =     95.286 ...    95.985 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 57648 ... 58068  =     95.982 ...    96.681 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 58064 ... 58484  =     96.674 ...    97.374 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 58526 ... 58946  =     97.443 ...    98.143 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 59379 ... 59799  =     98.864 ...    99.563 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 59744 ... 60164  =     99.471 ...   100.171 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 60187 ... 60607  =    100.209 ...   100.908 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 60600 ... 61020  =    100.897 ...   101.596 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 61051 ... 61471  =    101.647 ...   102.347 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 61434 ... 61854  =    102.285 ...   102.984 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 61804 ... 62224  =    102.901 ...   103.600 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 62230 ... 62650  =    103.610 ...   104.310 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 62673 ... 63093  =    104.348 ...   105.047 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 63104 ... 63524  =    105.066 ...   105.765 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 63576 ... 63996  =    105.852 ...   106.551 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 64029 ... 64449  =    106.606 ...   107.305 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 64499 ... 64919  =    107.388 ...   108.088 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 64893 ... 65313  =    108.044 ...   108.744 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 65274 ... 65694  =    108.679 ...   109.378 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 65680 ... 66100  =    109.355 ...   110.054 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 66118 ... 66538  =    110.084 ...   110.783 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 66494 ... 66914  =    110.710 ...   111.409 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 67350 ... 67770  =    112.135 ...   112.834 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 67749 ... 68169  =    112.799 ...   113.499 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 68174 ... 68594  =    113.507 ...   114.206 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 68621 ... 69041  =    114.251 ...   114.951 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 69040 ... 69460  =    114.949 ...   115.648 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 69515 ... 69935  =    115.740 ...   116.439 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 69963 ... 70383  =    116.486 ...   117.185 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 70409 ... 70829  =    117.228 ...   117.927 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 70869 ... 71289  =    117.994 ...   118.693 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 71314 ... 71734  =    118.735 ...   119.434 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 71783 ... 72203  =    119.516 ...   120.215 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 72193 ... 72613  =    120.198 ...   120.898 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 72579 ... 72999  =    120.841 ...   121.540 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 72983 ... 73403  =    121.514 ...   122.213 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 73443 ... 73863  =    122.280 ...   122.979 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 73875 ... 74295  =    122.999 ...   123.698 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 74239 ... 74659  =    123.605 ...   124.304 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 74700 ... 75120  =    124.373 ...   125.072 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 75548 ... 75968  =    125.784 ...   126.484 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 75988 ... 76408  =    126.517 ...   127.216 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 76368 ... 76788  =    127.150 ...   127.849 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 76793 ... 77213  =    127.857 ...   128.557 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 77272 ... 77692  =    128.655 ...   129.354 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 77668 ... 78088  =    129.314 ...   130.013 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 78113 ... 78533  =    130.055 ...   130.754 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 78513 ... 78933  =    130.721 ...   131.420 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 78989 ... 79409  =    131.514 ...   132.213 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 79428 ... 79848  =    132.244 ...   132.944 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 79840 ... 80260  =    132.930 ...   133.630 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 80252 ... 80672  =    133.616 ...   134.316 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 80700 ... 81120  =    134.362 ...   135.062 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 81068 ... 81488  =    134.975 ...   135.674 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 81435 ... 81855  =    135.586 ...   136.285 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 81823 ... 82243  =    136.232 ...   136.931 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 82250 ... 82670  =    136.943 ...   137.642 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 82699 ... 83119  =    137.691 ...   138.390 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 83444 ... 83864  =    138.931 ...   139.630 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 83821 ... 84241  =    139.559 ...   140.258 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 84289 ... 84709  =    140.338 ...   141.037 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 84654 ... 85074  =    140.946 ...   141.645 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 85084 ... 85504  =    141.661 ...   142.361 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 85520 ... 85940  =    142.387 ...   143.087 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 85919 ... 86339  =    143.052 ...   143.751 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 86372 ... 86792  =    143.806 ...   144.505 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 86823 ... 87243  =    144.557 ...   145.256 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 87220 ... 87640  =    145.218 ...   145.917 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 87669 ... 88089  =    145.965 ...   146.665 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 88032 ... 88452  =    146.570 ...   147.269 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 88404 ... 88824  =    147.189 ...   147.888 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 88820 ... 89240  =    147.882 ...   148.581 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 89240 ... 89660  =    148.581 ...   149.280 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 89699 ... 90119  =    149.345 ...   150.045 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 90163 ... 90583  =    150.118 ...   150.817 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 90607 ... 91027  =    150.857 ...   151.556 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 91009 ... 91429  =    151.526 ...   152.226 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 91384 ... 91804  =    152.151 ...   152.850 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 91794 ... 92214  =    152.833 ...   153.533 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 92560 ... 92980  =    154.109 ...   154.808 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 92959 ... 93379  =    154.773 ...   155.472 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 93315 ... 93735  =    155.366 ...   156.065 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 93776 ... 94196  =    156.133 ...   156.833 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 94190 ... 94610  =    156.823 ...   157.522 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 94619 ... 95039  =    157.537 ...   158.236 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 95064 ... 95484  =    158.278 ...   158.977 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 95472 ... 95892  =    158.957 ...   159.656 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 95880 ... 96300  =    159.636 ...   160.336 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 96298 ... 96718  =    160.332 ...   161.032 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 96764 ... 97184  =    161.108 ...   161.807 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 97145 ... 97565  =    161.743 ...   162.442 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 97531 ... 97951  =    162.385 ...   163.085 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 98011 ... 98431  =    163.184 ...   163.884 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 98484 ... 98904  =    163.972 ...   164.671 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 98910 ... 99330  =    164.681 ...   165.380 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 99380 ... 99800  =    165.464 ...   166.163 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 99789 ... 100209  =    166.145 ...   166.844 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 100626 ... 101046  =    167.538 ...   168.238 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 101030 ... 101450  =    168.211 ...   168.910 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 101411 ... 101831  =    168.845 ...   169.545 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 101785 ... 102205  =    169.468 ...   170.167 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 102155 ... 102575  =    170.084 ...   170.783 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 102591 ... 103011  =    170.810 ...   171.509 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 103005 ... 103425  =    171.499 ...   172.198 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 103365 ... 103785  =    172.099 ...   172.798 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 103812 ... 104232  =    172.843 ...   173.542 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 104191 ... 104611  =    173.474 ...   174.173 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 104575 ... 104995  =    174.113 ...   174.812 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 104956 ... 105376  =    174.748 ...   175.447 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 105333 ... 105753  =    175.375 ...   176.075 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 105752 ... 106172  =    176.073 ...   176.772 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 106161 ... 106581  =    176.754 ...   177.453 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 106636 ... 107056  =    177.545 ...   178.244 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 107054 ... 107474  =    178.241 ...   178.940 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 107531 ... 107951  =    179.035 ...   179.734 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 108396 ... 108816  =    180.475 ...   181.174 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 108809 ... 109229  =    181.163 ...   181.862 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 109181 ... 109601  =    181.782 ...   182.481 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 109613 ... 110033  =    182.501 ...   183.201 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 109996 ... 110416  =    183.139 ...   183.838 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 110365 ... 110785  =    183.753 ...   184.453 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 110802 ... 111222  =    184.481 ...   185.180 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 111213 ... 111633  =    185.165 ...   185.864 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 111656 ... 112076  =    185.903 ...   186.602 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 112073 ... 112493  =    186.597 ...   187.296 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 112492 ... 112912  =    187.295 ...   187.994 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 112916 ... 113336  =    188.001 ...   188.700 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 113386 ... 113806  =    188.783 ...   189.482 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 113817 ... 114237  =    189.501 ...   190.200 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 114271 ... 114691  =    190.257 ...   190.956 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 114692 ... 115112  =    190.958 ...   191.657 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 115165 ... 115585  =    191.745 ...   192.444 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 115642 ... 116062  =    192.539 ...   193.239 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 116061 ... 116481  =    193.237 ...   193.936 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 116906 ... 117326  =    194.644 ...   195.343 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 117298 ... 117718  =    195.296 ...   195.996 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 117751 ... 118171  =    196.051 ...   196.750 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 118151 ... 118571  =    196.717 ...   197.416 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 118625 ... 119045  =    197.506 ...   198.205 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 118996 ... 119416  =    198.124 ...   198.823 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 119371 ... 119791  =    198.748 ...   199.447 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 119746 ... 120166  =    199.372 ...   200.072 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 120165 ... 120585  =    200.070 ...   200.769 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 120625 ... 121045  =    200.836 ...   201.535 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 121091 ... 121511  =    201.612 ...   202.311 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 121538 ... 121958  =    202.356 ...   203.055 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 121935 ... 122355  =    203.017 ...   203.716 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 122384 ... 122804  =    203.764 ...   204.464 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 122801 ... 123221  =    204.459 ...   205.158 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 123242 ... 123662  =    205.193 ...   205.892 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 123635 ... 124055  =    205.847 ...   206.547 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 124069 ... 124489  =    206.570 ...   207.269 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 124510 ... 124930  =    207.304 ...   208.003 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 124952 ... 125372  =    208.040 ...   208.739 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 125345 ... 125765  =    208.694 ...   209.394 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 125706 ... 126126  =    209.295 ...   209.995 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 126506 ... 126926  =    210.627 ...   211.327 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 126905 ... 127325  =    211.292 ...   211.991 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 127291 ... 127711  =    211.934 ...   212.634 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 127761 ... 128181  =    212.717 ...   213.416 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 128160 ... 128580  =    213.381 ...   214.081 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 128566 ... 128986  =    214.057 ...   214.757 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    53 bad epochs dropped
    Dropped 12 epochs
    Reading 3732 ... 4152  =      6.214 ...     6.913 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 5320 ... 5740  =      8.858 ...     9.557 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 7015 ... 7435  =     11.680 ...    12.379 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 10291 ... 10711  =     17.134 ...    17.833 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 11990 ... 12410  =     19.963 ...    20.662 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 13643 ... 14063  =     22.715 ...    23.414 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 15340 ... 15760  =     25.540 ...    26.240 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 20320 ... 20740  =     33.832 ...    34.531 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 21975 ... 22395  =     36.587 ...    37.287 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 23549 ... 23969  =     39.208 ...    39.907 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 25126 ... 25546  =     41.834 ...    42.533 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 26755 ... 27175  =     44.546 ...    45.245 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 28400 ... 28820  =     47.285 ...    47.984 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 29958 ... 30378  =     49.879 ...    50.578 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 31692 ... 32112  =     52.766 ...    53.465 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 36762 ... 37182  =     61.207 ...    61.907 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 38467 ... 38887  =     64.046 ...    64.745 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 40151 ... 40571  =     66.850 ...    67.549 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 41891 ... 42311  =     69.747 ...    70.446 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 43538 ... 43958  =     72.489 ...    73.188 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 45208 ... 45628  =     75.270 ...    75.969 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 46904 ... 47324  =     78.093 ...    78.793 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 48620 ... 49040  =     80.950 ...    81.650 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 51762 ... 52182  =     86.182 ...    86.881 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 53441 ... 53861  =     88.977 ...    89.676 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 55097 ... 55517  =     91.734 ...    92.434 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 56795 ... 57215  =     94.561 ...    95.261 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 58526 ... 58946  =     97.443 ...    98.143 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 61804 ... 62224  =    102.901 ...   103.600 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 63576 ... 63996  =    105.852 ...   106.551 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 65274 ... 65694  =    108.679 ...   109.378 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 68621 ... 69041  =    114.251 ...   114.951 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 70409 ... 70829  =    117.228 ...   117.927 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 75548 ... 75968  =    125.784 ...   126.484 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 77272 ... 77692  =    128.655 ...   129.354 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 78989 ... 79409  =    131.514 ...   132.213 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 87220 ... 87640  =    145.218 ...   145.917 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 88820 ... 89240  =    147.882 ...   148.581 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 90607 ... 91027  =    150.857 ...   151.556 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 93776 ... 94196  =    156.133 ...   156.833 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 95472 ... 95892  =    158.957 ...   159.656 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 97145 ... 97565  =    161.743 ...   162.442 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 98910 ... 99330  =    164.681 ...   165.380 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 100626 ... 101046  =    167.538 ...   168.238 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 102155 ... 102575  =    170.084 ...   170.783 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 103812 ... 104232  =    172.843 ...   173.542 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 107054 ... 107474  =    178.241 ...   178.940 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 108809 ... 109229  =    181.163 ...   181.862 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 110365 ... 110785  =    183.753 ...   184.453 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 115642 ... 116062  =    192.539 ...   193.239 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 117298 ... 117718  =    195.296 ...   195.996 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 118996 ... 119416  =    198.124 ...   198.823 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 120625 ... 121045  =    200.836 ...   201.535 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 122384 ... 122804  =    203.764 ...   204.464 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 124069 ... 124489  =    206.570 ...   207.269 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 125706 ... 126126  =    209.295 ...   209.995 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 4105 ... 4525  =      6.835 ...     7.534 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 5745 ... 6165  =      9.565 ...    10.264 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 7405 ... 7825  =     12.329 ...    13.028 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 10656 ... 11076  =     17.742 ...    18.441 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 12406 ... 12826  =     20.655 ...    21.355 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 14006 ... 14426  =     23.319 ...    24.019 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 15726 ... 16146  =     26.183 ...    26.882 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 17426 ... 17846  =     29.014 ...    29.713 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 20766 ... 21186  =     34.575 ...    35.274 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 22367 ... 22787  =     37.240 ...    37.939 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 23977 ... 24397  =     39.921 ...    40.620 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 28779 ... 29199  =     47.916 ...    48.615 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 30349 ... 30769  =     50.530 ...    51.229 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32159 ... 32579  =     53.543 ...    54.243 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 33819 ... 34239  =     56.307 ...    57.007 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 38849 ... 39269  =     64.682 ...    65.381 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 40618 ... 41038  =     67.627 ...    68.327 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 42278 ... 42698  =     70.391 ...    71.090 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 43939 ... 44359  =     73.157 ...    73.856 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 47338 ... 47758  =     78.816 ...    79.515 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 48999 ... 49419  =     81.581 ...    82.281 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 50559 ... 50979  =     84.179 ...    84.878 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 52210 ... 52630  =     86.928 ...    87.627 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 53899 ... 54319  =     89.740 ...    90.439 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 55520 ... 55940  =     92.439 ...    93.138 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 57230 ... 57650  =     95.286 ...    95.985 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 60600 ... 61020  =    100.897 ...   101.596 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 62230 ... 62650  =    103.610 ...   104.310 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 64029 ... 64449  =    106.606 ...   107.305 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 65680 ... 66100  =    109.355 ...   110.054 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 67350 ... 67770  =    112.135 ...   112.834 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 69040 ... 69460  =    114.949 ...   115.648 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 70869 ... 71289  =    117.994 ...   118.693 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 72579 ... 72999  =    120.841 ...   121.540 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 79428 ... 79848  =    132.244 ...   132.944 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 81068 ... 81488  =    134.975 ...   135.674 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 82699 ... 83119  =    137.691 ...   138.390 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 84289 ... 84709  =    140.338 ...   141.037 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 87669 ... 88089  =    145.965 ...   146.665 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 89240 ... 89660  =    148.581 ...   149.280 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 91009 ... 91429  =    151.526 ...   152.226 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 94190 ... 94610  =    156.823 ...   157.522 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 95880 ... 96300  =    159.636 ...   160.336 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 97531 ... 97951  =    162.385 ...   163.085 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 99380 ... 99800  =    165.464 ...   166.163 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 102591 ... 103011  =    170.810 ...   171.509 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 105752 ... 106172  =    176.073 ...   176.772 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 109181 ... 109601  =    181.782 ...   182.481 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 110802 ... 111222  =    184.481 ...   185.180 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 116061 ... 116481  =    193.237 ...   193.936 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 117751 ... 118171  =    196.051 ...   196.750 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 119371 ... 119791  =    198.748 ...   199.447 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 121091 ... 121511  =    201.612 ...   202.311 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 122801 ... 123221  =    204.459 ...   205.158 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 124510 ... 124930  =    207.304 ...   208.003 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 127761 ... 128181  =    212.717 ...   213.416 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 3299 ... 3719  =      5.493 ...     6.192 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 4919 ... 5339  =      8.190 ...     8.889 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 6599 ... 7019  =     10.987 ...    11.686 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 9930 ... 10350  =     16.533 ...    17.232 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 11540 ... 11960  =     19.214 ...    19.913 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 13210 ... 13630  =     21.994 ...    22.693 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 14960 ... 15380  =     24.908 ...    25.607 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 19940 ... 20360  =     33.199 ...    33.899 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 21610 ... 22030  =     35.980 ...    36.679 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 23181 ... 23601  =     38.595 ...    39.295 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 24762 ... 25182  =     41.228 ...    41.927 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 27992 ... 28412  =     46.606 ...    47.305 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 29543 ... 29963  =     49.188 ...    49.887 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 31263 ... 31683  =     52.052 ...    52.751 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32993 ... 33413  =     54.932 ...    55.631 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 36363 ... 36783  =     60.543 ...    61.242 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 38003 ... 38423  =     63.273 ...    63.973 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 39723 ... 40143  =     66.137 ...    66.836 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 43143 ... 43563  =     71.831 ...    72.531 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 46522 ... 46942  =     77.457 ...    78.157 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 48252 ... 48672  =     80.338 ...    81.037 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 49804 ... 50224  =     82.922 ...    83.621 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 51384 ... 51804  =     85.552 ...    86.252 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 53014 ... 53434  =     88.266 ...    88.965 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 54704 ... 55124  =     91.080 ...    91.779 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 58064 ... 58484  =     96.674 ...    97.374 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 59744 ... 60164  =     99.471 ...   100.171 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 63104 ... 63524  =    105.066 ...   105.765 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 64893 ... 65313  =    108.044 ...   108.744 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 66494 ... 66914  =    110.710 ...   111.409 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 68174 ... 68594  =    113.507 ...   114.206 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 69963 ... 70383  =    116.486 ...   117.185 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 71783 ... 72203  =    119.516 ...   120.215 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 73443 ... 73863  =    122.280 ...   122.979 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 78513 ... 78933  =    130.721 ...   131.420 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 80252 ... 80672  =    133.616 ...   134.316 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 81823 ... 82243  =    136.232 ...   136.931 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 83444 ... 83864  =    138.931 ...   139.630 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 86823 ... 87243  =    144.557 ...   145.256 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 90163 ... 90583  =    150.118 ...   150.817 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 91794 ... 92214  =    152.833 ...   153.533 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 93315 ... 93735  =    155.366 ...   156.065 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 95064 ... 95484  =    158.278 ...   158.977 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 96764 ... 97184  =    161.108 ...   161.807 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 98484 ... 98904  =    163.972 ...   164.671 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 103365 ... 103785  =    172.099 ...   172.798 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 106636 ... 107056  =    177.545 ...   178.244 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 108396 ... 108816  =    180.475 ...   181.174 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 109996 ... 110416  =    183.139 ...   183.838 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 116906 ... 117326  =    194.644 ...   195.343 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 118625 ... 119045  =    197.506 ...   198.205 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 120165 ... 120585  =    200.070 ...   200.769 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 121935 ... 122355  =    203.017 ...   203.716 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 123635 ... 124055  =    205.847 ...   206.547 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 125345 ... 125765  =    208.694 ...   209.394 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 128566 ... 128986  =    214.057 ...   214.757 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 2851 ... 3271  =      4.747 ...     5.446 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 4530 ... 4950  =      7.542 ...     8.242 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 6181 ... 6601  =     10.291 ...    10.990 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 7792 ... 8212  =     12.973 ...    13.673 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 9508 ... 9928  =     15.830 ...    16.530 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 11087 ... 11507  =     18.459 ...    19.159 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 12791 ... 13211  =     21.297 ...    21.996 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 14485 ... 14905  =     24.117 ...    24.816 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 16206 ... 16626  =     26.982 ...    27.682 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 17861 ... 18281  =     29.738 ...    30.437 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 21175 ... 21595  =     35.256 ...    35.955 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 22802 ... 23222  =     37.964 ...    38.664 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 24349 ... 24769  =     40.540 ...    41.239 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 29180 ... 29600  =     48.584 ...    49.283 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 30797 ... 31217  =     51.276 ...    51.975 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32528 ... 32948  =     54.158 ...    54.857 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 34209 ... 34629  =     56.957 ...    57.656 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 37612 ... 38032  =     62.622 ...    63.322 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 39261 ... 39681  =     65.368 ...    66.067 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 41044 ... 41464  =     68.337 ...    69.036 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 44339 ... 44759  =     73.823 ...    74.522 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 46071 ... 46491  =     76.706 ...    77.406 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 47798 ... 48218  =     79.582 ...    80.281 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 50974 ... 51394  =     84.870 ...    85.569 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 52619 ... 53039  =     87.609 ...    88.308 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 54289 ... 54709  =     90.389 ...    91.088 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 55991 ... 56411  =     93.223 ...    93.922 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 57648 ... 58068  =     95.982 ...    96.681 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 59379 ... 59799  =     98.864 ...    99.563 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 62673 ... 63093  =    104.348 ...   105.047 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 64499 ... 64919  =    107.388 ...   108.088 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 66118 ... 66538  =    110.084 ...   110.783 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 69515 ... 69935  =    115.740 ...   116.439 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 71314 ... 71734  =    118.735 ...   119.434 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 74700 ... 75120  =    124.373 ...   125.072 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 76368 ... 76788  =    127.150 ...   127.849 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 81435 ... 81855  =    135.586 ...   136.285 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 88032 ... 88452  =    146.570 ...   147.269 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 89699 ... 90119  =    149.345 ...   150.045 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 91384 ... 91804  =    152.151 ...   152.850 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 92959 ... 93379  =    154.773 ...   155.472 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 94619 ... 95039  =    157.537 ...   158.236 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 96298 ... 96718  =    160.332 ...   161.032 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 98011 ... 98431  =    163.184 ...   163.884 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 99789 ... 100209  =    166.145 ...   166.844 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 103005 ... 103425  =    171.499 ...   172.198 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 106161 ... 106581  =    176.754 ...   177.453 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 109613 ... 110033  =    182.501 ...   183.201 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 111213 ... 111633  =    185.165 ...   185.864 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 118151 ... 118571  =    196.717 ...   197.416 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 119746 ... 120166  =    199.372 ...   200.072 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 121538 ... 121958  =    202.356 ...   203.055 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 123242 ... 123662  =    205.193 ...   205.892 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 124952 ... 125372  =    208.040 ...   208.739 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 126506 ... 126926  =    210.627 ...   211.327 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 128160 ... 128580  =    213.381 ...   214.081 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Computing time-frequency power on single epochs...
    No baseline correction applied...
    Computing time-frequency power on single epochs...
    No baseline correction applied...
    Computing time-frequency power on single epochs...
    No baseline correction applied...
    Computing time-frequency power on single epochs...
    No baseline correction applied...


Setup repeated measures ANOVA


.. code-block:: python


    n_conditions = len(epochs.event_id)
    n_replications = epochs.events.shape[0] / n_conditions
    # we will tell the ANOVA how to interpret the data matrix in terms of
    # factors. This done via the factor levels argument which is a list
    # of the number factor levels for each factor.
    factor_levels = [2, 2]  # number of levels in each factor
    effects = 'A*B'  # this is the default signature for computing all effects
    # Other possible options are 'A' or 'B' for the corresponding main effects
    # or 'A:B' for the interaction effect only (this notation is borrowed from the
    # R formula language)
    n_frequencies = len(frequencies)
    n_times = len(times[::decim])

    # Now we'll assemble the data matrix and swap axes so the trial replications
    # are the first dimension and the conditions are the second dimension
    data = np.swapaxes(np.asarray(epochs_power), 1, 0)
    # reshape last two dimensions in one mass-univariate observation-vector
    data = data.reshape(n_replications, n_conditions, n_frequencies * n_times)

    # so we have replications * conditions * observations:
    print(data.shape)

    # while the iteration scheme used above for assembling the data matrix
    # makes sure the first two dimensions are organized as expected (with A =
    # modality and B = location):
    #
    #           A1B1 A1B2 A2B1 B2B2
    # trial 1   1.34 2.53 0.97 1.74
    # trial ... .... .... .... ....
    # trial 56  2.45 7.90 3.09 4.76
    #
    # Now we're ready to run our repeated measures ANOVA.

    fvals, pvals = f_mway_rm(data, factor_levels, effects=effects)

    effect_labels = ['modality', 'location', 'modality by location']

    # let's visualize our effects by computing f-images
    for effect, sig, effect_label in zip(fvals, pvals, effect_labels):
        plt.figure()
        # show naive F-values in gray
        plt.imshow(effect.reshape(8, 211), cmap=plt.cm.gray, extent=[times[0],
                   times[-1], frequencies[0], frequencies[-1]], aspect='auto',
                   origin='lower')
        # create mask for significant Time-frequency locations
        effect = np.ma.masked_array(effect, [sig > .05])
        plt.imshow(effect.reshape(8, 211), cmap='RdBu_r', extent=[times[0],
                   times[-1], frequencies[0], frequencies[-1]], aspect='auto',
                   origin='lower')
        plt.colorbar()
        plt.xlabel('time (ms)')
        plt.ylabel('Frequency (Hz)')
        plt.title(r"Time-locked response for '%s' (%s)" % (effect_label, ch_name))
        plt.show()

    # Note. As we treat trials as subjects, the test only accounts for
    # time locked responses despite the 'induced' approach.
    # For analysis for induced power at the group level averaged TRFs
    # are required.





.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_tutorials/images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_001.png
            :scale: 47

    *

      .. image:: /auto_tutorials/images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_002.png
            :scale: 47

    *

      .. image:: /auto_tutorials/images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_003.png
            :scale: 47


**Script output**:

.. rst-class:: sphx-glr-script-out

  ::

    (56, 4, 1688)


Account for multiple comparisons using FDR versus permutation clustering test


.. code-block:: python


    # First we need to slightly modify the ANOVA function to be suitable for
    # the clustering procedure. Also want to set some defaults.
    # Let's first override effects to confine the analysis to the interaction
    effects = 'A:B'


    # A stat_fun must deal with a variable number of input arguments.
    def stat_fun(*args):
        # Inside the clustering function each condition will be passed as
        # flattened array, necessitated by the clustering procedure.
        # The ANOVA however expects an input array of dimensions:
        # subjects X conditions X observations (optional).
        # The following expression catches the list input and swaps the first and
        # the second dimension and finally calls the ANOVA function.
        return f_mway_rm(np.swapaxes(args, 1, 0), factor_levels=factor_levels,
                         effects=effects, return_pvals=False)[0]
        # The ANOVA returns a tuple f-values and p-values, we will pick the former.


    pthresh = 0.00001  # set threshold rather high to save some time
    f_thresh = f_threshold_mway_rm(n_replications, factor_levels, effects,
                                   pthresh)
    tail = 1  # f-test, so tail > 0
    n_permutations = 256  # Save some time (the test won't be too sensitive ...)
    T_obs, clusters, cluster_p_values, h0 = mne.stats.permutation_cluster_test(
        epochs_power, stat_fun=stat_fun, threshold=f_thresh, tail=tail, n_jobs=1,
        n_permutations=n_permutations, buffer_size=None)

    # Create new stats image with only significant clusters
    good_clusers = np.where(cluster_p_values < .05)[0]
    T_obs_plot = np.ma.masked_array(T_obs,
                                    np.invert(clusters[np.squeeze(good_clusers)]))

    plt.figure()
    for f_image, cmap in zip([T_obs, T_obs_plot], [plt.cm.gray, 'RdBu_r']):
        plt.imshow(f_image, cmap=cmap, extent=[times[0], times[-1],
                   frequencies[0], frequencies[-1]], aspect='auto',
                   origin='lower')
    plt.xlabel('time (ms)')
    plt.ylabel('Frequency (Hz)')
    plt.title('Time-locked response for \'modality by location\' (%s)\n'
              ' cluster-level corrected (p <= 0.05)' % ch_name)
    plt.show()

    # now using FDR
    mask, _ = fdr_correction(pvals[2])
    T_obs_plot2 = np.ma.masked_array(T_obs, np.invert(mask))

    plt.figure()
    for f_image, cmap in zip([T_obs, T_obs_plot2], [plt.cm.gray, 'RdBu_r']):
        plt.imshow(f_image, cmap=cmap, extent=[times[0], times[-1],
                   frequencies[0], frequencies[-1]], aspect='auto',
                   origin='lower')

    plt.xlabel('time (ms)')
    plt.ylabel('Frequency (Hz)')
    plt.title('Time-locked response for \'modality by location\' (%s)\n'
              ' FDR corrected (p <= 0.05)' % ch_name)
    plt.show()

    # Both, cluster level and FDR correction help getting rid of
    # putatively spots we saw in the naive f-images.



.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_tutorials/images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_004.png
            :scale: 47

    *

      .. image:: /auto_tutorials/images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_005.png
            :scale: 47


**Script output**:

.. rst-class:: sphx-glr-script-out

  ::

    stat_fun(H1): min=0.000000 max=56.064254
    Running intial clustering
    Found 1 clusters
    Permuting ...
    [                                        ] 0.39062 |        [.....                                   ] 12.50000 /        [..........                              ] 25.00000 -        [...............                         ] 37.50000 \        [....................                    ] 50.00000 |        [.........................               ] 62.50000 /        [..............................          ] 75.00000 -        [...................................     ] 87.50000 \        [........................................] 100.00000 |    Computing cluster p-values
    Done.


**Total running time of the script:**
(0 minutes 7.616 seconds)



**Download Python source code:** :download:`plot_cluster_stats_time_frequency_repeated_measures_anova.py <plot_cluster_stats_time_frequency_repeated_measures_anova.py>`
