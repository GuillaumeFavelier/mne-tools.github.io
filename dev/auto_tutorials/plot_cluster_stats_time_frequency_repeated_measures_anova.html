<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Mass-univariate twoway repeated measures ANOVA on single trial power &mdash; MNE 0.11.dev0 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.11.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="MNE 0.11.dev0 documentation" href="../index.html" />
    <link rel="up" title="Tutorials" href="../tutorials.html" />
    <link rel="next" title="2 samples permutation test on source data with spatio-temporal clustering" href="plot_cluster_stats_spatio_temporal_2samp.html" />
    <link rel="prev" title="Non-parametric between conditions cluster statistic on single trial power" href="plot_cluster_stats_time_frequency.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body role="document">

<div class="devbar">
This documentation is for the development version (0.11.dev0) - <a href="http://martinos.org/mne/stable">Stable version</a>
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/mne_logo_small.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.11.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../tutorials.html">Tutorials</a></li>
                <li><a href="../auto_examples/index.html">Gallery</a></li>
                <li><a href="../manual/index.html">Manual</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="../faq.html">FAQ</a></li>
                <li><a href="../cite.html">Cite</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">What&#8217;s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Cite MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">Related publications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/index.html">Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_setup.html">Advanced installation and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mne_cpp.html">MNE with CPP</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Mass-univariate twoway repeated measures ANOVA on single trial power</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Mass-univariate twoway repeated measures ANOVA on single trial power</a></li>
</ul>

  <li>
    <a href="plot_cluster_stats_time_frequency.html" title="Previous Chapter: Non-parametric between conditions cluster statistic on single trial power"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Non-parametri...</span>
    </a>
  </li>
  <li>
    <a href="plot_cluster_stats_spatio_temporal_2samp.html" title="Next Chapter: 2 samples permutation test on source data with spatio-temporal clustering"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">2 samples per... &raquo;</span>
    </a>
  </li>
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12">
      
  <span class="target" id="sphx-glr-auto-tutorials-plot-cluster-stats-time-frequency-repeated-measures-anova-py"></span><div class="section" id="mass-univariate-twoway-repeated-measures-anova-on-single-trial-power">
<h1>Mass-univariate twoway repeated measures ANOVA on single trial power<a class="headerlink" href="#mass-univariate-twoway-repeated-measures-anova-on-single-trial-power" title="Permalink to this headline">Â¶</a></h1>
<p>This script shows how to conduct a mass-univariate repeated measures
ANOVA. As the model to be fitted assumes two fully crossed factors,
we will study the interplay between perceptual modality
(auditory VS visual) and the location of stimulus presentation
(left VS right). Here we use single trials as replications
(subjects) while iterating over time slices plus frequency bands
for to fit our mass-univariate model. For the sake of simplicity we
will confine this analysis to one single channel of which we know
that it exposes a strong induced response. We will then visualize
each effect by creating a corresponding mass-univariate effect
image. We conclude with accounting for multiple comparisons by
performing a permutation clustering test using the ANOVA as
clustering function. The results final will be compared to
multiple comparisons using False Discovery Rate correction.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Authors: Denis Engemann &lt;denis.engemann@gmail.com&gt;</span>
<span class="c">#          Eric Larson &lt;larson.eric.d@gmail.com&gt;</span>
<span class="c">#          Alexandre Gramfort &lt;alexandre.gramfort@telecom-paristech.fr&gt;</span>
<span class="c">#</span>
<span class="c"># License: BSD (3-clause)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne</span> <span class="kn">import</span> <span class="n">io</span>
<span class="kn">from</span> <span class="nn">mne.time_frequency</span> <span class="kn">import</span> <a href="../generated/mne.time_frequency.single_trial_power.html#mne.time_frequency.single_trial_power"><span class="n">single_trial_power</span></a>
<span class="kn">from</span> <span class="nn">mne.stats</span> <span class="kn">import</span> <span class="n">f_threshold_mway_rm</span><span class="p">,</span> <a href="../generated/mne.stats.f_mway_rm.html#mne.stats.f_mway_rm"><span class="n">f_mway_rm</span></a><span class="p">,</span> <a href="../generated/mne.stats.fdr_correction.html#mne.stats.fdr_correction"><span class="n">fdr_correction</span></a>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">sample</span>

<span class="k">print</span><span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-horizontal">Set parameters</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">data_path</span> <span class="o">=</span> <a href="../generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path"><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<span class="n">raw_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis_raw.fif&#39;</span>
<span class="n">event_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis_raw-eve.fif&#39;</span>
<span class="n">event_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="c"># Setup for reading the raw data</span>
<span class="n">raw</span> <span class="o">=</span> <a href="../generated/mne.io.Raw.html#mne.io.Raw"><span class="n">io</span><span class="o">.</span><span class="n">Raw</span></a><span class="p">(</span><span class="n">raw_fname</span><span class="p">)</span>
<span class="n">events</span> <span class="o">=</span> <a href="../generated/mne.read_events.html#mne.read_events"><span class="n">mne</span><span class="o">.</span><span class="n">read_events</span></a><span class="p">(</span><span class="n">event_fname</span><span class="p">)</span>

<span class="n">include</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s">&#39;bads&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&#39;MEG 2443&#39;</span><span class="p">]</span>  <span class="c"># bads</span>

<span class="c"># picks MEG gradiometers</span>
<span class="n">picks</span> <span class="o">=</span> <a href="../generated/mne.pick_types.html#mne.pick_types"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="s">&#39;grad&#39;</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">stim</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="s">&#39;bads&#39;</span><span class="p">)</span>

<span class="n">ch_name</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s">&#39;ch_names&#39;</span><span class="p">][</span><span class="n">picks</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="c"># Load conditions</span>
<span class="n">reject</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">grad</span><span class="o">=</span><span class="mf">4000e-13</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="mf">150e-6</span><span class="p">)</span>
<span class="n">event_id</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">aud_l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">aud_r</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vis_l</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">vis_r</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">epochs</span> <span class="o">=</span> <a href="../generated/mne.Epochs.html#mne.Epochs"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">event_id</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span>
                    <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">reject</span><span class="o">=</span><span class="n">reject</span><span class="p">)</span>

<span class="c"># make sure all conditions have the same counts, as the ANOVA expects a</span>
<span class="c"># fully balanced data matrix and does not forgive imbalances that generously</span>
<span class="c"># (risk of type-I error)</span>
<span class="n">epochs</span><span class="o">.</span><span class="n">equalize_event_counts</span><span class="p">(</span><span class="n">event_id</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="c"># Time vector</span>
<span class="n">times</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">epochs</span><span class="o">.</span><span class="n">times</span>  <span class="c"># change unit to ms</span>

<span class="c"># Factor to downs-sample the temporal dimension of the PSD computed by</span>
<span class="c"># single_trial_power.</span>
<span class="n">decim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">frequencies</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.arange.html#numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c"># define frequencies of interest</span>
<span class="n">sfreq</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s">&#39;sfreq&#39;</span><span class="p">]</span>  <span class="c"># sampling in Hz</span>
<span class="n">n_cycles</span> <span class="o">=</span> <span class="n">frequencies</span> <span class="o">/</span> <span class="n">frequencies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">baseline_mask</span> <span class="o">=</span> <span class="n">times</span><span class="p">[::</span><span class="n">decim</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span>

<span class="c"># now create TFR representations for all conditions</span>
<span class="n">epochs_power</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="p">[</span><span class="n">epochs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[:,</span> <span class="mi">97</span><span class="p">:</span><span class="mi">98</span><span class="p">,</span> <span class="p">:]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">event_id</span><span class="p">]:</span>
    <span class="n">this_power</span> <span class="o">=</span> <a href="../generated/mne.time_frequency.single_trial_power.html#mne.time_frequency.single_trial_power"><span class="n">single_trial_power</span></a><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">sfreq</span><span class="o">=</span><span class="n">sfreq</span><span class="p">,</span>
                                    <span class="n">frequencies</span><span class="o">=</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">n_cycles</span><span class="o">=</span><span class="n">n_cycles</span><span class="p">,</span>
                                    <span class="n">decim</span><span class="o">=</span><span class="n">decim</span><span class="p">)</span>
    <span class="n">this_power</span> <span class="o">=</span> <span class="n">this_power</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>  <span class="c"># we only have one channel.</span>
    <span class="c"># Compute ratio with baseline power (be sure to correct time vector with</span>
    <span class="c"># decimation factor)</span>
    <span class="n">epochs_baseline</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.mean.html#numpy.mean"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">this_power</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">baseline_mask</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">this_power</span> <span class="o">/=</span> <span class="n">epochs_baseline</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/arrays.indexing.html#numpy.newaxis"><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span></a><span class="p">]</span>
    <span class="n">epochs_power</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_power</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-horizontal"><strong>Script output</strong>:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre>Opening raw data file /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/sample_audvis_raw.fif...
    Read a total of 3 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
Current compensation grade : 0
    Range : 25800 ... 192599 =     42.956 ...   320.670 secs
Ready.
Adding average EEG reference projection.
1 projection items deactivated
289 matching events found
4 projection items activated
Reading 2057 ... 2477  =      3.425 ...     4.124 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 2425 ... 2845  =      4.038 ...     4.737 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 2851 ... 3271  =      4.747 ...     5.446 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 3299 ... 3719  =      5.493 ...     6.192 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 3732 ... 4152  =      6.214 ...     6.913 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 4105 ... 4525  =      6.835 ...     7.534 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 4530 ... 4950  =      7.542 ...     8.242 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 4919 ... 5339  =      8.190 ...     8.889 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 5320 ... 5740  =      8.858 ...     9.557 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 5745 ... 6165  =      9.565 ...    10.264 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 6181 ... 6601  =     10.291 ...    10.990 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 6599 ... 7019  =     10.987 ...    11.686 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 7015 ... 7435  =     11.680 ...    12.379 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 7405 ... 7825  =     12.329 ...    13.028 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 7792 ... 8212  =     12.973 ...    13.673 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 8612 ... 9032  =     14.339 ...    15.038 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 9036 ... 9456  =     15.045 ...    15.744 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 9508 ... 9928  =     15.830 ...    16.530 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 9930 ... 10350  =     16.533 ...    17.232 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 10291 ... 10711  =     17.134 ...    17.833 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 10656 ... 11076  =     17.742 ...    18.441 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 11087 ... 11507  =     18.459 ...    19.159 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 11540 ... 11960  =     19.214 ...    19.913 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 11990 ... 12410  =     19.963 ...    20.662 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 12406 ... 12826  =     20.655 ...    21.355 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 12791 ... 13211  =     21.297 ...    21.996 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 13210 ... 13630  =     21.994 ...    22.693 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 13643 ... 14063  =     22.715 ...    23.414 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 14006 ... 14426  =     23.319 ...    24.019 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 14485 ... 14905  =     24.117 ...    24.816 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 14960 ... 15380  =     24.908 ...    25.607 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 15340 ... 15760  =     25.540 ...    26.240 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 15726 ... 16146  =     26.183 ...    26.882 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 16206 ... 16626  =     26.982 ...    27.682 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 17040 ... 17460  =     28.371 ...    29.070 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 17426 ... 17846  =     29.014 ...    29.713 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 17861 ... 18281  =     29.738 ...    30.437 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 18250 ... 18670  =     30.386 ...    31.085 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 18729 ... 19149  =     31.183 ...    31.882 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 19195 ... 19615  =     31.959 ...    32.658 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 19566 ... 19986  =     32.577 ...    33.276 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 19940 ... 20360  =     33.199 ...    33.899 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 20320 ... 20740  =     33.832 ...    34.531 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 20766 ... 21186  =     34.575 ...    35.274 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 21175 ... 21595  =     35.256 ...    35.955 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 21610 ... 22030  =     35.980 ...    36.679 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 21975 ... 22395  =     36.587 ...    37.287 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 22367 ... 22787  =     37.240 ...    37.939 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 22802 ... 23222  =     37.964 ...    38.664 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 23181 ... 23601  =     38.595 ...    39.295 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 23549 ... 23969  =     39.208 ...    39.907 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 23977 ... 24397  =     39.921 ...    40.620 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 24349 ... 24769  =     40.540 ...    41.239 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 24762 ... 25182  =     41.228 ...    41.927 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 25126 ... 25546  =     41.834 ...    42.533 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 25961 ... 26381  =     43.224 ...    43.923 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 26332 ... 26752  =     43.842 ...    44.541 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 26755 ... 27175  =     44.546 ...    45.245 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 27198 ... 27618  =     45.284 ...    45.983 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 27574 ... 27994  =     45.910 ...    46.609 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 27992 ... 28412  =     46.606 ...    47.305 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 28400 ... 28820  =     47.285 ...    47.984 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 28779 ... 29199  =     47.916 ...    48.615 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 29180 ... 29600  =     48.584 ...    49.283 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 29543 ... 29963  =     49.188 ...    49.887 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 29958 ... 30378  =     49.879 ...    50.578 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 30349 ... 30769  =     50.530 ...    51.229 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 30797 ... 31217  =     51.276 ...    51.975 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 31263 ... 31683  =     52.052 ...    52.751 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 31692 ... 32112  =     52.766 ...    53.465 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 32159 ... 32579  =     53.543 ...    54.243 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 32528 ... 32948  =     54.158 ...    54.857 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 32993 ... 33413  =     54.932 ...    55.631 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 33819 ... 34239  =     56.307 ...    57.007 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 34209 ... 34629  =     56.957 ...    57.656 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 34643 ... 35063  =     57.679 ...    58.378 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 35115 ... 35535  =     58.465 ...    59.164 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 35538 ... 35958  =     59.169 ...    59.869 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 35948 ... 36368  =     59.852 ...    60.551 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 36363 ... 36783  =     60.543 ...    61.242 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 36762 ... 37182  =     61.207 ...    61.907 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 37149 ... 37569  =     61.852 ...    62.551 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 37612 ... 38032  =     62.622 ...    63.322 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 38003 ... 38423  =     63.273 ...    63.973 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 38467 ... 38887  =     64.046 ...    64.745 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 38849 ... 39269  =     64.682 ...    65.381 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 39261 ... 39681  =     65.368 ...    66.067 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 39723 ... 40143  =     66.137 ...    66.836 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 40151 ... 40571  =     66.850 ...    67.549 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 40618 ... 41038  =     67.627 ...    68.327 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 41044 ... 41464  =     68.337 ...    69.036 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 41891 ... 42311  =     69.747 ...    70.446 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 42278 ... 42698  =     70.391 ...    71.090 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 42746 ... 43166  =     71.170 ...    71.870 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 43143 ... 43563  =     71.831 ...    72.531 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 43538 ... 43958  =     72.489 ...    73.188 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 43939 ... 44359  =     73.157 ...    73.856 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 44339 ... 44759  =     73.823 ...    74.522 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 44743 ... 45163  =     74.495 ...    75.195 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 45208 ... 45628  =     75.270 ...    75.969 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 45688 ... 46108  =     76.069 ...    76.768 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 46071 ... 46491  =     76.706 ...    77.406 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 46522 ... 46942  =     77.457 ...    78.157 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 46904 ... 47324  =     78.093 ...    78.793 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 47338 ... 47758  =     78.816 ...    79.515 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 47798 ... 48218  =     79.582 ...    80.281 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 48252 ... 48672  =     80.338 ...    81.037 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 48620 ... 49040  =     80.950 ...    81.650 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 48999 ... 49419  =     81.581 ...    82.281 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 49804 ... 50224  =     82.922 ...    83.621 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 50166 ... 50586  =     83.524 ...    84.224 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 50559 ... 50979  =     84.179 ...    84.878 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 50974 ... 51394  =     84.870 ...    85.569 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 51384 ... 51804  =     85.552 ...    86.252 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 51762 ... 52182  =     86.182 ...    86.881 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 52210 ... 52630  =     86.928 ...    87.627 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 52619 ... 53039  =     87.609 ...    88.308 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 53014 ... 53434  =     88.266 ...    88.965 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 53441 ... 53861  =     88.977 ...    89.676 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 53899 ... 54319  =     89.740 ...    90.439 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 54289 ... 54709  =     90.389 ...    91.088 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 54704 ... 55124  =     91.080 ...    91.779 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 55097 ... 55517  =     91.734 ...    92.434 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 55520 ... 55940  =     92.439 ...    93.138 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 55991 ... 56411  =     93.223 ...    93.922 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 56414 ... 56834  =     93.927 ...    94.626 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 56795 ... 57215  =     94.561 ...    95.261 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 57230 ... 57650  =     95.286 ...    95.985 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 57648 ... 58068  =     95.982 ...    96.681 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 58064 ... 58484  =     96.674 ...    97.374 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 58526 ... 58946  =     97.443 ...    98.143 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 59379 ... 59799  =     98.864 ...    99.563 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 59744 ... 60164  =     99.471 ...   100.171 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 60187 ... 60607  =    100.209 ...   100.908 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 60600 ... 61020  =    100.897 ...   101.596 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 61051 ... 61471  =    101.647 ...   102.347 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 61434 ... 61854  =    102.285 ...   102.984 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 61804 ... 62224  =    102.901 ...   103.600 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 62230 ... 62650  =    103.610 ...   104.310 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 62673 ... 63093  =    104.348 ...   105.047 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 63104 ... 63524  =    105.066 ...   105.765 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 63576 ... 63996  =    105.852 ...   106.551 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 64029 ... 64449  =    106.606 ...   107.305 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 64499 ... 64919  =    107.388 ...   108.088 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 64893 ... 65313  =    108.044 ...   108.744 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 65274 ... 65694  =    108.679 ...   109.378 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 65680 ... 66100  =    109.355 ...   110.054 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 66118 ... 66538  =    110.084 ...   110.783 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 66494 ... 66914  =    110.710 ...   111.409 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 67350 ... 67770  =    112.135 ...   112.834 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 67749 ... 68169  =    112.799 ...   113.499 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 68174 ... 68594  =    113.507 ...   114.206 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 68621 ... 69041  =    114.251 ...   114.951 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 69040 ... 69460  =    114.949 ...   115.648 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 69515 ... 69935  =    115.740 ...   116.439 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 69963 ... 70383  =    116.486 ...   117.185 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 70409 ... 70829  =    117.228 ...   117.927 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 70869 ... 71289  =    117.994 ...   118.693 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 71314 ... 71734  =    118.735 ...   119.434 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 71783 ... 72203  =    119.516 ...   120.215 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 72193 ... 72613  =    120.198 ...   120.898 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 72579 ... 72999  =    120.841 ...   121.540 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 72983 ... 73403  =    121.514 ...   122.213 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 73443 ... 73863  =    122.280 ...   122.979 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 73875 ... 74295  =    122.999 ...   123.698 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 74239 ... 74659  =    123.605 ...   124.304 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 74700 ... 75120  =    124.373 ...   125.072 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 75548 ... 75968  =    125.784 ...   126.484 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 75988 ... 76408  =    126.517 ...   127.216 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 76368 ... 76788  =    127.150 ...   127.849 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 76793 ... 77213  =    127.857 ...   128.557 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 77272 ... 77692  =    128.655 ...   129.354 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 77668 ... 78088  =    129.314 ...   130.013 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 78113 ... 78533  =    130.055 ...   130.754 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 78513 ... 78933  =    130.721 ...   131.420 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 78989 ... 79409  =    131.514 ...   132.213 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 79428 ... 79848  =    132.244 ...   132.944 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 79840 ... 80260  =    132.930 ...   133.630 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 80252 ... 80672  =    133.616 ...   134.316 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 80700 ... 81120  =    134.362 ...   135.062 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 81068 ... 81488  =    134.975 ...   135.674 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 81435 ... 81855  =    135.586 ...   136.285 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 81823 ... 82243  =    136.232 ...   136.931 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 82250 ... 82670  =    136.943 ...   137.642 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 82699 ... 83119  =    137.691 ...   138.390 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 83444 ... 83864  =    138.931 ...   139.630 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 83821 ... 84241  =    139.559 ...   140.258 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 84289 ... 84709  =    140.338 ...   141.037 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 84654 ... 85074  =    140.946 ...   141.645 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 85084 ... 85504  =    141.661 ...   142.361 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 85520 ... 85940  =    142.387 ...   143.087 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 85919 ... 86339  =    143.052 ...   143.751 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 86372 ... 86792  =    143.806 ...   144.505 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 86823 ... 87243  =    144.557 ...   145.256 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 87220 ... 87640  =    145.218 ...   145.917 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 87669 ... 88089  =    145.965 ...   146.665 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 88032 ... 88452  =    146.570 ...   147.269 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 88404 ... 88824  =    147.189 ...   147.888 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 88820 ... 89240  =    147.882 ...   148.581 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 89240 ... 89660  =    148.581 ...   149.280 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 89699 ... 90119  =    149.345 ...   150.045 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 90163 ... 90583  =    150.118 ...   150.817 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 90607 ... 91027  =    150.857 ...   151.556 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 91009 ... 91429  =    151.526 ...   152.226 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 91384 ... 91804  =    152.151 ...   152.850 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 91794 ... 92214  =    152.833 ...   153.533 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 92560 ... 92980  =    154.109 ...   154.808 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 92959 ... 93379  =    154.773 ...   155.472 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 93315 ... 93735  =    155.366 ...   156.065 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 93776 ... 94196  =    156.133 ...   156.833 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 94190 ... 94610  =    156.823 ...   157.522 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 94619 ... 95039  =    157.537 ...   158.236 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 95064 ... 95484  =    158.278 ...   158.977 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 95472 ... 95892  =    158.957 ...   159.656 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 95880 ... 96300  =    159.636 ...   160.336 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 96298 ... 96718  =    160.332 ...   161.032 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 96764 ... 97184  =    161.108 ...   161.807 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 97145 ... 97565  =    161.743 ...   162.442 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 97531 ... 97951  =    162.385 ...   163.085 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 98011 ... 98431  =    163.184 ...   163.884 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 98484 ... 98904  =    163.972 ...   164.671 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 98910 ... 99330  =    164.681 ...   165.380 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 99380 ... 99800  =    165.464 ...   166.163 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 99789 ... 100209  =    166.145 ...   166.844 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 100626 ... 101046  =    167.538 ...   168.238 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 101030 ... 101450  =    168.211 ...   168.910 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 101411 ... 101831  =    168.845 ...   169.545 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 101785 ... 102205  =    169.468 ...   170.167 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 102155 ... 102575  =    170.084 ...   170.783 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 102591 ... 103011  =    170.810 ...   171.509 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 103005 ... 103425  =    171.499 ...   172.198 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 103365 ... 103785  =    172.099 ...   172.798 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 103812 ... 104232  =    172.843 ...   173.542 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 104191 ... 104611  =    173.474 ...   174.173 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 104575 ... 104995  =    174.113 ...   174.812 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 104956 ... 105376  =    174.748 ...   175.447 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 105333 ... 105753  =    175.375 ...   176.075 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 105752 ... 106172  =    176.073 ...   176.772 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 106161 ... 106581  =    176.754 ...   177.453 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 106636 ... 107056  =    177.545 ...   178.244 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 107054 ... 107474  =    178.241 ...   178.940 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 107531 ... 107951  =    179.035 ...   179.734 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 108396 ... 108816  =    180.475 ...   181.174 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 108809 ... 109229  =    181.163 ...   181.862 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 109181 ... 109601  =    181.782 ...   182.481 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 109613 ... 110033  =    182.501 ...   183.201 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 109996 ... 110416  =    183.139 ...   183.838 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 110365 ... 110785  =    183.753 ...   184.453 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 110802 ... 111222  =    184.481 ...   185.180 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 111213 ... 111633  =    185.165 ...   185.864 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 111656 ... 112076  =    185.903 ...   186.602 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 112073 ... 112493  =    186.597 ...   187.296 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 112492 ... 112912  =    187.295 ...   187.994 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 112916 ... 113336  =    188.001 ...   188.700 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 113386 ... 113806  =    188.783 ...   189.482 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 113817 ... 114237  =    189.501 ...   190.200 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 114271 ... 114691  =    190.257 ...   190.956 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 114692 ... 115112  =    190.958 ...   191.657 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 115165 ... 115585  =    191.745 ...   192.444 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 115642 ... 116062  =    192.539 ...   193.239 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 116061 ... 116481  =    193.237 ...   193.936 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 116906 ... 117326  =    194.644 ...   195.343 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 117298 ... 117718  =    195.296 ...   195.996 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 117751 ... 118171  =    196.051 ...   196.750 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 118151 ... 118571  =    196.717 ...   197.416 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 118625 ... 119045  =    197.506 ...   198.205 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 118996 ... 119416  =    198.124 ...   198.823 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 119371 ... 119791  =    198.748 ...   199.447 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 119746 ... 120166  =    199.372 ...   200.072 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 120165 ... 120585  =    200.070 ...   200.769 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 120625 ... 121045  =    200.836 ...   201.535 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 121091 ... 121511  =    201.612 ...   202.311 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 121538 ... 121958  =    202.356 ...   203.055 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 121935 ... 122355  =    203.017 ...   203.716 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 122384 ... 122804  =    203.764 ...   204.464 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 122801 ... 123221  =    204.459 ...   205.158 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 123242 ... 123662  =    205.193 ...   205.892 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 123635 ... 124055  =    205.847 ...   206.547 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 124069 ... 124489  =    206.570 ...   207.269 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 124510 ... 124930  =    207.304 ...   208.003 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 124952 ... 125372  =    208.040 ...   208.739 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 125345 ... 125765  =    208.694 ...   209.394 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 125706 ... 126126  =    209.295 ...   209.995 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 126506 ... 126926  =    210.627 ...   211.327 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 126905 ... 127325  =    211.292 ...   211.991 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 127291 ... 127711  =    211.934 ...   212.634 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 127761 ... 128181  =    212.717 ...   213.416 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 128160 ... 128580  =    213.381 ...   214.081 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 128566 ... 128986  =    214.057 ...   214.757 secs...
[done]
Applying baseline correction ... (mode: mean)
53 bad epochs dropped
Dropped 12 epochs
Reading 3732 ... 4152  =      6.214 ...     6.913 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 5320 ... 5740  =      8.858 ...     9.557 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 7015 ... 7435  =     11.680 ...    12.379 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 10291 ... 10711  =     17.134 ...    17.833 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 11990 ... 12410  =     19.963 ...    20.662 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 13643 ... 14063  =     22.715 ...    23.414 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 15340 ... 15760  =     25.540 ...    26.240 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 20320 ... 20740  =     33.832 ...    34.531 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 21975 ... 22395  =     36.587 ...    37.287 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 23549 ... 23969  =     39.208 ...    39.907 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 25126 ... 25546  =     41.834 ...    42.533 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 26755 ... 27175  =     44.546 ...    45.245 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 28400 ... 28820  =     47.285 ...    47.984 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 29958 ... 30378  =     49.879 ...    50.578 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 31692 ... 32112  =     52.766 ...    53.465 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 36762 ... 37182  =     61.207 ...    61.907 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 38467 ... 38887  =     64.046 ...    64.745 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 40151 ... 40571  =     66.850 ...    67.549 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 41891 ... 42311  =     69.747 ...    70.446 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 43538 ... 43958  =     72.489 ...    73.188 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 45208 ... 45628  =     75.270 ...    75.969 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 46904 ... 47324  =     78.093 ...    78.793 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 48620 ... 49040  =     80.950 ...    81.650 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 51762 ... 52182  =     86.182 ...    86.881 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 53441 ... 53861  =     88.977 ...    89.676 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 55097 ... 55517  =     91.734 ...    92.434 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 56795 ... 57215  =     94.561 ...    95.261 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 58526 ... 58946  =     97.443 ...    98.143 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 61804 ... 62224  =    102.901 ...   103.600 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 63576 ... 63996  =    105.852 ...   106.551 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 65274 ... 65694  =    108.679 ...   109.378 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 68621 ... 69041  =    114.251 ...   114.951 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 70409 ... 70829  =    117.228 ...   117.927 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 75548 ... 75968  =    125.784 ...   126.484 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 77272 ... 77692  =    128.655 ...   129.354 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 78989 ... 79409  =    131.514 ...   132.213 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 87220 ... 87640  =    145.218 ...   145.917 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 88820 ... 89240  =    147.882 ...   148.581 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 90607 ... 91027  =    150.857 ...   151.556 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 93776 ... 94196  =    156.133 ...   156.833 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 95472 ... 95892  =    158.957 ...   159.656 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 97145 ... 97565  =    161.743 ...   162.442 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 98910 ... 99330  =    164.681 ...   165.380 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 100626 ... 101046  =    167.538 ...   168.238 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 102155 ... 102575  =    170.084 ...   170.783 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 103812 ... 104232  =    172.843 ...   173.542 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 107054 ... 107474  =    178.241 ...   178.940 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 108809 ... 109229  =    181.163 ...   181.862 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 110365 ... 110785  =    183.753 ...   184.453 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 115642 ... 116062  =    192.539 ...   193.239 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 117298 ... 117718  =    195.296 ...   195.996 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 118996 ... 119416  =    198.124 ...   198.823 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 120625 ... 121045  =    200.836 ...   201.535 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 122384 ... 122804  =    203.764 ...   204.464 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 124069 ... 124489  =    206.570 ...   207.269 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 125706 ... 126126  =    209.295 ...   209.995 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 4105 ... 4525  =      6.835 ...     7.534 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 5745 ... 6165  =      9.565 ...    10.264 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 7405 ... 7825  =     12.329 ...    13.028 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 10656 ... 11076  =     17.742 ...    18.441 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 12406 ... 12826  =     20.655 ...    21.355 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 14006 ... 14426  =     23.319 ...    24.019 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 15726 ... 16146  =     26.183 ...    26.882 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 17426 ... 17846  =     29.014 ...    29.713 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 20766 ... 21186  =     34.575 ...    35.274 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 22367 ... 22787  =     37.240 ...    37.939 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 23977 ... 24397  =     39.921 ...    40.620 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 28779 ... 29199  =     47.916 ...    48.615 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 30349 ... 30769  =     50.530 ...    51.229 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 32159 ... 32579  =     53.543 ...    54.243 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 33819 ... 34239  =     56.307 ...    57.007 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 38849 ... 39269  =     64.682 ...    65.381 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 40618 ... 41038  =     67.627 ...    68.327 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 42278 ... 42698  =     70.391 ...    71.090 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 43939 ... 44359  =     73.157 ...    73.856 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 47338 ... 47758  =     78.816 ...    79.515 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 48999 ... 49419  =     81.581 ...    82.281 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 50559 ... 50979  =     84.179 ...    84.878 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 52210 ... 52630  =     86.928 ...    87.627 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 53899 ... 54319  =     89.740 ...    90.439 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 55520 ... 55940  =     92.439 ...    93.138 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 57230 ... 57650  =     95.286 ...    95.985 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 60600 ... 61020  =    100.897 ...   101.596 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 62230 ... 62650  =    103.610 ...   104.310 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 64029 ... 64449  =    106.606 ...   107.305 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 65680 ... 66100  =    109.355 ...   110.054 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 67350 ... 67770  =    112.135 ...   112.834 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 69040 ... 69460  =    114.949 ...   115.648 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 70869 ... 71289  =    117.994 ...   118.693 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 72579 ... 72999  =    120.841 ...   121.540 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 79428 ... 79848  =    132.244 ...   132.944 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 81068 ... 81488  =    134.975 ...   135.674 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 82699 ... 83119  =    137.691 ...   138.390 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 84289 ... 84709  =    140.338 ...   141.037 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 87669 ... 88089  =    145.965 ...   146.665 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 89240 ... 89660  =    148.581 ...   149.280 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 91009 ... 91429  =    151.526 ...   152.226 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 94190 ... 94610  =    156.823 ...   157.522 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 95880 ... 96300  =    159.636 ...   160.336 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 97531 ... 97951  =    162.385 ...   163.085 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 99380 ... 99800  =    165.464 ...   166.163 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 102591 ... 103011  =    170.810 ...   171.509 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 105752 ... 106172  =    176.073 ...   176.772 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 109181 ... 109601  =    181.782 ...   182.481 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 110802 ... 111222  =    184.481 ...   185.180 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 116061 ... 116481  =    193.237 ...   193.936 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 117751 ... 118171  =    196.051 ...   196.750 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 119371 ... 119791  =    198.748 ...   199.447 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 121091 ... 121511  =    201.612 ...   202.311 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 122801 ... 123221  =    204.459 ...   205.158 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 124510 ... 124930  =    207.304 ...   208.003 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 127761 ... 128181  =    212.717 ...   213.416 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 3299 ... 3719  =      5.493 ...     6.192 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 4919 ... 5339  =      8.190 ...     8.889 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 6599 ... 7019  =     10.987 ...    11.686 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 9930 ... 10350  =     16.533 ...    17.232 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 11540 ... 11960  =     19.214 ...    19.913 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 13210 ... 13630  =     21.994 ...    22.693 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 14960 ... 15380  =     24.908 ...    25.607 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 19940 ... 20360  =     33.199 ...    33.899 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 21610 ... 22030  =     35.980 ...    36.679 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 23181 ... 23601  =     38.595 ...    39.295 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 24762 ... 25182  =     41.228 ...    41.927 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 27992 ... 28412  =     46.606 ...    47.305 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 29543 ... 29963  =     49.188 ...    49.887 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 31263 ... 31683  =     52.052 ...    52.751 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 32993 ... 33413  =     54.932 ...    55.631 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 36363 ... 36783  =     60.543 ...    61.242 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 38003 ... 38423  =     63.273 ...    63.973 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 39723 ... 40143  =     66.137 ...    66.836 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 43143 ... 43563  =     71.831 ...    72.531 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 46522 ... 46942  =     77.457 ...    78.157 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 48252 ... 48672  =     80.338 ...    81.037 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 49804 ... 50224  =     82.922 ...    83.621 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 51384 ... 51804  =     85.552 ...    86.252 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 53014 ... 53434  =     88.266 ...    88.965 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 54704 ... 55124  =     91.080 ...    91.779 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 58064 ... 58484  =     96.674 ...    97.374 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 59744 ... 60164  =     99.471 ...   100.171 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 63104 ... 63524  =    105.066 ...   105.765 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 64893 ... 65313  =    108.044 ...   108.744 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 66494 ... 66914  =    110.710 ...   111.409 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 68174 ... 68594  =    113.507 ...   114.206 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 69963 ... 70383  =    116.486 ...   117.185 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 71783 ... 72203  =    119.516 ...   120.215 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 73443 ... 73863  =    122.280 ...   122.979 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 78513 ... 78933  =    130.721 ...   131.420 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 80252 ... 80672  =    133.616 ...   134.316 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 81823 ... 82243  =    136.232 ...   136.931 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 83444 ... 83864  =    138.931 ...   139.630 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 86823 ... 87243  =    144.557 ...   145.256 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 90163 ... 90583  =    150.118 ...   150.817 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 91794 ... 92214  =    152.833 ...   153.533 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 93315 ... 93735  =    155.366 ...   156.065 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 95064 ... 95484  =    158.278 ...   158.977 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 96764 ... 97184  =    161.108 ...   161.807 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 98484 ... 98904  =    163.972 ...   164.671 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 103365 ... 103785  =    172.099 ...   172.798 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 106636 ... 107056  =    177.545 ...   178.244 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 108396 ... 108816  =    180.475 ...   181.174 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 109996 ... 110416  =    183.139 ...   183.838 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 116906 ... 117326  =    194.644 ...   195.343 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 118625 ... 119045  =    197.506 ...   198.205 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 120165 ... 120585  =    200.070 ...   200.769 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 121935 ... 122355  =    203.017 ...   203.716 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 123635 ... 124055  =    205.847 ...   206.547 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 125345 ... 125765  =    208.694 ...   209.394 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 128566 ... 128986  =    214.057 ...   214.757 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 2851 ... 3271  =      4.747 ...     5.446 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 4530 ... 4950  =      7.542 ...     8.242 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 6181 ... 6601  =     10.291 ...    10.990 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 7792 ... 8212  =     12.973 ...    13.673 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 9508 ... 9928  =     15.830 ...    16.530 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 11087 ... 11507  =     18.459 ...    19.159 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 12791 ... 13211  =     21.297 ...    21.996 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 14485 ... 14905  =     24.117 ...    24.816 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 16206 ... 16626  =     26.982 ...    27.682 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 17861 ... 18281  =     29.738 ...    30.437 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 21175 ... 21595  =     35.256 ...    35.955 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 22802 ... 23222  =     37.964 ...    38.664 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 24349 ... 24769  =     40.540 ...    41.239 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 29180 ... 29600  =     48.584 ...    49.283 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 30797 ... 31217  =     51.276 ...    51.975 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 32528 ... 32948  =     54.158 ...    54.857 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 34209 ... 34629  =     56.957 ...    57.656 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 37612 ... 38032  =     62.622 ...    63.322 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 39261 ... 39681  =     65.368 ...    66.067 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 41044 ... 41464  =     68.337 ...    69.036 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 44339 ... 44759  =     73.823 ...    74.522 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 46071 ... 46491  =     76.706 ...    77.406 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 47798 ... 48218  =     79.582 ...    80.281 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 50974 ... 51394  =     84.870 ...    85.569 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 52619 ... 53039  =     87.609 ...    88.308 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 54289 ... 54709  =     90.389 ...    91.088 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 55991 ... 56411  =     93.223 ...    93.922 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 57648 ... 58068  =     95.982 ...    96.681 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 59379 ... 59799  =     98.864 ...    99.563 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 62673 ... 63093  =    104.348 ...   105.047 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 64499 ... 64919  =    107.388 ...   108.088 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 66118 ... 66538  =    110.084 ...   110.783 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 69515 ... 69935  =    115.740 ...   116.439 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 71314 ... 71734  =    118.735 ...   119.434 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 74700 ... 75120  =    124.373 ...   125.072 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 76368 ... 76788  =    127.150 ...   127.849 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 81435 ... 81855  =    135.586 ...   136.285 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 88032 ... 88452  =    146.570 ...   147.269 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 89699 ... 90119  =    149.345 ...   150.045 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 91384 ... 91804  =    152.151 ...   152.850 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 92959 ... 93379  =    154.773 ...   155.472 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 94619 ... 95039  =    157.537 ...   158.236 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 96298 ... 96718  =    160.332 ...   161.032 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 98011 ... 98431  =    163.184 ...   163.884 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 99789 ... 100209  =    166.145 ...   166.844 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 103005 ... 103425  =    171.499 ...   172.198 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 106161 ... 106581  =    176.754 ...   177.453 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 109613 ... 110033  =    182.501 ...   183.201 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 111213 ... 111633  =    185.165 ...   185.864 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 118151 ... 118571  =    196.717 ...   197.416 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 119746 ... 120166  =    199.372 ...   200.072 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 121538 ... 121958  =    202.356 ...   203.055 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 123242 ... 123662  =    205.193 ...   205.892 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 124952 ... 125372  =    208.040 ...   208.739 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 126506 ... 126926  =    210.627 ...   211.327 secs...
[done]
Applying baseline correction ... (mode: mean)
Reading 128160 ... 128580  =    213.381 ...   214.081 secs...
[done]
Applying baseline correction ... (mode: mean)
Computing time-frequency power on single epochs...
No baseline correction applied...
Computing time-frequency power on single epochs...
No baseline correction applied...
Computing time-frequency power on single epochs...
No baseline correction applied...
Computing time-frequency power on single epochs...
No baseline correction applied...
</pre></div>
</div>
<p>Setup repeated measures ANOVA</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">n_conditions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">event_id</span><span class="p">)</span>
<span class="n">n_replications</span> <span class="o">=</span> <span class="n">epochs</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">n_conditions</span>
<span class="c"># we will tell the ANOVA how to interpret the data matrix in terms of</span>
<span class="c"># factors. This done via the factor levels argument which is a list</span>
<span class="c"># of the number factor levels for each factor.</span>
<span class="n">factor_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>  <span class="c"># number of levels in each factor</span>
<span class="n">effects</span> <span class="o">=</span> <span class="s">&#39;A*B&#39;</span>  <span class="c"># this is the default signature for computing all effects</span>
<span class="c"># Other possible options are &#39;A&#39; or &#39;B&#39; for the corresponding main effects</span>
<span class="c"># or &#39;A:B&#39; for the interaction effect only (this notation is borrowed from the</span>
<span class="c"># R formula language)</span>
<span class="n">n_frequencies</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
<span class="n">n_times</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">[::</span><span class="n">decim</span><span class="p">])</span>

<span class="c"># Now we&#39;ll assemble the data matrix and swap axes so the trial replications</span>
<span class="c"># are the first dimension and the conditions are the second dimension</span>
<span class="n">data</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.swapaxes.html#numpy.swapaxes"><span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.asarray.html#numpy.asarray"><span class="n">np</span><span class="o">.</span><span class="n">asarray</span></a><span class="p">(</span><span class="n">epochs_power</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c"># reshape last two dimensions in one mass-univariate observation-vector</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_replications</span><span class="p">,</span> <span class="n">n_conditions</span><span class="p">,</span> <span class="n">n_frequencies</span> <span class="o">*</span> <span class="n">n_times</span><span class="p">)</span>

<span class="c"># so we have replications * conditions * observations:</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c"># while the iteration scheme used above for assembling the data matrix</span>
<span class="c"># makes sure the first two dimensions are organized as expected (with A =</span>
<span class="c"># modality and B = location):</span>
<span class="c">#</span>
<span class="c">#           A1B1 A1B2 A2B1 B2B2</span>
<span class="c"># trial 1   1.34 2.53 0.97 1.74</span>
<span class="c"># trial ... .... .... .... ....</span>
<span class="c"># trial 56  2.45 7.90 3.09 4.76</span>
<span class="c">#</span>
<span class="c"># Now we&#39;re ready to run our repeated measures ANOVA.</span>

<span class="n">fvals</span><span class="p">,</span> <span class="n">pvals</span> <span class="o">=</span> <a href="../generated/mne.stats.f_mway_rm.html#mne.stats.f_mway_rm"><span class="n">f_mway_rm</span></a><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">factor_levels</span><span class="p">,</span> <span class="n">effects</span><span class="o">=</span><span class="n">effects</span><span class="p">)</span>

<span class="n">effect_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;modality&#39;</span><span class="p">,</span> <span class="s">&#39;location&#39;</span><span class="p">,</span> <span class="s">&#39;modality by location&#39;</span><span class="p">]</span>

<span class="c"># let&#39;s visualize our effects by computing f-images</span>
<span class="k">for</span> <span class="n">effect</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">effect_label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fvals</span><span class="p">,</span> <span class="n">pvals</span><span class="p">,</span> <span class="n">effect_labels</span><span class="p">):</span>
    <a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
    <span class="c"># show naive F-values in gray</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">effect</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">211</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.gray"><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span></a><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">frequencies</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">frequencies</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">aspect</span><span class="o">=</span><span class="s">&#39;auto&#39;</span><span class="p">,</span>
               <span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">)</span>
    <span class="c"># create mask for significant Time-frequency locations</span>
    <span class="n">effect</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ma.masked_array.all.html#numpy.ma.masked_array"><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span></a><span class="p">(</span><span class="n">effect</span><span class="p">,</span> <span class="p">[</span><span class="n">sig</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mo">05</span><span class="p">])</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">effect</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">211</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">frequencies</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">frequencies</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">aspect</span><span class="o">=</span><span class="s">&#39;auto&#39;</span><span class="p">,</span>
               <span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">)</span>
    <a href="http://matplotlib.org/api/colorbar_api.html#matplotlib.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.xlabel"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s">&#39;time (ms)&#39;</span><span class="p">)</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.ylabel"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s">r&quot;Time-locked response for &#39;</span><span class="si">%s</span><span class="s">&#39; (</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">effect_label</span><span class="p">,</span> <span class="n">ch_name</span><span class="p">))</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>

<span class="c"># Note. As we treat trials as subjects, the test only accounts for</span>
<span class="c"># time locked responses despite the &#39;induced&#39; approach.</span>
<span class="c"># For analysis for induced power at the group level averaged TRFs</span>
<span class="c"># are required.</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_001.png"><img alt="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_001.png" src="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_001.png" style="width: 376.0px; height: 282.0px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_002.png"><img alt="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_002.png" src="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_002.png" style="width: 376.0px; height: 282.0px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_003.png"><img alt="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_003.png" src="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_003.png" style="width: 376.0px; height: 282.0px;" /></a>
</li>
</ul>
<p><strong>Script output</strong>:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="mi">56</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1688</span><span class="p">)</span>
</pre></div>
</div>
<p>Account for multiple comparisons using FDR versus permutation clustering test</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># First we need to slightly modify the ANOVA function to be suitable for</span>
<span class="c"># the clustering procedure. Also want to set some defaults.</span>
<span class="c"># Let&#39;s first override effects to confine the analysis to the interaction</span>
<span class="n">effects</span> <span class="o">=</span> <span class="s">&#39;A:B&#39;</span>


<span class="c"># A stat_fun must deal with a variable number of input arguments.</span>
<span class="k">def</span> <span class="nf">stat_fun</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="c"># Inside the clustering function each condition will be passed as</span>
    <span class="c"># flattened array, necessitated by the clustering procedure.</span>
    <span class="c"># The ANOVA however expects an input array of dimensions:</span>
    <span class="c"># subjects X conditions X observations (optional).</span>
    <span class="c"># The following expression catches the list input and swaps the first and</span>
    <span class="c"># the second dimension and finally calls the ANOVA function.</span>
    <span class="k">return</span> <a href="../generated/mne.stats.f_mway_rm.html#mne.stats.f_mway_rm"><span class="n">f_mway_rm</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.swapaxes.html#numpy.swapaxes"><span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span></a><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">factor_levels</span><span class="o">=</span><span class="n">factor_levels</span><span class="p">,</span>
                     <span class="n">effects</span><span class="o">=</span><span class="n">effects</span><span class="p">,</span> <span class="n">return_pvals</span><span class="o">=</span><span class="bp">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c"># The ANOVA returns a tuple f-values and p-values, we will pick the former.</span>


<span class="n">pthresh</span> <span class="o">=</span> <span class="mf">0.00001</span>  <span class="c"># set threshold rather high to save some time</span>
<span class="n">f_thresh</span> <span class="o">=</span> <span class="n">f_threshold_mway_rm</span><span class="p">(</span><span class="n">n_replications</span><span class="p">,</span> <span class="n">factor_levels</span><span class="p">,</span> <span class="n">effects</span><span class="p">,</span>
                               <span class="n">pthresh</span><span class="p">)</span>
<span class="n">tail</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c"># f-test, so tail &gt; 0</span>
<span class="n">n_permutations</span> <span class="o">=</span> <span class="mi">256</span>  <span class="c"># Save some time (the test won&#39;t be too sensitive ...)</span>
<span class="n">T_obs</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">cluster_p_values</span><span class="p">,</span> <span class="n">h0</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">permutation_cluster_test</span><span class="p">(</span>
    <span class="n">epochs_power</span><span class="p">,</span> <span class="n">stat_fun</span><span class="o">=</span><span class="n">stat_fun</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">f_thresh</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">n_permutations</span><span class="o">=</span><span class="n">n_permutations</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

<span class="c"># Create new stats image with only significant clusters</span>
<span class="n">good_clusers</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.where.html#numpy.where"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">cluster_p_values</span> <span class="o">&lt;</span> <span class="o">.</span><span class="mo">05</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">T_obs_plot</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ma.masked_array.all.html#numpy.ma.masked_array"><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span></a><span class="p">(</span><span class="n">T_obs</span><span class="p">,</span>
                                <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.invert.html#numpy.invert"><span class="n">np</span><span class="o">.</span><span class="n">invert</span></a><span class="p">(</span><span class="n">clusters</span><span class="p">[</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.squeeze.html#numpy.squeeze"><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span></a><span class="p">(</span><span class="n">good_clusers</span><span class="p">)]))</span>

<a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="k">for</span> <span class="n">f_image</span><span class="p">,</span> <span class="n">cmap</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">T_obs</span><span class="p">,</span> <span class="n">T_obs_plot</span><span class="p">],</span> <span class="p">[</span><a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.gray"><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span></a><span class="p">,</span> <span class="s">&#39;RdBu_r&#39;</span><span class="p">]):</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">f_image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
               <span class="n">frequencies</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">frequencies</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">aspect</span><span class="o">=</span><span class="s">&#39;auto&#39;</span><span class="p">,</span>
               <span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.xlabel"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s">&#39;time (ms)&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.ylabel"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s">&#39;Time-locked response for </span><span class="se">\&#39;</span><span class="s">modality by location</span><span class="se">\&#39;</span><span class="s"> (</span><span class="si">%s</span><span class="s">)</span><span class="se">\n</span><span class="s">&#39;</span>
          <span class="s">&#39; cluster-level corrected (p &lt;= 0.05)&#39;</span> <span class="o">%</span> <span class="n">ch_name</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>

<span class="c"># now using FDR</span>
<span class="n">mask</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <a href="../generated/mne.stats.fdr_correction.html#mne.stats.fdr_correction"><span class="n">fdr_correction</span></a><span class="p">(</span><span class="n">pvals</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">T_obs_plot2</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.ma.masked_array.all.html#numpy.ma.masked_array"><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span></a><span class="p">(</span><span class="n">T_obs</span><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.invert.html#numpy.invert"><span class="n">np</span><span class="o">.</span><span class="n">invert</span></a><span class="p">(</span><span class="n">mask</span><span class="p">))</span>

<a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="k">for</span> <span class="n">f_image</span><span class="p">,</span> <span class="n">cmap</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">T_obs</span><span class="p">,</span> <span class="n">T_obs_plot2</span><span class="p">],</span> <span class="p">[</span><a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.gray"><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span></a><span class="p">,</span> <span class="s">&#39;RdBu_r&#39;</span><span class="p">]):</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">f_image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
               <span class="n">frequencies</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">frequencies</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">aspect</span><span class="o">=</span><span class="s">&#39;auto&#39;</span><span class="p">,</span>
               <span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">)</span>

<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.xlabel"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s">&#39;time (ms)&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.ylabel"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s">&#39;Time-locked response for </span><span class="se">\&#39;</span><span class="s">modality by location</span><span class="se">\&#39;</span><span class="s"> (</span><span class="si">%s</span><span class="s">)</span><span class="se">\n</span><span class="s">&#39;</span>
          <span class="s">&#39; FDR corrected (p &lt;= 0.05)&#39;</span> <span class="o">%</span> <span class="n">ch_name</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>

<span class="c"># Both, cluster level and FDR correction help getting rid of</span>
<span class="c"># putatively spots we saw in the naive f-images.</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_004.png"><img alt="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_004.png" src="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_004.png" style="width: 376.0px; height: 282.0px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_005.png"><img alt="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_005.png" src="../_images/sphx_glr_plot_cluster_stats_time_frequency_repeated_measures_anova_005.png" style="width: 376.0px; height: 282.0px;" /></a>
</li>
</ul>
<p><strong>Script output</strong>:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre>stat_fun(H1): min=0.000000 max=56.064254
Running intial clustering
Found 1 clusters
Permuting ...

[                                        ] 0.39062 |
[.....                                   ] 12.50000 /
[..........                              ] 25.00000 -
[...............                         ] 37.50000 \
[....................                    ] 50.00000 |
[.........................               ] 62.50000 /
[..............................          ] 75.00000 -
[...................................     ] 87.50000 \
[........................................] 100.00000 |    Computing cluster p-values
Done.
</pre></div>
</div>
<p><strong>Total running time of the script:</strong>
(0 minutes 7.793 seconds)</p>
<p><strong>Download Python source code:</strong> <a class="reference download internal" href="../_downloads/plot_cluster_stats_time_frequency_repeated_measures_anova.py"><code class="xref download docutils literal"><span class="pre">plot_cluster_stats_time_frequency_repeated_measures_anova.py</span></code></a></p>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2012-2015, MNE Developers.<br/>
    </p>
  </div>
</footer>
  </body>
</html>