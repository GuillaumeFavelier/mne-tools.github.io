

.. _sphx_glr_auto_examples_time_frequency_plot_stockwell.py:


=======================================================
Time frequency with Stockwell transform in sensor space
=======================================================

This script shows how to compute induced power and intertrial coherence
using the Stockwell transform, a.k.a. S-Transform.



.. code-block:: python

    # Authors: Denis A. Engemann <denis.engemann@gmail.com>
    #          Alexandre Gramfort <alexandre.gramfort@telecom-paristech.fr>
    #
    # License: BSD (3-clause)

    import mne
    from mne import io
    from mne.time_frequency import tfr_stockwell
    from mne.datasets import somato

    print(__doc__)




.. rst-class:: sphx-glr-horizontal





Set parameters


.. code-block:: python

    data_path = somato.data_path()
    raw_fname = data_path + '/MEG/somato/sef_raw_sss.fif'
    event_id, tmin, tmax = 1, -1., 3.

    # Setup for reading the raw data
    raw = io.Raw(raw_fname)
    baseline = (None, 0)
    events = mne.find_events(raw, stim_channel='STI 014')

    # picks MEG gradiometers
    picks = mne.pick_types(raw.info, meg='grad', eeg=False, eog=True, stim=False)

    epochs = mne.Epochs(raw, events, event_id, tmin, tmax, picks=picks,
                        baseline=baseline, reject=dict(grad=4000e-13, eog=350e-6),
                        preload=True)




.. rst-class:: sphx-glr-horizontal



**Script output**:

.. rst-class:: sphx-glr-script-out

  ::

    Opening raw data file /home/jaakko/examples/MNE-somato-data/MEG/somato/sef_raw_sss.fif...
    Current compensation grade : 0
        Range : 237600 ... 506999 =    791.189 ...  1688.266 secs
    Ready.
    Reading 0 ... 269399  =      0.000 ...   897.077 secs...
    [done]
    111 events found
    Events id: [1]
    111 matching events found
    0 projection items activated
    Reading 1747 ... 2948  =      5.817 ...     9.817 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 4215 ... 5416  =     14.036 ...    18.035 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 6425 ... 7626  =     21.395 ...    25.394 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 9108 ... 10309  =     30.329 ...    34.328 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 11507 ... 12708  =     38.317 ...    42.317 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 13702 ... 14903  =     45.627 ...    49.626 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 16122 ... 17323  =     53.685 ...    57.684 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 18335 ... 19536  =     61.054 ...    65.053 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 20580 ... 21781  =     68.530 ...    72.529 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 22877 ... 24078  =     76.179 ...    80.178 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 25066 ... 26267  =     83.468 ...    87.467 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 27537 ... 28738  =     91.696 ...    95.695 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 29762 ... 30963  =     99.105 ...   103.104 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32424 ... 33625  =    107.969 ...   111.969 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 34895 ... 36096  =    116.198 ...   120.197 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 37120 ... 38321  =    123.607 ...   127.606 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 39501 ... 40702  =    131.535 ...   135.534 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 42103 ... 43304  =    140.200 ...   144.199 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 44466 ... 45667  =    148.068 ...   152.067 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 46634 ... 47835  =    155.287 ...   159.287 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 49285 ... 50486  =    164.115 ...   168.114 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 51785 ... 52986  =    172.440 ...   176.439 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 53980 ... 55181  =    179.749 ...   183.748 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 56547 ... 57748  =    188.297 ...   192.296 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 59069 ... 60270  =    196.695 ...   200.694 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 61279 ... 62480  =    204.054 ...   208.053 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 63842 ... 65043  =    212.589 ...   216.588 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 66070 ... 67271  =    220.008 ...   224.007 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 68319 ... 69520  =    227.497 ...   231.496 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 70814 ... 72015  =    235.805 ...   239.804 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 73488 ... 74689  =    244.709 ...   248.708 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 76151 ... 77352  =    253.577 ...   257.576 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 78733 ... 79934  =    262.175 ...   266.174 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 81308 ... 82509  =    270.749 ...   274.748 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 83998 ... 85199  =    279.707 ...   283.706 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 86514 ... 87715  =    288.085 ...   292.084 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 89008 ... 90209  =    296.390 ...   300.389 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 91176 ... 92377  =    303.609 ...   307.608 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 93686 ... 94887  =    311.967 ...   315.966 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 95878 ... 97079  =    319.266 ...   323.265 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 98172 ... 99373  =    326.905 ...   330.904 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 100540 ... 101741  =    334.790 ...   338.789 secs...
    [done]
    Applying baseline correction ... (mode: mean)
        Rejecting  epoch based on EOG : [u'EOG 061']
    Reading 102885 ... 104086  =    342.599 ...   346.598 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 105287 ... 106488  =    350.597 ...   354.597 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 107893 ... 109094  =    359.275 ...   363.274 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 110483 ... 111684  =    367.900 ...   371.899 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 112921 ... 114122  =    376.018 ...   380.017 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 115434 ... 116635  =    384.386 ...   388.385 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 117617 ... 118818  =    391.655 ...   395.654 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 120222 ... 121423  =    400.330 ...   404.329 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 122741 ... 123942  =    408.718 ...   412.717 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 124963 ... 126164  =    416.117 ...   420.116 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 127101 ... 128302  =    423.236 ...   427.235 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 129461 ... 130662  =    431.095 ...   435.094 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 132063 ... 133264  =    439.759 ...   443.758 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 134342 ... 135543  =    447.348 ...   451.347 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 136642 ... 137843  =    455.007 ...   459.006 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 139062 ... 140263  =    463.065 ...   467.065 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 141179 ... 142380  =    470.115 ...   474.114 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 143802 ... 145003  =    478.849 ...   482.848 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 146009 ... 147210  =    486.198 ...   490.198 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 148687 ... 149888  =    495.116 ...   499.115 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 151221 ... 152422  =    503.554 ...   507.553 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 153586 ... 154787  =    511.429 ...   515.428 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 156162 ... 157363  =    520.007 ...   524.006 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 158558 ... 159759  =    527.985 ...   531.985 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 160855 ... 162056  =    535.634 ...   539.634 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 163043 ... 164244  =    542.920 ...   546.919 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 165583 ... 166784  =    551.378 ...   555.377 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 167949 ... 169150  =    559.257 ...   563.256 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 170258 ... 171459  =    566.946 ...   570.945 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 172725 ... 173926  =    575.160 ...   579.160 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 175388 ... 176589  =    584.028 ...   588.027 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 177568 ... 178769  =    591.287 ...   595.287 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 180120 ... 181321  =    599.785 ...   603.784 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 182246 ... 183447  =    606.865 ...   610.864 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 184695 ... 185896  =    615.020 ...   619.019 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 187187 ... 188388  =    623.318 ...   627.317 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 189292 ... 190493  =    630.327 ...   634.326 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 191970 ... 193171  =    639.245 ...   643.244 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 194269 ... 195470  =    646.900 ...   650.900 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 196872 ... 198073  =    655.568 ...   659.567 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 199337 ... 200538  =    663.776 ...   667.776 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 201442 ... 202643  =    670.786 ...   674.785 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 204050 ... 205251  =    679.470 ...   683.469 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 206455 ... 207656  =    687.479 ...   691.478 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 208692 ... 209893  =    694.928 ...   698.927 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 211193 ... 212394  =    703.256 ...   707.255 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 213771 ... 214972  =    711.840 ...   715.840 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 215906 ... 217107  =    718.950 ...   722.949 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 218461 ... 219662  =    727.458 ...   731.457 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 220929 ... 222130  =    735.676 ...   739.675 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 223579 ... 224780  =    744.500 ...   748.499 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 225894 ... 227095  =    752.209 ...   756.208 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 228113 ... 229314  =    759.598 ...   763.597 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 230407 ... 231608  =    767.237 ...   771.236 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 232839 ... 234040  =    775.335 ...   779.335 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 235459 ... 236660  =    784.060 ...   788.059 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 238125 ... 239326  =    792.937 ...   796.936 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 240242 ... 241443  =    799.987 ...   803.986 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 242584 ... 243785  =    807.785 ...   811.785 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 245141 ... 246342  =    816.300 ...   820.299 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 247636 ... 248837  =    824.608 ...   828.607 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 250254 ... 251455  =    833.326 ...   837.325 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 252826 ... 254027  =    841.890 ...   845.890 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 255264 ... 256465  =    850.009 ...   854.008 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 257714 ... 258915  =    858.167 ...   862.166 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 260158 ... 261359  =    866.305 ...   870.305 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 262598 ... 263799  =    874.430 ...   878.430 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 264865 ... 266066  =    881.979 ...   885.979 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 267411 ... 268612  =    890.457 ...   894.457 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    3 bad epochs dropped


Calculate power and intertrial coherence


.. code-block:: python


    epochs = epochs.pick_channels([epochs.ch_names[82]])  # reduce computation

    power, itc = tfr_stockwell(epochs, fmin=6., fmax=30., decim=4, n_jobs=1,
                               width=.3, return_itc=True)

    power.plot([0], baseline=(-0.5, 0), mode=None, title='S-transform (power)')

    itc.plot([0], baseline=None, mode=None, title='S-transform (ITC)')



.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/time_frequency/images/sphx_glr_plot_stockwell_001.png
            :scale: 47

    *

      .. image:: /auto_examples/time_frequency/images/sphx_glr_plot_stockwell_002.png
            :scale: 47


**Script output**:

.. rst-class:: sphx-glr-script-out

  ::

    The input signal is shorter (1202) than "n_fft" (2048). Applying zero padding.


**Total running time of the script:**
(0 minutes 2.971 seconds)



**Download Python source code:** :download:`plot_stockwell.py <plot_stockwell.py>`
