

.. _sphx_glr_auto_examples_inverse_plot_tf_dics.py:


=====================================
Time-frequency beamforming using DICS
=====================================

Compute DICS source power in a grid of time-frequency windows and display
results.

The original reference is:
Dalal et al. Five-dimensional neuroimaging: Localization of the time-frequency
dynamics of cortical activity. NeuroImage (2008) vol. 40 (4) pp. 1686-1700


.. code-block:: python

    # Author: Roman Goj <roman.goj@gmail.com>
    #
    # License: BSD (3-clause)

    import mne
    from mne.io import Raw
    from mne.event import make_fixed_length_events
    from mne.datasets import sample
    from mne.time_frequency import compute_epochs_csd
    from mne.beamformer import tf_dics
    from mne.viz import plot_source_spectrogram

    print(__doc__)

    data_path = sample.data_path()
    raw_fname = data_path + '/MEG/sample/sample_audvis_raw.fif'
    noise_fname = data_path + '/MEG/sample/ernoise_raw.fif'
    event_fname = data_path + '/MEG/sample/sample_audvis_raw-eve.fif'
    fname_fwd = data_path + '/MEG/sample/sample_audvis-meg-eeg-oct-6-fwd.fif'
    subjects_dir = data_path + '/subjects'
    label_name = 'Aud-lh'
    fname_label = data_path + '/MEG/sample/labels/%s.label' % label_name




.. rst-class:: sphx-glr-horizontal





Read raw data


.. code-block:: python

    raw = Raw(raw_fname)
    raw.info['bads'] = ['MEG 2443']  # 1 bad MEG channel

    # Pick a selection of magnetometer channels. A subset of all channels was used
    # to speed up the example. For a solution based on all MEG channels use
    # meg=True, selection=None and add mag=4e-12 to the reject dictionary.
    left_temporal_channels = mne.read_selection('Left-temporal')
    picks = mne.pick_types(raw.info, meg='mag', eeg=False, eog=False,
                           stim=False, exclude='bads',
                           selection=left_temporal_channels)
    reject = dict(mag=4e-12)

    # Setting time windows. Note that tmin and tmax are set so that time-frequency
    # beamforming will be performed for a wider range of time points than will
    # later be displayed on the final spectrogram. This ensures that all time bins
    # displayed represent an average of an equal number of time windows.
    tmin, tmax, tstep = -0.55, 0.75, 0.05  # s
    tmin_plot, tmax_plot = -0.3, 0.5  # s

    # Read epochs
    event_id = 1
    events = mne.read_events(event_fname)
    epochs = mne.Epochs(raw, events, event_id, tmin, tmax, proj=True, picks=picks,
                        baseline=None, preload=True, reject=reject)

    # Read empty room noise raw data
    raw_noise = Raw(noise_fname)
    raw_noise.info['bads'] = ['MEG 2443']  # 1 bad MEG channel

    # Create noise epochs and make sure the number of noise epochs corresponds to
    # the number of data epochs
    events_noise = make_fixed_length_events(raw_noise, event_id)
    epochs_noise = mne.Epochs(raw_noise, events_noise, event_id, tmin_plot,
                              tmax_plot, proj=True, picks=picks,
                              baseline=None, preload=True, reject=reject)
    # then make sure the number of epochs is the same
    epochs_noise = epochs_noise[:len(epochs.events)]

    # Read forward operator
    forward = mne.read_forward_solution(fname_fwd, surf_ori=True)

    # Read label
    label = mne.read_label(fname_label)




.. rst-class:: sphx-glr-horizontal



**Script output**:

.. rst-class:: sphx-glr-script-out

  ::

    Opening raw data file /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/sample_audvis_raw.fif...
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
    Current compensation grade : 0
        Range : 25800 ... 192599 =     42.956 ...   320.670 secs
    Ready.
    Adding average EEG reference projection.
    1 projection items deactivated
    72 matching events found
    Created an SSP operator (subspace dimension = 3)
    4 projection items activated
    Reading 2641 ... 3421  =      4.397 ...     5.696 secs...
    [done]
    No baseline correction applied...
    Reading 4320 ... 5100  =      7.193 ...     8.491 secs...
    [done]
    No baseline correction applied...
    Reading 5971 ... 6751  =      9.941 ...    11.240 secs...
    [done]
    No baseline correction applied...
    Reading 7582 ... 8362  =     12.624 ...    13.922 secs...
    [done]
    No baseline correction applied...
    Reading 9298 ... 10078  =     15.481 ...    16.779 secs...
    [done]
    No baseline correction applied...
    Reading 10877 ... 11657  =     18.110 ...    19.408 secs...
    [done]
    No baseline correction applied...
    Reading 12581 ... 13361  =     20.947 ...    22.246 secs...
    [done]
    No baseline correction applied...
    Reading 14275 ... 15055  =     23.767 ...    25.066 secs...
    [done]
    No baseline correction applied...
    Reading 15996 ... 16776  =     26.633 ...    27.931 secs...
    [done]
    No baseline correction applied...
    Reading 17651 ... 18431  =     29.388 ...    30.687 secs...
    [done]
    No baseline correction applied...
    Reading 19356 ... 20136  =     32.227 ...    33.526 secs...
    [done]
    No baseline correction applied...
    Reading 20965 ... 21745  =     34.906 ...    36.205 secs...
    [done]
    No baseline correction applied...
    Reading 22592 ... 23372  =     37.615 ...    38.913 secs...
    [done]
    No baseline correction applied...
    Reading 24139 ... 24919  =     40.190 ...    41.489 secs...
    [done]
    No baseline correction applied...
    Reading 25751 ... 26531  =     42.874 ...    44.173 secs...
    [done]
    No baseline correction applied...
    Reading 27364 ... 28144  =     45.560 ...    46.859 secs...
    [done]
    No baseline correction applied...
    Reading 28970 ... 29750  =     48.234 ...    49.533 secs...
    [done]
    No baseline correction applied...
    Reading 30587 ... 31367  =     50.926 ...    52.225 secs...
    [done]
    No baseline correction applied...
    Reading 32318 ... 33098  =     53.808 ...    55.107 secs...
    [done]
    No baseline correction applied...
    Reading 33999 ... 34779  =     56.607 ...    57.906 secs...
    [done]
    No baseline correction applied...
    Reading 35738 ... 36518  =     59.502 ...    60.801 secs...
    [done]
    No baseline correction applied...
    Reading 37402 ... 38182  =     62.273 ...    63.572 secs...
    [done]
    No baseline correction applied...
    Reading 39051 ... 39831  =     65.018 ...    66.317 secs...
    [done]
    No baseline correction applied...
    Reading 40834 ... 41614  =     67.987 ...    69.286 secs...
    [done]
    No baseline correction applied...
    Reading 42536 ... 43316  =     70.821 ...    72.119 secs...
    [done]
    No baseline correction applied...
    Reading 44129 ... 44909  =     73.473 ...    74.772 secs...
    [done]
    No baseline correction applied...
    Reading 45861 ... 46641  =     76.357 ...    77.655 secs...
    [done]
    No baseline correction applied...
    Reading 47588 ... 48368  =     79.232 ...    80.531 secs...
    [done]
    No baseline correction applied...
    Reading 50764 ... 51544  =     84.520 ...    85.819 secs...
    [done]
    No baseline correction applied...
    Reading 52409 ... 53189  =     87.259 ...    88.558 secs...
    [done]
    No baseline correction applied...
    Reading 54079 ... 54859  =     90.039 ...    91.338 secs...
    [done]
    No baseline correction applied...
    Reading 55781 ... 56561  =     92.873 ...    94.172 secs...
    [done]
    No baseline correction applied...
    Reading 57438 ... 58218  =     95.632 ...    96.931 secs...
    [done]
    No baseline correction applied...
    Reading 59169 ... 59949  =     98.514 ...    99.813 secs...
    [done]
    No baseline correction applied...
    Reading 60841 ... 61621  =    101.298 ...   102.597 secs...
    [done]
    No baseline correction applied...
    Reading 62463 ... 63243  =    103.998 ...   105.297 secs...
    [done]
    No baseline correction applied...
    Reading 64289 ... 65069  =    107.039 ...   108.337 secs...
    [done]
    No baseline correction applied...
    Reading 65908 ... 66688  =    109.734 ...   111.033 secs...
    [done]
    No baseline correction applied...
    Reading 67539 ... 68319  =    112.450 ...   113.748 secs...
    [done]
    No baseline correction applied...
    Reading 69305 ... 70085  =    115.390 ...   116.689 secs...
    [done]
    No baseline correction applied...
    Reading 71104 ... 71884  =    118.385 ...   119.684 secs...
    [done]
    No baseline correction applied...
    Reading 72773 ... 73553  =    121.164 ...   122.463 secs...
    [done]
    No baseline correction applied...
    Reading 74490 ... 75270  =    124.023 ...   125.322 secs...
    [done]
    No baseline correction applied...
    Reading 76158 ... 76938  =    126.800 ...   128.099 secs...
    [done]
    No baseline correction applied...
    Reading 77903 ... 78683  =    129.705 ...   131.004 secs...
    [done]
    No baseline correction applied...
    Reading 79630 ... 80410  =    132.581 ...   133.879 secs...
    [done]
    No baseline correction applied...
    Reading 81225 ... 82005  =    135.236 ...   136.535 secs...
    [done]
    No baseline correction applied...
    Reading 84444 ... 85224  =    140.596 ...   141.895 secs...
    [done]
    No baseline correction applied...
    Reading 86162 ... 86942  =    143.456 ...   144.755 secs...
    [done]
    No baseline correction applied...
    Reading 87822 ... 88602  =    146.220 ...   147.519 secs...
    [done]
    No baseline correction applied...
    Reading 89489 ... 90269  =    148.996 ...   150.294 secs...
    [done]
    No baseline correction applied...
    Reading 91174 ... 91954  =    151.801 ...   153.100 secs...
    [done]
    No baseline correction applied...
    Reading 92749 ... 93529  =    154.423 ...   155.722 secs...
    [done]
    No baseline correction applied...
    Reading 94409 ... 95189  =    157.187 ...   158.486 secs...
    [done]
    No baseline correction applied...
    Reading 96088 ... 96868  =    159.983 ...   161.281 secs...
    [done]
    No baseline correction applied...
    Reading 97801 ... 98581  =    162.835 ...   164.133 secs...
    [done]
    No baseline correction applied...
    Reading 99579 ... 100359  =    165.795 ...   167.094 secs...
    [done]
    No baseline correction applied...
    Reading 101201 ... 101981  =    168.496 ...   169.794 secs...
    [done]
    No baseline correction applied...
    Reading 102795 ... 103575  =    171.150 ...   172.448 secs...
    [done]
    No baseline correction applied...
    Reading 104365 ... 105145  =    173.764 ...   175.062 secs...
    [done]
    No baseline correction applied...
    Reading 105951 ... 106731  =    176.404 ...   177.703 secs...
    [done]
    No baseline correction applied...
    Reading 109403 ... 110183  =    182.152 ...   183.450 secs...
    [done]
    No baseline correction applied...
    Reading 111003 ... 111783  =    184.816 ...   186.114 secs...
    [done]
    No baseline correction applied...
    Reading 112706 ... 113486  =    187.651 ...   188.950 secs...
    [done]
    No baseline correction applied...
    Reading 114482 ... 115262  =    190.608 ...   191.907 secs...
    [done]
    No baseline correction applied...
    Reading 117941 ... 118721  =    196.367 ...   197.666 secs...
    [done]
    No baseline correction applied...
    Reading 119536 ... 120316  =    199.023 ...   200.321 secs...
    [done]
    No baseline correction applied...
    Reading 121328 ... 122108  =    202.006 ...   203.305 secs...
    [done]
    No baseline correction applied...
    Reading 123032 ... 123812  =    204.843 ...   206.142 secs...
    [done]
    No baseline correction applied...
    Reading 124742 ... 125522  =    207.690 ...   208.989 secs...
    [done]
    No baseline correction applied...
    Reading 126296 ... 127076  =    210.278 ...   211.576 secs...
    [done]
    No baseline correction applied...
    Reading 127950 ... 128730  =    213.032 ...   214.330 secs...
    [done]
    No baseline correction applied...
    0 bad epochs dropped
    Opening raw data file /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/ernoise_raw.fif...
    Isotrak not found
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
    Current compensation grade : 0
        Range : 19800 ... 85867 =     32.966 ...   142.965 secs
    Ready.
    109 matching events found
    Created an SSP operator (subspace dimension = 3)
    3 projection items activated
    Reading 420 ... 900  =      0.699 ...     1.498 secs...
    [done]
    No baseline correction applied...
    Reading 1021 ... 1501  =      1.700 ...     2.499 secs...
    [done]
    No baseline correction applied...
    Reading 1621 ... 2101  =      2.699 ...     3.498 secs...
    [done]
    No baseline correction applied...
    Reading 2222 ... 2702  =      3.700 ...     4.499 secs...
    [done]
    No baseline correction applied...
    Reading 2823 ... 3303  =      4.700 ...     5.499 secs...
    [done]
    No baseline correction applied...
    Reading 3423 ... 3903  =      5.699 ...     6.498 secs...
    [done]
    No baseline correction applied...
    Reading 4024 ... 4504  =      6.700 ...     7.499 secs...
    [done]
    No baseline correction applied...
    Reading 4624 ... 5104  =      7.699 ...     8.498 secs...
    [done]
    No baseline correction applied...
    Reading 5225 ... 5705  =      8.699 ...     9.499 secs...
    [done]
    No baseline correction applied...
    Reading 5826 ... 6306  =      9.700 ...    10.499 secs...
    [done]
    No baseline correction applied...
    Reading 6426 ... 6906  =     10.699 ...    11.498 secs...
    [done]
    No baseline correction applied...
    Reading 7027 ... 7507  =     11.700 ...    12.499 secs...
    [done]
    No baseline correction applied...
    Reading 7627 ... 8107  =     12.699 ...    13.498 secs...
    [done]
    No baseline correction applied...
    Reading 8228 ... 8708  =     13.699 ...    14.498 secs...
    [done]
    No baseline correction applied...
    Reading 8829 ... 9309  =     14.700 ...    15.499 secs...
    [done]
    No baseline correction applied...
    Reading 9429 ... 9909  =     15.699 ...    16.498 secs...
    [done]
    No baseline correction applied...
    Reading 10030 ... 10510  =     16.700 ...    17.499 secs...
    [done]
    No baseline correction applied...
    Reading 10631 ... 11111  =     17.700 ...    18.499 secs...
    [done]
    No baseline correction applied...
    Reading 11231 ... 11711  =     18.699 ...    19.498 secs...
    [done]
    No baseline correction applied...
    Reading 11832 ... 12312  =     19.700 ...    20.499 secs...
    [done]
    No baseline correction applied...
    Reading 12432 ... 12912  =     20.699 ...    21.498 secs...
    [done]
    No baseline correction applied...
    Reading 13033 ... 13513  =     21.699 ...    22.499 secs...
    [done]
    No baseline correction applied...
    Reading 13634 ... 14114  =     22.700 ...    23.499 secs...
    [done]
    No baseline correction applied...
    Reading 14234 ... 14714  =     23.699 ...    24.498 secs...
    [done]
    No baseline correction applied...
    Reading 14835 ... 15315  =     24.700 ...    25.499 secs...
    [done]
    No baseline correction applied...
    Reading 15435 ... 15915  =     25.699 ...    26.498 secs...
    [done]
    No baseline correction applied...
    Reading 16036 ... 16516  =     26.699 ...    27.498 secs...
    [done]
    No baseline correction applied...
    Reading 16637 ... 17117  =     27.700 ...    28.499 secs...
    [done]
    No baseline correction applied...
    Reading 17237 ... 17717  =     28.699 ...    29.498 secs...
    [done]
    No baseline correction applied...
    Reading 17838 ... 18318  =     29.700 ...    30.499 secs...
    [done]
    No baseline correction applied...
    Reading 18439 ... 18919  =     30.700 ...    31.499 secs...
    [done]
    No baseline correction applied...
    Reading 19039 ... 19519  =     31.699 ...    32.498 secs...
    [done]
    No baseline correction applied...
    Reading 19640 ... 20120  =     32.700 ...    33.499 secs...
    [done]
    No baseline correction applied...
    Reading 20240 ... 20720  =     33.699 ...    34.498 secs...
    [done]
    No baseline correction applied...
    Reading 20841 ... 21321  =     34.699 ...    35.499 secs...
    [done]
    No baseline correction applied...
    Reading 21442 ... 21922  =     35.700 ...    36.499 secs...
    [done]
    No baseline correction applied...
    Reading 22042 ... 22522  =     36.699 ...    37.498 secs...
    [done]
    No baseline correction applied...
    Reading 22643 ... 23123  =     37.700 ...    38.499 secs...
    [done]
    No baseline correction applied...
    Reading 23243 ... 23723  =     38.699 ...    39.498 secs...
    [done]
    No baseline correction applied...
    Reading 23844 ... 24324  =     39.699 ...    40.498 secs...
    [done]
    No baseline correction applied...
    Reading 24445 ... 24925  =     40.700 ...    41.499 secs...
    [done]
    No baseline correction applied...
    Reading 25045 ... 25525  =     41.699 ...    42.498 secs...
    [done]
    No baseline correction applied...
    Reading 25646 ... 26126  =     42.700 ...    43.499 secs...
    [done]
    No baseline correction applied...
    Reading 26247 ... 26727  =     43.700 ...    44.499 secs...
    [done]
    No baseline correction applied...
    Reading 26847 ... 27327  =     44.699 ...    45.498 secs...
    [done]
    No baseline correction applied...
    Reading 27448 ... 27928  =     45.700 ...    46.499 secs...
    [done]
    No baseline correction applied...
    Reading 28048 ... 28528  =     46.699 ...    47.498 secs...
    [done]
    No baseline correction applied...
    Reading 28649 ... 29129  =     47.699 ...    48.499 secs...
    [done]
    No baseline correction applied...
    Reading 29250 ... 29730  =     48.700 ...    49.499 secs...
    [done]
    No baseline correction applied...
    Reading 29850 ... 30330  =     49.699 ...    50.498 secs...
    [done]
    No baseline correction applied...
    Reading 30451 ... 30931  =     50.700 ...    51.499 secs...
    [done]
    No baseline correction applied...
    Reading 31051 ... 31531  =     51.699 ...    52.498 secs...
    [done]
    No baseline correction applied...
    Reading 31652 ... 32132  =     52.699 ...    53.498 secs...
    [done]
    No baseline correction applied...
    Reading 32253 ... 32733  =     53.700 ...    54.499 secs...
    [done]
    No baseline correction applied...
    Reading 32853 ... 33333  =     54.699 ...    55.498 secs...
    [done]
    No baseline correction applied...
    Reading 33454 ... 33934  =     55.700 ...    56.499 secs...
    [done]
    No baseline correction applied...
    Reading 34055 ... 34535  =     56.700 ...    57.499 secs...
    [done]
    No baseline correction applied...
    Reading 34655 ... 35135  =     57.699 ...    58.498 secs...
    [done]
    No baseline correction applied...
    Reading 35256 ... 35736  =     58.700 ...    59.499 secs...
    [done]
    No baseline correction applied...
    Reading 35856 ... 36336  =     59.699 ...    60.498 secs...
    [done]
    No baseline correction applied...
    Reading 36457 ... 36937  =     60.699 ...    61.499 secs...
    [done]
    No baseline correction applied...
    Reading 37058 ... 37538  =     61.700 ...    62.499 secs...
    [done]
    No baseline correction applied...
    Reading 37658 ... 38138  =     62.699 ...    63.498 secs...
    [done]
    No baseline correction applied...
    Reading 38259 ... 38739  =     63.700 ...    64.499 secs...
    [done]
    No baseline correction applied...
    Reading 38859 ... 39339  =     64.699 ...    65.498 secs...
    [done]
    No baseline correction applied...
    Reading 39460 ... 39940  =     65.699 ...    66.499 secs...
    [done]
    No baseline correction applied...
    Reading 40061 ... 40541  =     66.700 ...    67.499 secs...
    [done]
    No baseline correction applied...
    Reading 40661 ... 41141  =     67.699 ...    68.498 secs...
    [done]
    No baseline correction applied...
    Reading 41262 ... 41742  =     68.700 ...    69.499 secs...
    [done]
    No baseline correction applied...
    Reading 41863 ... 42343  =     69.700 ...    70.499 secs...
    [done]
    No baseline correction applied...
    Reading 42463 ... 42943  =     70.699 ...    71.498 secs...
    [done]
    No baseline correction applied...
    Reading 43064 ... 43544  =     71.700 ...    72.499 secs...
    [done]
    No baseline correction applied...
    Reading 43664 ... 44144  =     72.699 ...    73.498 secs...
    [done]
    No baseline correction applied...
    Reading 44265 ... 44745  =     73.699 ...    74.499 secs...
    [done]
    No baseline correction applied...
    Reading 44866 ... 45346  =     74.700 ...    75.499 secs...
    [done]
    No baseline correction applied...
    Reading 45466 ... 45946  =     75.699 ...    76.498 secs...
    [done]
    No baseline correction applied...
    Reading 46067 ... 46547  =     76.700 ...    77.499 secs...
    [done]
    No baseline correction applied...
    Reading 46667 ... 47147  =     77.699 ...    78.498 secs...
    [done]
    No baseline correction applied...
    Reading 47268 ... 47748  =     78.699 ...    79.499 secs...
    [done]
    No baseline correction applied...
    Reading 47869 ... 48349  =     79.700 ...    80.499 secs...
    [done]
    No baseline correction applied...
    Reading 48469 ... 48949  =     80.699 ...    81.498 secs...
    [done]
    No baseline correction applied...
    Reading 49070 ... 49550  =     81.700 ...    82.499 secs...
    [done]
    No baseline correction applied...
    Reading 49671 ... 50151  =     82.700 ...    83.499 secs...
    [done]
    No baseline correction applied...
    Reading 50271 ... 50751  =     83.699 ...    84.498 secs...
    [done]
    No baseline correction applied...
    Reading 50872 ... 51352  =     84.700 ...    85.499 secs...
    [done]
    No baseline correction applied...
    Reading 51472 ... 51952  =     85.699 ...    86.498 secs...
    [done]
    No baseline correction applied...
    Reading 52073 ... 52553  =     86.699 ...    87.499 secs...
    [done]
    No baseline correction applied...
    Reading 52674 ... 53154  =     87.700 ...    88.499 secs...
    [done]
    No baseline correction applied...
    Reading 53274 ... 53754  =     88.699 ...    89.498 secs...
    [done]
    No baseline correction applied...
    Reading 53875 ... 54355  =     89.700 ...    90.499 secs...
    [done]
    No baseline correction applied...
    Reading 54475 ... 54955  =     90.699 ...    91.498 secs...
    [done]
    No baseline correction applied...
    Reading 55076 ... 55556  =     91.699 ...    92.499 secs...
    [done]
    No baseline correction applied...
    Reading 55677 ... 56157  =     92.700 ...    93.499 secs...
    [done]
    No baseline correction applied...
    Reading 56277 ... 56757  =     93.699 ...    94.498 secs...
    [done]
    No baseline correction applied...
    Reading 56878 ... 57358  =     94.700 ...    95.499 secs...
    [done]
    No baseline correction applied...
    Reading 57479 ... 57959  =     95.700 ...    96.499 secs...
    [done]
    No baseline correction applied...
    Reading 58079 ... 58559  =     96.699 ...    97.498 secs...
    [done]
    No baseline correction applied...
    Reading 58680 ... 59160  =     97.700 ...    98.499 secs...
    [done]
    No baseline correction applied...
    Reading 59280 ... 59760  =     98.699 ...    99.498 secs...
    [done]
    No baseline correction applied...
    Reading 59881 ... 60361  =     99.699 ...   100.499 secs...
    [done]
    No baseline correction applied...
    Reading 60482 ... 60962  =    100.700 ...   101.499 secs...
    [done]
    No baseline correction applied...
    Reading 61082 ... 61562  =    101.699 ...   102.498 secs...
    [done]
    No baseline correction applied...
    Reading 61683 ... 62163  =    102.700 ...   103.499 secs...
    [done]
    No baseline correction applied...
    Reading 62283 ... 62763  =    103.699 ...   104.498 secs...
    [done]
    No baseline correction applied...
    Reading 62884 ... 63364  =    104.699 ...   105.499 secs...
    [done]
    No baseline correction applied...
    Reading 63485 ... 63965  =    105.700 ...   106.499 secs...
    [done]
    No baseline correction applied...
    Reading 64085 ... 64565  =    106.699 ...   107.498 secs...
    [done]
    No baseline correction applied...
    Reading 64686 ... 65166  =    107.700 ...   108.499 secs...
    [done]
    No baseline correction applied...
    1 bad epochs dropped
    Reading forward solution from /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/sample_audvis-meg-eeg-oct-6-fwd.fif...
        Reading a source space...
        Computing patch statistics...
        Patch information added...
        Distance information added...
        [done]
        Reading a source space...
        Computing patch statistics...
        Patch information added...
        Distance information added...
        [done]
        2 source spaces read
        Desired named matrix (kind = 3523) not available
        Read MEG forward solution (7498 sources, 306 channels, free orientations)
        Desired named matrix (kind = 3523) not available
        Read EEG forward solution (7498 sources, 60 channels, free orientations)
        MEG and EEG forward solutions combined
        Source spaces transformed to the forward solution coordinate frame
        Converting to surface-based source orientations...
        Average patch normals will be employed in the rotation to the local surface coordinates....
    [done]


Time-frequency beamforming based on DICS


.. code-block:: python


    # Setting frequency bins as in Dalal et al. 2008
    freq_bins = [(4, 12), (12, 30), (30, 55), (65, 300)]  # Hz
    win_lengths = [0.3, 0.2, 0.15, 0.1]  # s
    # Then set FFTs length for each frequency range.
    # Should be a power of 2 to be faster.
    n_ffts = [256, 128, 128, 128]

    # Subtract evoked response prior to computation?
    subtract_evoked = False

    # Calculating noise cross-spectral density from empty room noise for each
    # frequency bin and the corresponding time window length. To calculate noise
    # from the baseline period in the data, change epochs_noise to epochs
    noise_csds = []
    for freq_bin, win_length, n_fft in zip(freq_bins, win_lengths, n_ffts):
        noise_csd = compute_epochs_csd(epochs_noise, mode='fourier',
                                       fmin=freq_bin[0], fmax=freq_bin[1],
                                       fsum=True, tmin=-win_length, tmax=0,
                                       n_fft=n_fft)
        noise_csds.append(noise_csd)

    # Computing DICS solutions for time-frequency windows in a label in source
    # space for faster computation, use label=None for full solution
    stcs = tf_dics(epochs, forward, noise_csds, tmin, tmax, tstep, win_lengths,
                   freq_bins=freq_bins, subtract_evoked=subtract_evoked,
                   n_ffts=n_ffts, reg=0.001, label=label)

    # Plotting source spectrogram for source with maximum activity
    # Note that tmin and tmax are set to display a time range that is smaller than
    # the one for which beamforming estimates were calculated. This ensures that
    # all time bins shown are a result of smoothing across an identical number of
    # time windows.
    plot_source_spectrogram(stcs, freq_bins, tmin=tmin_plot, tmax=tmax_plot,
                            source_index=None, colorbar=True)



.. image:: /auto_examples/inverse/images/sphx_glr_plot_tf_dics_001.png
    :align: center


**Script output**:

.. rst-class:: sphx-glr-script-out

  ::

    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
    Computing time-frequency DICS beamformer for time window -550 to -250 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -500 to -200 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -450 to -150 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -400 to -100 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -350 to -50 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -300 to 0 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -250 to 49 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -200 to 99 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -150 to 149 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -100 to 199 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -50 to 249 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 0 to 300 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 50 to 350 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 99 to 399 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 150 to 450 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 199 to 499 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 250 to 550 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 300 to 600 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 350 to 649 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 400 to 700 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 449 to 750 ms, in frequency range 4 to 12 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -550 to -350 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -500 to -300 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -450 to -250 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -400 to -200 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -350 to -150 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -300 to -100 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -250 to -49 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -200 to 0 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -150 to 49 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -100 to 99 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -50 to 149 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 0 to 200 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 50 to 250 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 99 to 300 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 150 to 350 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 199 to 399 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 250 to 450 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 300 to 500 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 350 to 550 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 400 to 600 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 449 to 649 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 500 to 700 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 550 to 750 ms, in frequency range 12 to 30 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -550 to -400 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -500 to -350 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -450 to -300 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -400 to -250 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -350 to -200 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -300 to -150 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -250 to -100 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -200 to -50 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -150 to 0 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -100 to 49 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -50 to 99 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 0 to 150 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 50 to 200 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 99 to 249 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 150 to 300 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 199 to 350 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 250 to 400 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 300 to 450 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 350 to 500 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 400 to 550 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 449 to 600 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 500 to 650 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 550 to 700 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 600 to 750 ms, in frequency range 30 to 55 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -550 to -450 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -500 to -400 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -450 to -350 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -400 to -300 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -350 to -250 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -300 to -200 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -250 to -150 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -200 to -100 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -150 to -50 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -100 to 0 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window -50 to 49 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 0 to 100 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 50 to 150 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 99 to 199 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 150 to 250 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 199 to 299 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 250 to 350 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 300 to 400 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 350 to 449 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 400 to 500 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 449 to 549 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 500 to 600 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 550 to 650 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 600 to 700 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 650 to 750 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]
    Computing time-frequency DICS beamformer for time window 650 to 750 ms, in frequency range 65 to 300 Hz
    Computing cross-spectral density from epochs...
        using FFT with a Hanning window to estimate spectra
    [done]
        13 out of 366 channels remain after picking
    Computing DICS source power...
    [done]


**Total running time of the script:**
(0 minutes 16.256 seconds)



**Download Python source code:** :download:`plot_tf_dics.py <plot_tf_dics.py>`
