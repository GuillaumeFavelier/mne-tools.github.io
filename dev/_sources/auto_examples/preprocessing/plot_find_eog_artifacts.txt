

.. _sphx_glr_auto_examples_preprocessing_plot_find_eog_artifacts.py:


==================
Find EOG artifacts
==================

Locate peaks of EOG to spot blinks and general EOG artifacts.



.. code-block:: python

    # Authors: Alexandre Gramfort <alexandre.gramfort@telecom-paristech.fr>
    #
    # License: BSD (3-clause)


    import numpy as np
    import matplotlib.pyplot as plt

    import mne
    from mne import io
    from mne.datasets import sample

    print(__doc__)

    data_path = sample.data_path()




.. rst-class:: sphx-glr-horizontal





Set parameters


.. code-block:: python

    raw_fname = data_path + '/MEG/sample/sample_audvis_filt-0-40_raw.fif'

    # Setup for reading the raw data
    raw = io.Raw(raw_fname)

    event_id = 998
    eog_events = mne.preprocessing.find_eog_events(raw, event_id)

    # Read epochs
    picks = mne.pick_types(raw.info, meg=False, eeg=False, stim=False, eog=True,
                           exclude='bads')
    tmin, tmax = -0.2, 0.2
    epochs = mne.Epochs(raw, eog_events, event_id, tmin, tmax, picks=picks)
    data = epochs.get_data()

    print("Number of detected EOG artifacts : %d" % len(data))




.. rst-class:: sphx-glr-horizontal



**Script output**:

.. rst-class:: sphx-glr-script-out

  ::

    Opening raw data file /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/sample_audvis_filt-0-40_raw.fif...
        Read a total of 4 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
            Average EEG reference (1 x 60)  idle
    Current compensation grade : 0
        Range : 6450 ... 48149 =     42.956 ...   320.665 secs
    Ready.
    EOG channel index for this subject is: [375]
    Reading 0 ... 41699  =      0.000 ...   277.709 secs...
    [done]
    Filtering the data to remove DC offset to help distinguish blinks from saccades
    Now detecting blinks and generating corresponding events
    Number of EOG events detected : 46
    46 matching events found
    4 projection items activated
    Reading 45 ... 105  =      0.300 ...     0.699 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 317 ... 377  =      2.111 ...     2.511 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 521 ... 581  =      3.470 ...     3.869 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 2141 ... 2201  =     14.259 ...    14.658 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 4551 ... 4611  =     30.309 ...    30.709 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 4868 ... 4928  =     32.420 ...    32.820 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 6558 ... 6618  =     43.675 ...    44.075 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 8545 ... 8605  =     56.908 ...    57.308 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 8657 ... 8717  =     57.654 ...    58.054 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 8850 ... 8910  =     58.940 ...    59.339 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 8991 ... 9051  =     59.879 ...    60.278 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 9290 ... 9350  =     61.870 ...    62.270 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 10661 ... 10721  =     71.001 ...    71.400 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 15077 ... 15137  =    100.410 ...   100.810 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 15255 ... 15315  =    101.596 ...   101.995 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 15331 ... 15391  =    102.102 ...   102.502 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 16987 ... 17047  =    113.131 ...   113.530 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 18271 ... 18331  =    121.682 ...   122.082 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 18606 ... 18666  =    123.913 ...   124.313 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 19192 ... 19252  =    127.816 ...   128.215 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 19566 ... 19626  =    130.306 ...   130.706 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 20020 ... 20080  =    133.330 ...   133.730 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 20149 ... 20209  =    134.189 ...   134.589 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 20634 ... 20694  =    137.419 ...   137.819 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 20987 ... 21047  =    139.770 ...   140.170 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 21244 ... 21304  =    141.482 ...   141.881 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 21377 ... 21437  =    142.367 ...   142.767 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 21663 ... 21723  =    144.272 ...   144.672 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 22094 ... 22154  =    147.143 ...   147.542 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 23161 ... 23221  =    154.249 ...   154.648 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 25422 ... 25482  =    169.306 ...   169.706 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 26208 ... 26268  =    174.541 ...   174.941 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 26323 ... 26383  =    175.307 ...   175.707 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 27913 ... 27973  =    185.896 ...   186.296 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 28166 ... 28226  =    187.581 ...   187.981 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 28303 ... 28363  =    188.493 ...   188.893 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 28658 ... 28718  =    190.858 ...   191.257 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 28859 ... 28919  =    192.196 ...   192.596 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 31792 ... 31852  =    211.730 ...   212.129 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32757 ... 32817  =    218.156 ...   218.556 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32838 ... 32898  =    218.696 ...   219.095 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32980 ... 33040  =    219.642 ...   220.041 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 40182 ... 40242  =    267.606 ...   268.005 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 40262 ... 40322  =    268.138 ...   268.538 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 40377 ... 40437  =    268.904 ...   269.304 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 40608 ... 40668  =    270.443 ...   270.842 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    0 bad epochs dropped
    Number of detected EOG artifacts : 46


Plot EOG artifacts


.. code-block:: python

    plt.plot(1e3 * epochs.times, np.squeeze(data).T)
    plt.xlabel('Times (ms)')
    plt.ylabel('EOG (muV)')
    plt.show()



.. image:: /auto_examples/preprocessing/images/sphx_glr_plot_find_eog_artifacts_001.png
    :align: center




**Total running time of the script:**
(0 minutes 0.339 seconds)



**Download Python source code:** :download:`plot_find_eog_artifacts.py <plot_find_eog_artifacts.py>`
