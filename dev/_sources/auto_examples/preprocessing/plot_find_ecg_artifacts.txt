

.. _sphx_glr_auto_examples_preprocessing_plot_find_ecg_artifacts.py:


==================
Find ECG artifacts
==================

Locate QRS component of ECG.



.. code-block:: python

    # Authors: Alexandre Gramfort <alexandre.gramfort@telecom-paristech.fr>
    #
    # License: BSD (3-clause)


    import numpy as np
    import matplotlib.pyplot as plt

    import mne
    from mne import io
    from mne.datasets import sample

    print(__doc__)

    data_path = sample.data_path()




.. rst-class:: sphx-glr-horizontal





Set parameters


.. code-block:: python

    raw_fname = data_path + '/MEG/sample/sample_audvis_raw.fif'

    # Setup for reading the raw data
    raw = io.Raw(raw_fname)

    event_id = 999
    ecg_events, _, _ = mne.preprocessing.find_ecg_events(raw, event_id,
                                                         ch_name='MEG 1531')

    # Read epochs
    picks = mne.pick_types(raw.info, meg=False, eeg=False, stim=False, eog=False,
                           include=['MEG 1531'], exclude='bads')
    tmin, tmax = -0.1, 0.1
    epochs = mne.Epochs(raw, ecg_events, event_id, tmin, tmax, picks=picks,
                        proj=False)
    data = epochs.get_data()

    print("Number of detected ECG artifacts : %d" % len(data))




.. rst-class:: sphx-glr-horizontal



**Script output**:

.. rst-class:: sphx-glr-script-out

  ::

    Opening raw data file /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/sample_audvis_raw.fif...
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
    Current compensation grade : 0
        Range : 25800 ... 192599 =     42.956 ...   320.670 secs
    Ready.
    Adding average EEG reference projection.
    1 projection items deactivated
    Using channel MEG 1531 to identify heart beats.
    Reading 0 ... 166799  =      0.000 ...   277.714 secs...
    [done]
    Number of ECG events detected : 284 (average pulse 61 / min.)
    284 matching events found
    Created an SSP operator (subspace dimension = 1)
    Reading 420 ... 540  =      0.699 ...     0.899 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 1071 ... 1191  =      1.783 ...     1.983 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 1692 ... 1812  =      2.817 ...     3.017 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 2287 ... 2407  =      3.808 ...     4.008 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 2869 ... 2989  =      4.777 ...     4.977 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 3447 ... 3567  =      5.739 ...     5.939 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 4060 ... 4180  =      6.760 ...     6.960 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 4699 ... 4819  =      7.824 ...     8.023 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 5334 ... 5454  =      8.881 ...     9.081 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 5892 ... 6012  =      9.810 ...    10.010 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 6415 ... 6535  =     10.681 ...    10.881 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 7001 ... 7121  =     11.656 ...    11.856 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 7629 ... 7749  =     12.702 ...    12.902 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 8265 ... 8385  =     13.761 ...    13.961 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 8870 ... 8990  =     14.768 ...    14.968 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 9431 ... 9551  =     15.702 ...    15.902 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 10007 ... 10127  =     16.661 ...    16.861 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 10607 ... 10727  =     17.660 ...    17.860 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 11230 ... 11350  =     18.698 ...    18.897 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 11856 ... 11976  =     19.740 ...    19.940 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 12412 ... 12532  =     20.665 ...    20.865 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 12990 ... 13110  =     21.628 ...    21.828 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 13641 ... 13761  =     22.712 ...    22.912 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 14292 ... 14412  =     23.796 ...    23.995 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 14884 ... 15004  =     24.781 ...    24.981 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 15437 ... 15557  =     25.702 ...    25.902 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 16040 ... 16160  =     26.706 ...    26.906 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 16685 ... 16805  =     27.780 ...    27.980 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 17350 ... 17470  =     28.887 ...    29.087 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 17992 ... 18112  =     29.956 ...    30.156 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 18614 ... 18734  =     30.992 ...    31.191 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 19157 ... 19277  =     31.896 ...    32.095 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 19661 ... 19781  =     32.735 ...    32.935 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 20261 ... 20381  =     33.734 ...    33.934 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 20923 ... 21043  =     34.836 ...    35.036 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 21576 ... 21696  =     35.923 ...    36.123 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 22151 ... 22271  =     36.881 ...    37.080 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 22735 ... 22855  =     37.853 ...    38.053 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 23353 ... 23473  =     38.882 ...    39.082 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 24013 ... 24133  =     39.981 ...    40.180 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 24656 ... 24776  =     41.051 ...    41.251 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 25235 ... 25355  =     42.015 ...    42.215 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 25800 ... 25920  =     42.956 ...    43.156 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 26429 ... 26549  =     44.003 ...    44.203 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 27048 ... 27168  =     45.034 ...    45.234 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 27667 ... 27787  =     46.064 ...    46.264 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 28288 ... 28408  =     47.098 ...    47.298 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 28857 ... 28977  =     48.046 ...    48.246 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 29398 ... 29518  =     48.946 ...    49.146 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 29999 ... 30119  =     49.947 ...    50.147 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 30670 ... 30790  =     51.064 ...    51.264 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 31342 ... 31462  =     52.183 ...    52.383 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32001 ... 32121  =     53.280 ...    53.480 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 32621 ... 32741  =     54.313 ...    54.512 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 33180 ... 33300  =     55.243 ...    55.443 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 33709 ... 33829  =     56.124 ...    56.324 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 34314 ... 34434  =     57.131 ...    57.331 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 34909 ... 35029  =     58.122 ...    58.322 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 35513 ... 35633  =     59.128 ...    59.328 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 36116 ... 36236  =     60.132 ...    60.331 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 36674 ... 36794  =     61.061 ...    61.261 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 37185 ... 37305  =     61.912 ...    62.111 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 37737 ... 37857  =     62.831 ...    63.030 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 38357 ... 38477  =     63.863 ...    64.063 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 39016 ... 39136  =     64.960 ...    65.160 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 39667 ... 39787  =     66.044 ...    66.244 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 40229 ... 40349  =     66.980 ...    67.179 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 40768 ... 40888  =     67.877 ...    68.077 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 41341 ... 41461  =     68.831 ...    69.031 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 41933 ... 42053  =     69.817 ...    70.017 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 42543 ... 42663  =     70.832 ...    71.032 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 43118 ... 43238  =     71.790 ...    71.990 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 43655 ... 43775  =     72.684 ...    72.884 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 44142 ... 44262  =     73.495 ...    73.694 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 44657 ... 44777  =     74.352 ...    74.552 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 45243 ... 45363  =     75.328 ...    75.528 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 45879 ... 45999  =     76.387 ...    76.587 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 46552 ... 46672  =     77.507 ...    77.707 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 47774 ... 47894  =     79.542 ...    79.742 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 48339 ... 48459  =     80.483 ...    80.682 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 48951 ... 49071  =     81.501 ...    81.701 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 49604 ... 49724  =     82.589 ...    82.788 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 50264 ... 50384  =     83.688 ...    83.887 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 50899 ... 51019  =     84.745 ...    84.945 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 51477 ... 51597  =     85.707 ...    85.907 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 52013 ... 52133  =     86.600 ...    86.799 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 52591 ... 52711  =     87.562 ...    87.762 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 53246 ... 53366  =     88.652 ...    88.852 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 53916 ... 54036  =     89.768 ...    89.968 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 54543 ... 54663  =     90.812 ...    91.012 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 55084 ... 55204  =     91.713 ...    91.912 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 55603 ... 55723  =     92.577 ...    92.777 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 56198 ... 56318  =     93.567 ...    93.767 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 56848 ... 56968  =     94.650 ...    94.849 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 57499 ... 57619  =     95.734 ...    95.933 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 58137 ... 58257  =     96.796 ...    96.996 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 58698 ... 58818  =     97.730 ...    97.930 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 59213 ... 59333  =     98.587 ...    98.787 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 59790 ... 59910  =     99.548 ...    99.748 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 60393 ... 60513  =    100.552 ...   100.752 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 61040 ... 61160  =    101.629 ...   101.829 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 61691 ... 61811  =    102.713 ...   102.913 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 62280 ... 62400  =    103.694 ...   103.894 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 62797 ... 62917  =    104.555 ...   104.754 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 63287 ... 63407  =    105.370 ...   105.570 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 63814 ... 63934  =    106.248 ...   106.448 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 64438 ... 64558  =    107.287 ...   107.486 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 65217 ... 65337  =    108.584 ...   108.783 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 65935 ... 66055  =    109.779 ...   109.979 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 66645 ... 66765  =    110.961 ...   111.161 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 67337 ... 67457  =    112.113 ...   112.313 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 67987 ... 68107  =    113.196 ...   113.395 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 68606 ... 68726  =    114.226 ...   114.426 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 69162 ... 69282  =    115.152 ...   115.352 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 69660 ... 69780  =    115.981 ...   116.181 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 70181 ... 70301  =    116.849 ...   117.048 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 70764 ... 70884  =    117.819 ...   118.019 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 71405 ... 71525  =    118.886 ...   119.086 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 72044 ... 72164  =    119.950 ...   120.150 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 72661 ... 72781  =    120.978 ...   121.177 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 73275 ... 73395  =    122.000 ...   122.200 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 73833 ... 73953  =    122.929 ...   123.129 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 74326 ... 74446  =    123.750 ...   123.950 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 74769 ... 74889  =    124.487 ...   124.687 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 75187 ... 75307  =    125.183 ...   125.383 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 75637 ... 75757  =    125.933 ...   126.132 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 76276 ... 76396  =    126.996 ...   127.196 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 76949 ... 77069  =    128.117 ...   128.317 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 77630 ... 77750  =    129.251 ...   129.451 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 78292 ... 78412  =    130.353 ...   130.553 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 78951 ... 79071  =    131.450 ...   131.650 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 79535 ... 79655  =    132.423 ...   132.622 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 80068 ... 80188  =    133.310 ...   133.510 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 80611 ... 80731  =    134.214 ...   134.414 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 81164 ... 81284  =    135.135 ...   135.335 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 81727 ... 81847  =    136.072 ...   136.272 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 82305 ... 82425  =    137.035 ...   137.234 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 82874 ... 82994  =    137.982 ...   138.182 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 83379 ... 83499  =    138.823 ...   139.023 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 83896 ... 84016  =    139.683 ...   139.883 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 84443 ... 84563  =    140.594 ...   140.794 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 85023 ... 85143  =    141.560 ...   141.760 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 85593 ... 85713  =    142.509 ...   142.709 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 86157 ... 86277  =    143.448 ...   143.648 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 86665 ... 86785  =    144.294 ...   144.494 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 87129 ... 87249  =    145.066 ...   145.266 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 87592 ... 87712  =    145.837 ...   146.037 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 88097 ... 88217  =    146.678 ...   146.878 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 88675 ... 88795  =    147.640 ...   147.840 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 89271 ... 89391  =    148.633 ...   148.832 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 89860 ... 89980  =    149.613 ...   149.813 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 90376 ... 90496  =    150.472 ...   150.672 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 90862 ... 90982  =    151.282 ...   151.481 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 91365 ... 91485  =    152.119 ...   152.319 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 91894 ... 92014  =    153.000 ...   153.200 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 92453 ... 92573  =    153.931 ...   154.130 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 93016 ... 93136  =    154.868 ...   155.068 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 93512 ... 93632  =    155.694 ...   155.894 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 93972 ... 94092  =    156.460 ...   156.659 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 94440 ... 94560  =    157.239 ...   157.439 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 94944 ... 95064  =    158.078 ...   158.278 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 95512 ... 95632  =    159.024 ...   159.223 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 96080 ... 96200  =    159.969 ...   160.169 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 96615 ... 96735  =    160.860 ...   161.060 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 97086 ... 97206  =    161.644 ...   161.844 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 97566 ... 97686  =    162.443 ...   162.643 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 98068 ... 98188  =    163.279 ...   163.479 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 98608 ... 98728  =    164.178 ...   164.378 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 99196 ... 99316  =    165.157 ...   165.357 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 99715 ... 99835  =    166.021 ...   166.221 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 100191 ... 100311  =    166.814 ...   167.014 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 100686 ... 100806  =    167.638 ...   167.838 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 101224 ... 101344  =    168.534 ...   168.734 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 101765 ... 101885  =    169.435 ...   169.634 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 102308 ... 102428  =    170.339 ...   170.539 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 102808 ... 102928  =    171.171 ...   171.371 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 103282 ... 103402  =    171.960 ...   172.160 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 103777 ... 103897  =    172.785 ...   172.984 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 104292 ... 104412  =    173.642 ...   173.842 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 104824 ... 104944  =    174.528 ...   174.728 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 105371 ... 105491  =    175.439 ...   175.638 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 105878 ... 105998  =    176.283 ...   176.482 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 106347 ... 106467  =    177.064 ...   177.263 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 106823 ... 106943  =    177.856 ...   178.056 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 107321 ... 107441  =    178.685 ...   178.885 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 107888 ... 108008  =    179.629 ...   179.829 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 108456 ... 108576  =    180.575 ...   180.775 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 109043 ... 109163  =    181.552 ...   181.752 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 109592 ... 109712  =    182.466 ...   182.666 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 110086 ... 110206  =    183.289 ...   183.489 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 110614 ... 110734  =    184.168 ...   184.368 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 111253 ... 111373  =    185.232 ...   185.432 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 111922 ... 112042  =    186.346 ...   186.545 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 112546 ... 112666  =    187.385 ...   187.584 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 113129 ... 113249  =    188.355 ...   188.555 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 113706 ... 113826  =    189.316 ...   189.516 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 114332 ... 114452  =    190.358 ...   190.558 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 115003 ... 115123  =    191.475 ...   191.675 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 115651 ... 115771  =    192.554 ...   192.754 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 116224 ... 116344  =    193.508 ...   193.708 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 116813 ... 116933  =    194.489 ...   194.689 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 117445 ... 117565  =    195.541 ...   195.741 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 118076 ... 118196  =    196.592 ...   196.792 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 118709 ... 118829  =    197.646 ...   197.846 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 119300 ... 119420  =    198.630 ...   198.830 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 119867 ... 119987  =    199.574 ...   199.774 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 120481 ... 120601  =    200.596 ...   200.796 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 121129 ... 121249  =    201.675 ...   201.875 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 121745 ... 121865  =    202.701 ...   202.900 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 122317 ... 122437  =    203.653 ...   203.853 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 122859 ... 122979  =    204.555 ...   204.755 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 123385 ... 123505  =    205.431 ...   205.631 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 123953 ... 124073  =    206.377 ...   206.577 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 124544 ... 124664  =    207.361 ...   207.561 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 125133 ... 125253  =    208.341 ...   208.541 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 125667 ... 125787  =    209.231 ...   209.430 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 126206 ... 126326  =    210.128 ...   210.328 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 126824 ... 126944  =    211.157 ...   211.357 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 127432 ... 127552  =    212.169 ...   212.369 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 128039 ... 128159  =    213.180 ...   213.380 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 128602 ... 128722  =    214.117 ...   214.317 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 129112 ... 129232  =    214.966 ...   215.166 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 129638 ... 129758  =    215.842 ...   216.042 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 130191 ... 130311  =    216.763 ...   216.963 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 130763 ... 130883  =    217.715 ...   217.915 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 131366 ... 131486  =    218.719 ...   218.919 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 131942 ... 132062  =    219.678 ...   219.878 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 132464 ... 132584  =    220.547 ...   220.747 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 133003 ... 133123  =    221.445 ...   221.644 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 134270 ... 134390  =    223.554 ...   223.754 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 134826 ... 134946  =    224.480 ...   224.680 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 135418 ... 135538  =    225.466 ...   225.665 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 136049 ... 136169  =    226.516 ...   226.716 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 136687 ... 136807  =    227.578 ...   227.778 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 137303 ... 137423  =    228.604 ...   228.804 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 137870 ... 137990  =    229.548 ...   229.748 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 138420 ... 138540  =    230.464 ...   230.664 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 139001 ... 139121  =    231.431 ...   231.631 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 139602 ... 139722  =    232.432 ...   232.632 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 140186 ... 140306  =    233.404 ...   233.604 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 140769 ... 140889  =    234.375 ...   234.575 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 141301 ... 141421  =    235.261 ...   235.460 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 141855 ... 141975  =    236.183 ...   236.383 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 142482 ... 142602  =    237.227 ...   237.427 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 143117 ... 143237  =    238.284 ...   238.484 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 143746 ... 143866  =    239.331 ...   239.531 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 144343 ... 144463  =    240.325 ...   240.525 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 144934 ... 145054  =    241.309 ...   241.509 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 145453 ... 145573  =    242.173 ...   242.373 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 145964 ... 146084  =    243.024 ...   243.224 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 146518 ... 146638  =    243.947 ...   244.146 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 147146 ... 147266  =    244.992 ...   245.192 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 147807 ... 147927  =    246.093 ...   246.293 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 148462 ... 148582  =    247.183 ...   247.383 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 149099 ... 149219  =    248.244 ...   248.444 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 149648 ... 149768  =    249.158 ...   249.358 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 150188 ... 150308  =    250.057 ...   250.257 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 150762 ... 150882  =    251.013 ...   251.213 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 151372 ... 151492  =    252.028 ...   252.228 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 151974 ... 152094  =    253.031 ...   253.230 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 152542 ... 152662  =    253.976 ...   254.176 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 153051 ... 153171  =    254.824 ...   255.024 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 153583 ... 153703  =    255.710 ...   255.909 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 154174 ... 154294  =    256.694 ...   256.893 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 154775 ... 154895  =    257.694 ...   257.894 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 155363 ... 155483  =    258.673 ...   258.873 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 155918 ... 156038  =    259.597 ...   259.797 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 156422 ... 156542  =    260.436 ...   260.636 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 156958 ... 157078  =    261.329 ...   261.529 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 157568 ... 157688  =    262.344 ...   262.544 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 158199 ... 158319  =    263.395 ...   263.595 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 158807 ... 158927  =    264.407 ...   264.607 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 159931 ... 160051  =    266.279 ...   266.479 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 160411 ... 160531  =    267.078 ...   267.278 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 160921 ... 161041  =    267.927 ...   268.127 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 161513 ... 161633  =    268.913 ...   269.112 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 162143 ... 162263  =    269.962 ...   270.161 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 162779 ... 162899  =    271.021 ...   271.220 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 163354 ... 163474  =    271.978 ...   272.178 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 163872 ... 163992  =    272.840 ...   273.040 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 164423 ... 164543  =    273.758 ...   273.958 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 165037 ... 165157  =    274.780 ...   274.980 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 165642 ... 165762  =    275.787 ...   275.987 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    Reading 166253 ... 166373  =    276.805 ...   277.004 secs...
    [done]
    Applying baseline correction ... (mode: mean)
    0 bad epochs dropped
    Number of detected ECG artifacts : 284


Plot ECG artifacts


.. code-block:: python

    plt.plot(1e3 * epochs.times, np.squeeze(data).T)
    plt.xlabel('Times (ms)')
    plt.ylabel('ECG')
    plt.show()



.. image:: /auto_examples/preprocessing/images/sphx_glr_plot_find_ecg_artifacts_001.png
    :align: center




**Total running time of the script:**
(0 minutes 1.630 seconds)



**Download Python source code:** :download:`plot_find_ecg_artifacts.py <plot_find_ecg_artifacts.py>`
