<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Compute Phase Slope Index (PSI) in source space for a visual stimulus &mdash; MNE 0.11.dev0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.11.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="MNE 0.11.dev0 documentation" href="../../index.html" />
    <link rel="up" title="Examples Gallery" href="../index.html" />
    <link rel="next" title="Compute all-to-all connectivity in sensor space" href="plot_sensor_connectivity.html" />
    <link rel="prev" title="Compute source space connectivity and visualize it using a circular graph" href="plot_mne_inverse_label_connectivity.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body role="document">

<div class="devbar">
This documentation is for the development version (0.11.dev0) - <a href="http://martinos.org/mne/stable">Stable version</a>
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/mne_logo_small.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.11.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../tutorials.html">Tutorials</a></li>
                <li><a href="../index.html">Gallery</a></li>
                <li><a href="../../manual/index.html">Manual</a></li>
                <li><a href="../../python_reference.html">API</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
                <li><a href="../../cite.html">Cite</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new.html">What&#8217;s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Cite MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">Related publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manual/index.html">Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_setup.html">Advanced installation and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mne_cpp.html">MNE with CPP</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Compute Phase Slope Index (PSI) in source space for a visual stimulus</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Compute Phase Slope Index (PSI) in source space for a visual stimulus</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

  <li>
    <a href="plot_mne_inverse_label_connectivity.html" title="Previous Chapter: Compute source space connectivity and visualize it using a circular graph"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Compute sourc...</span>
    </a>
  </li>
  <li>
    <a href="plot_sensor_connectivity.html" title="Next Chapter: Compute all-to-all connectivity in sensor space"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Compute all-t... &raquo;</span>
    </a>
  </li>
<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12">
      
  <div class="section" id="compute-phase-slope-index-psi-in-source-space-for-a-visual-stimulus">
<span id="sphx-glr-auto-examples-connectivity-plot-mne-inverse-psi-visual-py"></span><h1>Compute Phase Slope Index (PSI) in source space for a visual stimulus<a class="headerlink" href="#compute-phase-slope-index-psi-in-source-space-for-a-visual-stimulus" title="Permalink to this headline">¶</a></h1>
<p>This example demonstrates how the Phase Slope Index (PSI) [1] can be computed
in source space based on single trial dSPM source estimates. In addition,
the example shows advanced usage of the connectivity estimation routines
by first extracting a label time course for each epoch and then combining
the label time course with the single trial source estimates to compute the
connectivity.</p>
<p>The result clearly shows how the activity in the visual label precedes more
widespread activity (a postivive PSI means the label time course is leading).</p>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>[1] Nolte et al. &#8220;Robustly Estimating the Flow Direction of Information in
Complex Physical Systems&#8221;, Physical Review Letters, vol. 100, no. 23,
pp. 1-4, Jun. 2008.</p>
<img alt="../../_images/sphx_glr_plot_mne_inverse_psi_visual_000.png" class="align-center" src="../../_images/sphx_glr_plot_mne_inverse_psi_visual_000.png" />
<p><strong>Script output</strong>:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre>Reading inverse operator decomposition from /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/sample_audvis-meg-oct-6-meg-inv.fif...
    Reading inverse operator info...
    [done]
    Reading inverse operator decomposition...
    [done]
    305 x 305 full covariance (kind = 1) found.
    Read a total of 4 projection items:
        PCA-v1 (1 x 102) active
        PCA-v2 (1 x 102) active
        PCA-v3 (1 x 102) active
        Average EEG reference (1 x 60) active
    Noise covariance matrix read.
    22494 x 22494 diagonal covariance (kind = 2) found.
    Source covariance matrix read.
    22494 x 22494 diagonal covariance (kind = 6) found.
    Orientation priors read.
    22494 x 22494 diagonal covariance (kind = 5) found.
    Depth priors read.
    Did not find the desired covariance matrix (kind = 3)
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    2 source spaces read
    Read a total of 4 projection items:
        PCA-v1 (1 x 102) active
        PCA-v2 (1 x 102) active
        PCA-v3 (1 x 102) active
        Average EEG reference (1 x 60) active
    Source spaces transformed to the inverse solution coordinate frame
Opening raw data file /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/sample_audvis_filt-0-40_raw.fif...
    Read a total of 4 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
        Average EEG reference (1 x 60)  idle
Current compensation grade : 0
    Range : 6450 ... 48149 =     42.956 ...   320.665 secs
Ready.
70 matching events found
Created an SSP operator (subspace dimension = 3)
4 projection items activated
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    Created an SSP operator (subspace dimension = 3)
    Created the whitener using a full noise covariance matrix (3 small eigenvalues omitted)
    Computing noise-normalization factors (dSPM)...
[done]
Picked 305 channels from the data
Computing inverse...
(eigenleads need to be weighted)...
Reading 824 ... 899  =      5.488 ...     5.987 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 1
Reading 1229 ... 1304  =      8.185 ...     8.684 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 2
Reading 1649 ... 1724  =     10.982 ...    11.482 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 3
Reading 2482 ... 2557  =     16.530 ...    17.029 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 4
Reading 2885 ... 2960  =     19.214 ...    19.713 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 5
Reading 3302 ... 3377  =     21.991 ...    22.490 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 6
Reading 3740 ... 3815  =     24.908 ...    25.407 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 7
Reading 4562 ... 4637  =     30.382 ...    30.882 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 4985 ... 5060  =     33.199 ...    33.699 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 8
Reading 5402 ... 5477  =     35.976 ...    36.476 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 9
Reading 5795 ... 5870  =     38.594 ...    39.093 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 10
Reading 6190 ... 6265  =     41.224 ...    41.724 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 11
Reading 6583 ... 6658  =     43.842 ...    44.341 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 6998 ... 7073  =     46.606 ...    47.105 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 12
Reading 7385 ... 7460  =     49.183 ...    49.682 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 13
Reading 7815 ... 7890  =     52.047 ...    52.546 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 14
Reading 8248 ... 8323  =     54.930 ...    55.430 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 15
Reading 8660 ... 8735  =     57.674 ...    58.174 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 9090 ... 9165  =     60.538 ...    61.037 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 16
Reading 9500 ... 9575  =     63.268 ...    63.768 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 17
Reading 9930 ... 10005  =     66.132 ...    66.632 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 18
Reading 10785 ... 10860  =     71.826 ...    72.326 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 19
Reading 11185 ... 11260  =     74.490 ...    74.990 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 20
Reading 11630 ... 11705  =     77.454 ...    77.953 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 21
Reading 12063 ... 12138  =     80.338 ...    80.837 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 22
Reading 12451 ... 12526  =     82.922 ...    83.421 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 23
Reading 12846 ... 12921  =     85.552 ...    86.052 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 24
Reading 13253 ... 13328  =     88.263 ...    88.762 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 25
Reading 13676 ... 13751  =     91.080 ...    91.579 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 26
Reading 14103 ... 14178  =     93.924 ...    94.423 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 27
Reading 14516 ... 14591  =     96.674 ...    97.174 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 28
Reading 14936 ... 15011  =     99.471 ...    99.971 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 29
Reading 15358 ... 15433  =    102.282 ...   102.781 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 15776 ... 15851  =    105.066 ...   105.565 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 30
Reading 16223 ... 16298  =    108.043 ...   108.542 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 31
Reading 16623 ... 16698  =    110.707 ...   111.206 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 32
Reading 17043 ... 17118  =    113.504 ...   114.003 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 33
Reading 17490 ... 17565  =    116.481 ...   116.980 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 34
Reading 17945 ... 18020  =    119.511 ...   120.010 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 35
Reading 18360 ... 18435  =    122.275 ...   122.774 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 36
Reading 19198 ... 19273  =    127.856 ...   128.355 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 19628 ... 19703  =    130.719 ...   131.219 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 37
Reading 20063 ... 20138  =    133.616 ...   134.116 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 38
Reading 20455 ... 20530  =    136.227 ...   136.727 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 39
Reading 20861 ... 20936  =    138.931 ...   139.430 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 40
Reading 21271 ... 21346  =    141.661 ...   142.161 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 21705 ... 21780  =    144.552 ...   145.051 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 41
Reading 22101 ... 22176  =    147.189 ...   147.689 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 22540 ... 22615  =    150.113 ...   150.612 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 42
Reading 22948 ... 23023  =    152.830 ...   153.330 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 43
Reading 23328 ... 23403  =    155.361 ...   155.860 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 44
Reading 23766 ... 23841  =    158.278 ...   158.777 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 45
Reading 24191 ... 24266  =    161.108 ...   161.608 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 46
Reading 24621 ... 24696  =    163.972 ...   164.471 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 47
Reading 25446 ... 25521  =    169.466 ...   169.966 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 25841 ... 25916  =    172.097 ...   172.596 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 48
Reading 26239 ... 26314  =    174.748 ...   175.247 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 49
Reading 26659 ... 26734  =    177.545 ...   178.044 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 50
Reading 27099 ... 27174  =    180.475 ...   180.975 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 51
Reading 27499 ... 27574  =    183.139 ...   183.638 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 52
Reading 27914 ... 27989  =    185.903 ...   186.402 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 28346 ... 28421  =    188.780 ...   189.279 secs...
[done]
Applying baseline correction ... (mode: mean)
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
Reading 28791 ... 28866  =    191.743 ...   192.243 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 53
Reading 29656 ... 29731  =    197.504 ...   198.004 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 54
Reading 30041 ... 30116  =    200.068 ...   200.568 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 55
Reading 30483 ... 30558  =    203.012 ...   203.511 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 56
Reading 30908 ... 30983  =    205.842 ...   206.342 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 57
Reading 31336 ... 31411  =    208.693 ...   209.192 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 58
Reading 31726 ... 31801  =    211.290 ...   211.790 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 59
Reading 32141 ... 32216  =    214.054 ...   214.553 secs...
[done]
Applying baseline correction ... (mode: mean)
Processing epoch : 60
[done]
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Extracting time courses for 1 labels (mode: mean_flip)
Estimating phase slope index (PSI)
Connectivity computation...
    computing connectivity for 7498 connections
    using t=0.000s..0.300s for estimation (46 points)
    frequencies: 9.8Hz..29.4Hz (7 points)
    using multitaper spectrum estimation with 7 DPSS windows
    the following metrics will be computed: Coherency
    computing connectivity for epoch 1
    computing connectivity for epoch 2
    computing connectivity for epoch 3
    computing connectivity for epoch 4
    computing connectivity for epoch 5
    computing connectivity for epoch 6
    computing connectivity for epoch 7
    computing connectivity for epoch 8
    computing connectivity for epoch 9
    computing connectivity for epoch 10
    computing connectivity for epoch 11
    computing connectivity for epoch 12
    computing connectivity for epoch 13
    computing connectivity for epoch 14
    computing connectivity for epoch 15
    computing connectivity for epoch 16
    computing connectivity for epoch 17
    computing connectivity for epoch 18
    computing connectivity for epoch 19
    computing connectivity for epoch 20
    computing connectivity for epoch 21
    computing connectivity for epoch 22
    computing connectivity for epoch 23
    computing connectivity for epoch 24
    computing connectivity for epoch 25
    computing connectivity for epoch 26
    computing connectivity for epoch 27
    computing connectivity for epoch 28
    computing connectivity for epoch 29
    computing connectivity for epoch 30
    computing connectivity for epoch 31
    computing connectivity for epoch 32
    computing connectivity for epoch 33
    computing connectivity for epoch 34
    computing connectivity for epoch 35
    computing connectivity for epoch 36
    computing connectivity for epoch 37
    computing connectivity for epoch 38
    computing connectivity for epoch 39
    computing connectivity for epoch 40
    computing connectivity for epoch 41
    computing connectivity for epoch 42
    computing connectivity for epoch 43
    computing connectivity for epoch 44
    computing connectivity for epoch 45
    computing connectivity for epoch 46
    computing connectivity for epoch 47
    computing connectivity for epoch 48
    computing connectivity for epoch 49
    computing connectivity for epoch 50
    computing connectivity for epoch 51
    computing connectivity for epoch 52
    computing connectivity for epoch 53
    computing connectivity for epoch 54
    computing connectivity for epoch 55
    computing connectivity for epoch 56
    computing connectivity for epoch 57
    computing connectivity for epoch 58
    computing connectivity for epoch 59
    computing connectivity for epoch 60
[Connectivity computation done]
Computing PSI from estimated Coherency
[PSI Estimation Done]
Updating smoothing matrix, be patient..
Smoothing matrix creation, step 1
Smoothing matrix creation, step 2
Smoothing matrix creation, step 3
Smoothing matrix creation, step 4
Smoothing matrix creation, step 5
Smoothing matrix creation, step 6
Smoothing matrix creation, step 7
Smoothing matrix creation, step 8
Smoothing matrix creation, step 9
Smoothing matrix creation, step 10
colormap: fmin=-2.33e-01 fmid=0.00e+00 fmax=2.33e-01 transparent=0
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Author: Martin Luessi &lt;mluessi@nmr.mgh.harvard.edu&gt;</span>
<span class="c">#</span>
<span class="c"># License: BSD (3-clause)</span>


<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">mne.io</span> <span class="kn">import</span> <a href="../../generated/mne.io.Raw.html#mne.io.Raw"><span class="n">Raw</span></a>
<span class="kn">from</span> <span class="nn">mne.minimum_norm</span> <span class="kn">import</span> <a href="../../generated/mne.minimum_norm.read_inverse_operator.html#mne.minimum_norm.read_inverse_operator"><span class="n">read_inverse_operator</span></a><span class="p">,</span> <a href="../../generated/mne.minimum_norm.apply_inverse_epochs.html#mne.minimum_norm.apply_inverse_epochs"><span class="n">apply_inverse_epochs</span></a>
<span class="kn">from</span> <span class="nn">mne.connectivity</span> <span class="kn">import</span> <a href="../../generated/mne.connectivity.seed_target_indices.html#mne.connectivity.seed_target_indices"><span class="n">seed_target_indices</span></a><span class="p">,</span> <a href="../../generated/mne.connectivity.phase_slope_index.html#mne.connectivity.phase_slope_index"><span class="n">phase_slope_index</span></a>

<span class="k">print</span><span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>

<span class="n">data_path</span> <span class="o">=</span> <a href="../../generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path"><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<span class="n">subjects_dir</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/subjects&#39;</span>
<span class="n">fname_inv</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis-meg-oct-6-meg-inv.fif&#39;</span>
<span class="n">fname_raw</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis_filt-0-40_raw.fif&#39;</span>
<span class="n">fname_event</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis_filt-0-40_raw-eve.fif&#39;</span>
<span class="n">fname_label</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/labels/Vis-lh.label&#39;</span>

<span class="n">event_id</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span>
<span class="n">method</span> <span class="o">=</span> <span class="s">&quot;dSPM&quot;</span>  <span class="c"># use dSPM method (could also be MNE or sLORETA)</span>

<span class="c"># Load data</span>
<span class="n">inverse_operator</span> <span class="o">=</span> <a href="../../generated/mne.minimum_norm.read_inverse_operator.html#mne.minimum_norm.read_inverse_operator"><span class="n">read_inverse_operator</span></a><span class="p">(</span><span class="n">fname_inv</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <a href="../../generated/mne.io.Raw.html#mne.io.Raw"><span class="n">Raw</span></a><span class="p">(</span><span class="n">fname_raw</span><span class="p">)</span>
<span class="n">events</span> <span class="o">=</span> <a href="../../generated/mne.read_events.html#mne.read_events"><span class="n">mne</span><span class="o">.</span><span class="n">read_events</span></a><span class="p">(</span><span class="n">fname_event</span><span class="p">)</span>

<span class="c"># pick MEG channels</span>
<span class="n">picks</span> <span class="o">=</span> <a href="../../generated/mne.pick_types.html#mne.pick_types"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">exclude</span><span class="o">=</span><span class="s">&#39;bads&#39;</span><span class="p">)</span>

<span class="c"># Read epochs</span>
<span class="n">epochs</span> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">event_id</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span>
                    <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">reject</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">mag</span><span class="o">=</span><span class="mf">4e-12</span><span class="p">,</span> <span class="n">grad</span><span class="o">=</span><span class="mf">4000e-13</span><span class="p">,</span>
                                                    <span class="n">eog</span><span class="o">=</span><span class="mf">150e-6</span><span class="p">))</span>

<span class="c"># Compute inverse solution and for each epoch. Note that since we are passing</span>
<span class="c"># the output to both extract_label_time_course and the phase_slope_index</span>
<span class="c"># functions, we have to use &quot;return_generator=False&quot;, since it is only possible</span>
<span class="c"># to iterate over generators once.</span>
<span class="n">snr</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c"># use lower SNR for single epochs</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">snr</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">stcs</span> <span class="o">=</span> <a href="../../generated/mne.minimum_norm.apply_inverse_epochs.html#mne.minimum_norm.apply_inverse_epochs"><span class="n">apply_inverse_epochs</span></a><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">inverse_operator</span><span class="p">,</span> <span class="n">lambda2</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span>
                            <span class="n">pick_ori</span><span class="o">=</span><span class="s">&quot;normal&quot;</span><span class="p">,</span> <span class="n">return_generator</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># Now, we generate seed time series by averaging the activity in the left</span>
<span class="c"># visual corex</span>
<span class="n">label</span> <span class="o">=</span> <a href="../../generated/mne.read_label.html#mne.read_label"><span class="n">mne</span><span class="o">.</span><span class="n">read_label</span></a><span class="p">(</span><span class="n">fname_label</span><span class="p">)</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">inverse_operator</span><span class="p">[</span><span class="s">&#39;src&#39;</span><span class="p">]</span>  <span class="c"># the source space used</span>
<span class="n">seed_ts</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">extract_label_time_course</span><span class="p">(</span><span class="n">stcs</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;mean_flip&#39;</span><span class="p">)</span>

<span class="c"># Combine the seed time course with the source estimates. There will be a total</span>
<span class="c"># of 7500 signals:</span>
<span class="c"># index 0: time course extracted from label</span>
<span class="c"># index 1..7499: dSPM source space time courses</span>
<span class="n">comb_ts</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">seed_ts</span><span class="p">,</span> <span class="n">stcs</span><span class="p">)</span>

<span class="c"># Construct indices to estimate connectivity between the label time course</span>
<span class="c"># and all source space time courses</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">src</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&#39;vertno&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">n_signals_tot</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">indices</span> <span class="o">=</span> <a href="../../generated/mne.connectivity.seed_target_indices.html#mne.connectivity.seed_target_indices"><span class="n">seed_target_indices</span></a><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.arange.html#numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_signals_tot</span><span class="p">))</span>

<span class="c"># Compute the PSI in the frequency range 8Hz..30Hz. We exclude the baseline</span>
<span class="c"># period from the connectivity estimation</span>
<span class="n">fmin</span> <span class="o">=</span> <span class="mf">8.</span>
<span class="n">fmax</span> <span class="o">=</span> <span class="mf">30.</span>
<span class="n">tmin_con</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">sfreq</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s">&#39;sfreq&#39;</span><span class="p">]</span>  <span class="c"># the sampling frequency</span>

<span class="n">psi</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">n_epochs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <a href="../../generated/mne.connectivity.phase_slope_index.html#mne.connectivity.phase_slope_index"><span class="n">phase_slope_index</span></a><span class="p">(</span>
    <span class="n">comb_ts</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;multitaper&#39;</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">,</span> <span class="n">sfreq</span><span class="o">=</span><span class="n">sfreq</span><span class="p">,</span>
    <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="n">tmin_con</span><span class="p">)</span>

<span class="c"># Generate a SourceEstimate with the PSI. This is simple since we used a single</span>
<span class="c"># seed (inspect the indices variable to see how the PSI scores are arranged in</span>
<span class="c"># the output)</span>
<span class="n">psi_stc</span> <span class="o">=</span> <a href="../../generated/mne.SourceEstimate.html#mne.SourceEstimate"><span class="n">mne</span><span class="o">.</span><span class="n">SourceEstimate</span></a><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tstep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                             <span class="n">subject</span><span class="o">=</span><span class="s">&#39;sample&#39;</span><span class="p">)</span>

<span class="c"># Now we can visualize the PSI using the plot method. We use a custom colormap</span>
<span class="c"># to show signed values</span>
<span class="n">v_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">psi</span><span class="p">))</span>
<span class="n">brain</span> <span class="o">=</span> <span class="n">psi_stc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="s">&#39;inflated&#39;</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s">&#39;lh&#39;</span><span class="p">,</span>
                     <span class="n">time_label</span><span class="o">=</span><span class="s">&#39;Phase Slope Index (PSI)&#39;</span><span class="p">,</span>
                     <span class="n">subjects_dir</span><span class="o">=</span><span class="n">subjects_dir</span><span class="p">,</span>
                     <span class="n">clim</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">&#39;percent&#39;</span><span class="p">,</span> <span class="n">pos_lims</span><span class="o">=</span><span class="p">(</span><span class="mi">95</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)))</span>
<span class="n">brain</span><span class="o">.</span><span class="n">show_view</span><span class="p">(</span><span class="s">&#39;medial&#39;</span><span class="p">)</span>
<span class="n">brain</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="n">fname_label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Total running time of the script:</strong>
(0 minutes 14.145 seconds)</p>
<p><strong>Download Python source code:</strong> <a class="reference download internal" href="../../_downloads/plot_mne_inverse_psi_visual.py"><code class="xref download docutils literal"><span class="pre">plot_mne_inverse_psi_visual.py</span></code></a></p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2012-2015, MNE Developers.<br/>
    </p>
  </div>
</footer>
  </body>
</html>