<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Time-frequency beamforming using DICS &mdash; MNE 0.11.dev0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.11.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="MNE 0.11.dev0 documentation" href="../../index.html" />
    <link rel="up" title="Examples Gallery" href="../index.html" />
    <link rel="next" title="Time-frequency beamforming using LCMV" href="plot_tf_lcmv.html" />
    <link rel="prev" title="Plot an estimate of data SNR" href="plot_snr_estimate.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body role="document">

<div class="devbar">
This documentation is for the development version (0.11.dev0) - <a href="http://martinos.org/mne/stable">Stable version</a>
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/mne_logo_small.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.11.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../tutorials.html">Tutorials</a></li>
                <li><a href="../index.html">Gallery</a></li>
                <li><a href="../../manual/index.html">Manual</a></li>
                <li><a href="../../python_reference.html">API</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
                <li><a href="../../cite.html">Cite</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new.html">What&#8217;s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Cite MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">Related publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manual/index.html">Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_setup.html">Advanced installation and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mne_cpp.html">MNE with CPP</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Time-frequency beamforming using DICS</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Time-frequency beamforming using DICS</a></li>
</ul>

  <li>
    <a href="plot_snr_estimate.html" title="Previous Chapter: Plot an estimate of data SNR"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Plot an estim...</span>
    </a>
  </li>
  <li>
    <a href="plot_tf_lcmv.html" title="Next Chapter: Time-frequency beamforming using LCMV"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Time-frequenc... &raquo;</span>
    </a>
  </li>
<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12">
      
  <div class="section" id="time-frequency-beamforming-using-dics">
<span id="sphx-glr-auto-examples-inverse-plot-tf-dics-py"></span><h1>Time-frequency beamforming using DICS<a class="headerlink" href="#time-frequency-beamforming-using-dics" title="Permalink to this headline">Â¶</a></h1>
<p>Compute DICS source power in a grid of time-frequency windows and display
results.</p>
<p>The original reference is:
Dalal et al. Five-dimensional neuroimaging: Localization of the time-frequency
dynamics of cortical activity. NeuroImage (2008) vol. 40 (4) pp. 1686-1700</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Author: Roman Goj &lt;roman.goj@gmail.com&gt;</span>
<span class="c">#</span>
<span class="c"># License: BSD (3-clause)</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.io</span> <span class="kn">import</span> <a href="../../generated/mne.io.Raw.html#mne.io.Raw"><span class="n">Raw</span></a>
<span class="kn">from</span> <span class="nn">mne.event</span> <span class="kn">import</span> <a href="../../generated/mne.make_fixed_length_events.html#mne.make_fixed_length_events"><span class="n">make_fixed_length_events</span></a>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">mne.time_frequency</span> <span class="kn">import</span> <a href="../../generated/mne.time_frequency.compute_epochs_csd.html#mne.time_frequency.compute_epochs_csd"><span class="n">compute_epochs_csd</span></a>
<span class="kn">from</span> <span class="nn">mne.beamformer</span> <span class="kn">import</span> <span class="n">tf_dics</span>
<span class="kn">from</span> <span class="nn">mne.viz</span> <span class="kn">import</span> <span class="n">plot_source_spectrogram</span>

<span class="k">print</span><span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>

<span class="n">data_path</span> <span class="o">=</span> <a href="../../generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path"><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<span class="n">raw_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis_raw.fif&#39;</span>
<span class="n">noise_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/ernoise_raw.fif&#39;</span>
<span class="n">event_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis_raw-eve.fif&#39;</span>
<span class="n">fname_fwd</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis-meg-eeg-oct-6-fwd.fif&#39;</span>
<span class="n">subjects_dir</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/subjects&#39;</span>
<span class="n">label_name</span> <span class="o">=</span> <span class="s">&#39;Aud-lh&#39;</span>
<span class="n">fname_label</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/labels/</span><span class="si">%s</span><span class="s">.label&#39;</span> <span class="o">%</span> <span class="n">label_name</span>
</pre></div>
</div>
<p class="sphx-glr-horizontal">Read raw data</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">raw</span> <span class="o">=</span> <a href="../../generated/mne.io.Raw.html#mne.io.Raw"><span class="n">Raw</span></a><span class="p">(</span><span class="n">raw_fname</span><span class="p">)</span>
<span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s">&#39;bads&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;MEG 2443&#39;</span><span class="p">]</span>  <span class="c"># 1 bad MEG channel</span>

<span class="c"># Pick a selection of magnetometer channels. A subset of all channels was used</span>
<span class="c"># to speed up the example. For a solution based on all MEG channels use</span>
<span class="c"># meg=True, selection=None and add mag=4e-12 to the reject dictionary.</span>
<span class="n">left_temporal_channels</span> <span class="o">=</span> <a href="../../generated/mne.read_selection.html#mne.read_selection"><span class="n">mne</span><span class="o">.</span><span class="n">read_selection</span></a><span class="p">(</span><span class="s">&#39;Left-temporal&#39;</span><span class="p">)</span>
<span class="n">picks</span> <span class="o">=</span> <a href="../../generated/mne.pick_types.html#mne.pick_types"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="s">&#39;mag&#39;</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">stim</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="s">&#39;bads&#39;</span><span class="p">,</span>
                       <span class="n">selection</span><span class="o">=</span><span class="n">left_temporal_channels</span><span class="p">)</span>
<span class="n">reject</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">mag</span><span class="o">=</span><span class="mf">4e-12</span><span class="p">)</span>

<span class="c"># Setting time windows. Note that tmin and tmax are set so that time-frequency</span>
<span class="c"># beamforming will be performed for a wider range of time points than will</span>
<span class="c"># later be displayed on the final spectrogram. This ensures that all time bins</span>
<span class="c"># displayed represent an average of an equal number of time windows.</span>
<span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">tstep</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.05</span>  <span class="c"># s</span>
<span class="n">tmin_plot</span><span class="p">,</span> <span class="n">tmax_plot</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span>  <span class="c"># s</span>

<span class="c"># Read epochs</span>
<span class="n">event_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">events</span> <span class="o">=</span> <a href="../../generated/mne.read_events.html#mne.read_events"><span class="n">mne</span><span class="o">.</span><span class="n">read_events</span></a><span class="p">(</span><span class="n">event_fname</span><span class="p">)</span>
<span class="n">epochs</span> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">event_id</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span>
                    <span class="n">baseline</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="n">reject</span><span class="p">)</span>

<span class="c"># Read empty room noise raw data</span>
<span class="n">raw_noise</span> <span class="o">=</span> <a href="../../generated/mne.io.Raw.html#mne.io.Raw"><span class="n">Raw</span></a><span class="p">(</span><span class="n">noise_fname</span><span class="p">)</span>
<span class="n">raw_noise</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s">&#39;bads&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;MEG 2443&#39;</span><span class="p">]</span>  <span class="c"># 1 bad MEG channel</span>

<span class="c"># Create noise epochs and make sure the number of noise epochs corresponds to</span>
<span class="c"># the number of data epochs</span>
<span class="n">events_noise</span> <span class="o">=</span> <a href="../../generated/mne.make_fixed_length_events.html#mne.make_fixed_length_events"><span class="n">make_fixed_length_events</span></a><span class="p">(</span><span class="n">raw_noise</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span>
<span class="n">epochs_noise</span> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw_noise</span><span class="p">,</span> <span class="n">events_noise</span><span class="p">,</span> <span class="n">event_id</span><span class="p">,</span> <span class="n">tmin_plot</span><span class="p">,</span>
                          <span class="n">tmax_plot</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span>
                          <span class="n">baseline</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="n">reject</span><span class="p">)</span>
<span class="c"># then make sure the number of epochs is the same</span>
<span class="n">epochs_noise</span> <span class="o">=</span> <span class="n">epochs_noise</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">events</span><span class="p">)]</span>

<span class="c"># Read forward operator</span>
<span class="n">forward</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">read_forward_solution</span><span class="p">(</span><span class="n">fname_fwd</span><span class="p">,</span> <span class="n">surf_ori</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># Read label</span>
<span class="n">label</span> <span class="o">=</span> <a href="../../generated/mne.read_label.html#mne.read_label"><span class="n">mne</span><span class="o">.</span><span class="n">read_label</span></a><span class="p">(</span><span class="n">fname_label</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-horizontal"><strong>Script output</strong>:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre>Opening raw data file /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/sample_audvis_raw.fif...
    Read a total of 3 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
Current compensation grade : 0
    Range : 25800 ... 192599 =     42.956 ...   320.670 secs
Ready.
Adding average EEG reference projection.
1 projection items deactivated
72 matching events found
Created an SSP operator (subspace dimension = 3)
4 projection items activated
Reading 2641 ... 3421  =      4.397 ...     5.696 secs...
[done]
No baseline correction applied...
Reading 4320 ... 5100  =      7.193 ...     8.491 secs...
[done]
No baseline correction applied...
Reading 5971 ... 6751  =      9.941 ...    11.240 secs...
[done]
No baseline correction applied...
Reading 7582 ... 8362  =     12.624 ...    13.922 secs...
[done]
No baseline correction applied...
Reading 9298 ... 10078  =     15.481 ...    16.779 secs...
[done]
No baseline correction applied...
Reading 10877 ... 11657  =     18.110 ...    19.408 secs...
[done]
No baseline correction applied...
Reading 12581 ... 13361  =     20.947 ...    22.246 secs...
[done]
No baseline correction applied...
Reading 14275 ... 15055  =     23.767 ...    25.066 secs...
[done]
No baseline correction applied...
Reading 15996 ... 16776  =     26.633 ...    27.931 secs...
[done]
No baseline correction applied...
Reading 17651 ... 18431  =     29.388 ...    30.687 secs...
[done]
No baseline correction applied...
Reading 19356 ... 20136  =     32.227 ...    33.526 secs...
[done]
No baseline correction applied...
Reading 20965 ... 21745  =     34.906 ...    36.205 secs...
[done]
No baseline correction applied...
Reading 22592 ... 23372  =     37.615 ...    38.913 secs...
[done]
No baseline correction applied...
Reading 24139 ... 24919  =     40.190 ...    41.489 secs...
[done]
No baseline correction applied...
Reading 25751 ... 26531  =     42.874 ...    44.173 secs...
[done]
No baseline correction applied...
Reading 27364 ... 28144  =     45.560 ...    46.859 secs...
[done]
No baseline correction applied...
Reading 28970 ... 29750  =     48.234 ...    49.533 secs...
[done]
No baseline correction applied...
Reading 30587 ... 31367  =     50.926 ...    52.225 secs...
[done]
No baseline correction applied...
Reading 32318 ... 33098  =     53.808 ...    55.107 secs...
[done]
No baseline correction applied...
Reading 33999 ... 34779  =     56.607 ...    57.906 secs...
[done]
No baseline correction applied...
Reading 35738 ... 36518  =     59.502 ...    60.801 secs...
[done]
No baseline correction applied...
Reading 37402 ... 38182  =     62.273 ...    63.572 secs...
[done]
No baseline correction applied...
Reading 39051 ... 39831  =     65.018 ...    66.317 secs...
[done]
No baseline correction applied...
Reading 40834 ... 41614  =     67.987 ...    69.286 secs...
[done]
No baseline correction applied...
Reading 42536 ... 43316  =     70.821 ...    72.119 secs...
[done]
No baseline correction applied...
Reading 44129 ... 44909  =     73.473 ...    74.772 secs...
[done]
No baseline correction applied...
Reading 45861 ... 46641  =     76.357 ...    77.655 secs...
[done]
No baseline correction applied...
Reading 47588 ... 48368  =     79.232 ...    80.531 secs...
[done]
No baseline correction applied...
Reading 50764 ... 51544  =     84.520 ...    85.819 secs...
[done]
No baseline correction applied...
Reading 52409 ... 53189  =     87.259 ...    88.558 secs...
[done]
No baseline correction applied...
Reading 54079 ... 54859  =     90.039 ...    91.338 secs...
[done]
No baseline correction applied...
Reading 55781 ... 56561  =     92.873 ...    94.172 secs...
[done]
No baseline correction applied...
Reading 57438 ... 58218  =     95.632 ...    96.931 secs...
[done]
No baseline correction applied...
Reading 59169 ... 59949  =     98.514 ...    99.813 secs...
[done]
No baseline correction applied...
Reading 60841 ... 61621  =    101.298 ...   102.597 secs...
[done]
No baseline correction applied...
Reading 62463 ... 63243  =    103.998 ...   105.297 secs...
[done]
No baseline correction applied...
Reading 64289 ... 65069  =    107.039 ...   108.337 secs...
[done]
No baseline correction applied...
Reading 65908 ... 66688  =    109.734 ...   111.033 secs...
[done]
No baseline correction applied...
Reading 67539 ... 68319  =    112.450 ...   113.748 secs...
[done]
No baseline correction applied...
Reading 69305 ... 70085  =    115.390 ...   116.689 secs...
[done]
No baseline correction applied...
Reading 71104 ... 71884  =    118.385 ...   119.684 secs...
[done]
No baseline correction applied...
Reading 72773 ... 73553  =    121.164 ...   122.463 secs...
[done]
No baseline correction applied...
Reading 74490 ... 75270  =    124.023 ...   125.322 secs...
[done]
No baseline correction applied...
Reading 76158 ... 76938  =    126.800 ...   128.099 secs...
[done]
No baseline correction applied...
Reading 77903 ... 78683  =    129.705 ...   131.004 secs...
[done]
No baseline correction applied...
Reading 79630 ... 80410  =    132.581 ...   133.879 secs...
[done]
No baseline correction applied...
Reading 81225 ... 82005  =    135.236 ...   136.535 secs...
[done]
No baseline correction applied...
Reading 84444 ... 85224  =    140.596 ...   141.895 secs...
[done]
No baseline correction applied...
Reading 86162 ... 86942  =    143.456 ...   144.755 secs...
[done]
No baseline correction applied...
Reading 87822 ... 88602  =    146.220 ...   147.519 secs...
[done]
No baseline correction applied...
Reading 89489 ... 90269  =    148.996 ...   150.294 secs...
[done]
No baseline correction applied...
Reading 91174 ... 91954  =    151.801 ...   153.100 secs...
[done]
No baseline correction applied...
Reading 92749 ... 93529  =    154.423 ...   155.722 secs...
[done]
No baseline correction applied...
Reading 94409 ... 95189  =    157.187 ...   158.486 secs...
[done]
No baseline correction applied...
Reading 96088 ... 96868  =    159.983 ...   161.281 secs...
[done]
No baseline correction applied...
Reading 97801 ... 98581  =    162.835 ...   164.133 secs...
[done]
No baseline correction applied...
Reading 99579 ... 100359  =    165.795 ...   167.094 secs...
[done]
No baseline correction applied...
Reading 101201 ... 101981  =    168.496 ...   169.794 secs...
[done]
No baseline correction applied...
Reading 102795 ... 103575  =    171.150 ...   172.448 secs...
[done]
No baseline correction applied...
Reading 104365 ... 105145  =    173.764 ...   175.062 secs...
[done]
No baseline correction applied...
Reading 105951 ... 106731  =    176.404 ...   177.703 secs...
[done]
No baseline correction applied...
Reading 109403 ... 110183  =    182.152 ...   183.450 secs...
[done]
No baseline correction applied...
Reading 111003 ... 111783  =    184.816 ...   186.114 secs...
[done]
No baseline correction applied...
Reading 112706 ... 113486  =    187.651 ...   188.950 secs...
[done]
No baseline correction applied...
Reading 114482 ... 115262  =    190.608 ...   191.907 secs...
[done]
No baseline correction applied...
Reading 117941 ... 118721  =    196.367 ...   197.666 secs...
[done]
No baseline correction applied...
Reading 119536 ... 120316  =    199.023 ...   200.321 secs...
[done]
No baseline correction applied...
Reading 121328 ... 122108  =    202.006 ...   203.305 secs...
[done]
No baseline correction applied...
Reading 123032 ... 123812  =    204.843 ...   206.142 secs...
[done]
No baseline correction applied...
Reading 124742 ... 125522  =    207.690 ...   208.989 secs...
[done]
No baseline correction applied...
Reading 126296 ... 127076  =    210.278 ...   211.576 secs...
[done]
No baseline correction applied...
Reading 127950 ... 128730  =    213.032 ...   214.330 secs...
[done]
No baseline correction applied...
0 bad epochs dropped
Opening raw data file /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/ernoise_raw.fif...
Isotrak not found
    Read a total of 3 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
Current compensation grade : 0
    Range : 19800 ... 85867 =     32.966 ...   142.965 secs
Ready.
109 matching events found
Created an SSP operator (subspace dimension = 3)
3 projection items activated
Reading 420 ... 900  =      0.699 ...     1.498 secs...
[done]
No baseline correction applied...
Reading 1021 ... 1501  =      1.700 ...     2.499 secs...
[done]
No baseline correction applied...
Reading 1621 ... 2101  =      2.699 ...     3.498 secs...
[done]
No baseline correction applied...
Reading 2222 ... 2702  =      3.700 ...     4.499 secs...
[done]
No baseline correction applied...
Reading 2823 ... 3303  =      4.700 ...     5.499 secs...
[done]
No baseline correction applied...
Reading 3423 ... 3903  =      5.699 ...     6.498 secs...
[done]
No baseline correction applied...
Reading 4024 ... 4504  =      6.700 ...     7.499 secs...
[done]
No baseline correction applied...
Reading 4624 ... 5104  =      7.699 ...     8.498 secs...
[done]
No baseline correction applied...
Reading 5225 ... 5705  =      8.699 ...     9.499 secs...
[done]
No baseline correction applied...
Reading 5826 ... 6306  =      9.700 ...    10.499 secs...
[done]
No baseline correction applied...
Reading 6426 ... 6906  =     10.699 ...    11.498 secs...
[done]
No baseline correction applied...
Reading 7027 ... 7507  =     11.700 ...    12.499 secs...
[done]
No baseline correction applied...
Reading 7627 ... 8107  =     12.699 ...    13.498 secs...
[done]
No baseline correction applied...
Reading 8228 ... 8708  =     13.699 ...    14.498 secs...
[done]
No baseline correction applied...
Reading 8829 ... 9309  =     14.700 ...    15.499 secs...
[done]
No baseline correction applied...
Reading 9429 ... 9909  =     15.699 ...    16.498 secs...
[done]
No baseline correction applied...
Reading 10030 ... 10510  =     16.700 ...    17.499 secs...
[done]
No baseline correction applied...
Reading 10631 ... 11111  =     17.700 ...    18.499 secs...
[done]
No baseline correction applied...
Reading 11231 ... 11711  =     18.699 ...    19.498 secs...
[done]
No baseline correction applied...
Reading 11832 ... 12312  =     19.700 ...    20.499 secs...
[done]
No baseline correction applied...
Reading 12432 ... 12912  =     20.699 ...    21.498 secs...
[done]
No baseline correction applied...
Reading 13033 ... 13513  =     21.699 ...    22.499 secs...
[done]
No baseline correction applied...
Reading 13634 ... 14114  =     22.700 ...    23.499 secs...
[done]
No baseline correction applied...
Reading 14234 ... 14714  =     23.699 ...    24.498 secs...
[done]
No baseline correction applied...
Reading 14835 ... 15315  =     24.700 ...    25.499 secs...
[done]
No baseline correction applied...
Reading 15435 ... 15915  =     25.699 ...    26.498 secs...
[done]
No baseline correction applied...
Reading 16036 ... 16516  =     26.699 ...    27.498 secs...
[done]
No baseline correction applied...
Reading 16637 ... 17117  =     27.700 ...    28.499 secs...
[done]
No baseline correction applied...
Reading 17237 ... 17717  =     28.699 ...    29.498 secs...
[done]
No baseline correction applied...
Reading 17838 ... 18318  =     29.700 ...    30.499 secs...
[done]
No baseline correction applied...
Reading 18439 ... 18919  =     30.700 ...    31.499 secs...
[done]
No baseline correction applied...
Reading 19039 ... 19519  =     31.699 ...    32.498 secs...
[done]
No baseline correction applied...
Reading 19640 ... 20120  =     32.700 ...    33.499 secs...
[done]
No baseline correction applied...
Reading 20240 ... 20720  =     33.699 ...    34.498 secs...
[done]
No baseline correction applied...
Reading 20841 ... 21321  =     34.699 ...    35.499 secs...
[done]
No baseline correction applied...
Reading 21442 ... 21922  =     35.700 ...    36.499 secs...
[done]
No baseline correction applied...
Reading 22042 ... 22522  =     36.699 ...    37.498 secs...
[done]
No baseline correction applied...
Reading 22643 ... 23123  =     37.700 ...    38.499 secs...
[done]
No baseline correction applied...
Reading 23243 ... 23723  =     38.699 ...    39.498 secs...
[done]
No baseline correction applied...
Reading 23844 ... 24324  =     39.699 ...    40.498 secs...
[done]
No baseline correction applied...
Reading 24445 ... 24925  =     40.700 ...    41.499 secs...
[done]
No baseline correction applied...
Reading 25045 ... 25525  =     41.699 ...    42.498 secs...
[done]
No baseline correction applied...
Reading 25646 ... 26126  =     42.700 ...    43.499 secs...
[done]
No baseline correction applied...
Reading 26247 ... 26727  =     43.700 ...    44.499 secs...
[done]
No baseline correction applied...
Reading 26847 ... 27327  =     44.699 ...    45.498 secs...
[done]
No baseline correction applied...
Reading 27448 ... 27928  =     45.700 ...    46.499 secs...
[done]
No baseline correction applied...
Reading 28048 ... 28528  =     46.699 ...    47.498 secs...
[done]
No baseline correction applied...
Reading 28649 ... 29129  =     47.699 ...    48.499 secs...
[done]
No baseline correction applied...
Reading 29250 ... 29730  =     48.700 ...    49.499 secs...
[done]
No baseline correction applied...
Reading 29850 ... 30330  =     49.699 ...    50.498 secs...
[done]
No baseline correction applied...
Reading 30451 ... 30931  =     50.700 ...    51.499 secs...
[done]
No baseline correction applied...
Reading 31051 ... 31531  =     51.699 ...    52.498 secs...
[done]
No baseline correction applied...
Reading 31652 ... 32132  =     52.699 ...    53.498 secs...
[done]
No baseline correction applied...
Reading 32253 ... 32733  =     53.700 ...    54.499 secs...
[done]
No baseline correction applied...
Reading 32853 ... 33333  =     54.699 ...    55.498 secs...
[done]
No baseline correction applied...
Reading 33454 ... 33934  =     55.700 ...    56.499 secs...
[done]
No baseline correction applied...
Reading 34055 ... 34535  =     56.700 ...    57.499 secs...
[done]
No baseline correction applied...
Reading 34655 ... 35135  =     57.699 ...    58.498 secs...
[done]
No baseline correction applied...
Reading 35256 ... 35736  =     58.700 ...    59.499 secs...
[done]
No baseline correction applied...
Reading 35856 ... 36336  =     59.699 ...    60.498 secs...
[done]
No baseline correction applied...
Reading 36457 ... 36937  =     60.699 ...    61.499 secs...
[done]
No baseline correction applied...
Reading 37058 ... 37538  =     61.700 ...    62.499 secs...
[done]
No baseline correction applied...
Reading 37658 ... 38138  =     62.699 ...    63.498 secs...
[done]
No baseline correction applied...
Reading 38259 ... 38739  =     63.700 ...    64.499 secs...
[done]
No baseline correction applied...
Reading 38859 ... 39339  =     64.699 ...    65.498 secs...
[done]
No baseline correction applied...
Reading 39460 ... 39940  =     65.699 ...    66.499 secs...
[done]
No baseline correction applied...
Reading 40061 ... 40541  =     66.700 ...    67.499 secs...
[done]
No baseline correction applied...
Reading 40661 ... 41141  =     67.699 ...    68.498 secs...
[done]
No baseline correction applied...
Reading 41262 ... 41742  =     68.700 ...    69.499 secs...
[done]
No baseline correction applied...
Reading 41863 ... 42343  =     69.700 ...    70.499 secs...
[done]
No baseline correction applied...
Reading 42463 ... 42943  =     70.699 ...    71.498 secs...
[done]
No baseline correction applied...
Reading 43064 ... 43544  =     71.700 ...    72.499 secs...
[done]
No baseline correction applied...
Reading 43664 ... 44144  =     72.699 ...    73.498 secs...
[done]
No baseline correction applied...
Reading 44265 ... 44745  =     73.699 ...    74.499 secs...
[done]
No baseline correction applied...
Reading 44866 ... 45346  =     74.700 ...    75.499 secs...
[done]
No baseline correction applied...
Reading 45466 ... 45946  =     75.699 ...    76.498 secs...
[done]
No baseline correction applied...
Reading 46067 ... 46547  =     76.700 ...    77.499 secs...
[done]
No baseline correction applied...
Reading 46667 ... 47147  =     77.699 ...    78.498 secs...
[done]
No baseline correction applied...
Reading 47268 ... 47748  =     78.699 ...    79.499 secs...
[done]
No baseline correction applied...
Reading 47869 ... 48349  =     79.700 ...    80.499 secs...
[done]
No baseline correction applied...
Reading 48469 ... 48949  =     80.699 ...    81.498 secs...
[done]
No baseline correction applied...
Reading 49070 ... 49550  =     81.700 ...    82.499 secs...
[done]
No baseline correction applied...
Reading 49671 ... 50151  =     82.700 ...    83.499 secs...
[done]
No baseline correction applied...
Reading 50271 ... 50751  =     83.699 ...    84.498 secs...
[done]
No baseline correction applied...
Reading 50872 ... 51352  =     84.700 ...    85.499 secs...
[done]
No baseline correction applied...
Reading 51472 ... 51952  =     85.699 ...    86.498 secs...
[done]
No baseline correction applied...
Reading 52073 ... 52553  =     86.699 ...    87.499 secs...
[done]
No baseline correction applied...
Reading 52674 ... 53154  =     87.700 ...    88.499 secs...
[done]
No baseline correction applied...
Reading 53274 ... 53754  =     88.699 ...    89.498 secs...
[done]
No baseline correction applied...
Reading 53875 ... 54355  =     89.700 ...    90.499 secs...
[done]
No baseline correction applied...
Reading 54475 ... 54955  =     90.699 ...    91.498 secs...
[done]
No baseline correction applied...
Reading 55076 ... 55556  =     91.699 ...    92.499 secs...
[done]
No baseline correction applied...
Reading 55677 ... 56157  =     92.700 ...    93.499 secs...
[done]
No baseline correction applied...
Reading 56277 ... 56757  =     93.699 ...    94.498 secs...
[done]
No baseline correction applied...
Reading 56878 ... 57358  =     94.700 ...    95.499 secs...
[done]
No baseline correction applied...
Reading 57479 ... 57959  =     95.700 ...    96.499 secs...
[done]
No baseline correction applied...
Reading 58079 ... 58559  =     96.699 ...    97.498 secs...
[done]
No baseline correction applied...
Reading 58680 ... 59160  =     97.700 ...    98.499 secs...
[done]
No baseline correction applied...
Reading 59280 ... 59760  =     98.699 ...    99.498 secs...
[done]
No baseline correction applied...
Reading 59881 ... 60361  =     99.699 ...   100.499 secs...
[done]
No baseline correction applied...
Reading 60482 ... 60962  =    100.700 ...   101.499 secs...
[done]
No baseline correction applied...
Reading 61082 ... 61562  =    101.699 ...   102.498 secs...
[done]
No baseline correction applied...
Reading 61683 ... 62163  =    102.700 ...   103.499 secs...
[done]
No baseline correction applied...
Reading 62283 ... 62763  =    103.699 ...   104.498 secs...
[done]
No baseline correction applied...
Reading 62884 ... 63364  =    104.699 ...   105.499 secs...
[done]
No baseline correction applied...
Reading 63485 ... 63965  =    105.700 ...   106.499 secs...
[done]
No baseline correction applied...
Reading 64085 ... 64565  =    106.699 ...   107.498 secs...
[done]
No baseline correction applied...
Reading 64686 ... 65166  =    107.700 ...   108.499 secs...
[done]
No baseline correction applied...
1 bad epochs dropped
Reading forward solution from /home/jaakko/mne-testing-data/MNE-sample-data/MEG/sample/sample_audvis-meg-eeg-oct-6-fwd.fif...
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    2 source spaces read
    Desired named matrix (kind = 3523) not available
    Read MEG forward solution (7498 sources, 306 channels, free orientations)
    Desired named matrix (kind = 3523) not available
    Read EEG forward solution (7498 sources, 60 channels, free orientations)
    MEG and EEG forward solutions combined
    Source spaces transformed to the forward solution coordinate frame
    Converting to surface-based source orientations...
    Average patch normals will be employed in the rotation to the local surface coordinates....
[done]
</pre></div>
</div>
<p>Time-frequency beamforming based on DICS</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Setting frequency bins as in Dalal et al. 2008</span>
<span class="n">freq_bins</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span> <span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">300</span><span class="p">)]</span>  <span class="c"># Hz</span>
<span class="n">win_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>  <span class="c"># s</span>
<span class="c"># Then set FFTs length for each frequency range.</span>
<span class="c"># Should be a power of 2 to be faster.</span>
<span class="n">n_ffts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">]</span>

<span class="c"># Subtract evoked response prior to computation?</span>
<span class="n">subtract_evoked</span> <span class="o">=</span> <span class="bp">False</span>

<span class="c"># Calculating noise cross-spectral density from empty room noise for each</span>
<span class="c"># frequency bin and the corresponding time window length. To calculate noise</span>
<span class="c"># from the baseline period in the data, change epochs_noise to epochs</span>
<span class="n">noise_csds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">freq_bin</span><span class="p">,</span> <span class="n">win_length</span><span class="p">,</span> <span class="n">n_fft</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">,</span> <span class="n">win_lengths</span><span class="p">,</span> <span class="n">n_ffts</span><span class="p">):</span>
    <span class="n">noise_csd</span> <span class="o">=</span> <a href="../../generated/mne.time_frequency.compute_epochs_csd.html#mne.time_frequency.compute_epochs_csd"><span class="n">compute_epochs_csd</span></a><span class="p">(</span><span class="n">epochs_noise</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;fourier&#39;</span><span class="p">,</span>
                                   <span class="n">fmin</span><span class="o">=</span><span class="n">freq_bin</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fmax</span><span class="o">=</span><span class="n">freq_bin</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="n">fsum</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=-</span><span class="n">win_length</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                   <span class="n">n_fft</span><span class="o">=</span><span class="n">n_fft</span><span class="p">)</span>
    <span class="n">noise_csds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">noise_csd</span><span class="p">)</span>

<span class="c"># Computing DICS solutions for time-frequency windows in a label in source</span>
<span class="c"># space for faster computation, use label=None for full solution</span>
<span class="n">stcs</span> <span class="o">=</span> <span class="n">tf_dics</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">forward</span><span class="p">,</span> <span class="n">noise_csds</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">tstep</span><span class="p">,</span> <span class="n">win_lengths</span><span class="p">,</span>
               <span class="n">freq_bins</span><span class="o">=</span><span class="n">freq_bins</span><span class="p">,</span> <span class="n">subtract_evoked</span><span class="o">=</span><span class="n">subtract_evoked</span><span class="p">,</span>
               <span class="n">n_ffts</span><span class="o">=</span><span class="n">n_ffts</span><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="c"># Plotting source spectrogram for source with maximum activity</span>
<span class="c"># Note that tmin and tmax are set to display a time range that is smaller than</span>
<span class="c"># the one for which beamforming estimates were calculated. This ensures that</span>
<span class="c"># all time bins shown are a result of smoothing across an identical number of</span>
<span class="c"># time windows.</span>
<span class="n">plot_source_spectrogram</span><span class="p">(</span><span class="n">stcs</span><span class="p">,</span> <span class="n">freq_bins</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="n">tmin_plot</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="n">tmax_plot</span><span class="p">,</span>
                        <span class="n">source_index</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_tf_dics_001.png" class="align-center" src="../../_images/sphx_glr_plot_tf_dics_001.png" />
<p><strong>Script output</strong>:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre>Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
Computing time-frequency DICS beamformer for time window -550 to -250 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -500 to -200 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -450 to -150 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -400 to -100 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -350 to -50 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -300 to 0 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -250 to 49 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -200 to 99 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -150 to 149 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -100 to 199 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -50 to 249 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 0 to 300 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 50 to 350 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 99 to 399 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 150 to 450 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 199 to 499 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 250 to 550 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 300 to 600 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 350 to 649 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 400 to 700 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 449 to 750 ms, in frequency range 4 to 12 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -550 to -350 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -500 to -300 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -450 to -250 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -400 to -200 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -350 to -150 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -300 to -100 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -250 to -49 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -200 to 0 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -150 to 49 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -100 to 99 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -50 to 149 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 0 to 200 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 50 to 250 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 99 to 300 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 150 to 350 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 199 to 399 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 250 to 450 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 300 to 500 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 350 to 550 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 400 to 600 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 449 to 649 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 500 to 700 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 550 to 750 ms, in frequency range 12 to 30 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -550 to -400 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -500 to -350 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -450 to -300 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -400 to -250 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -350 to -200 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -300 to -150 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -250 to -100 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -200 to -50 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -150 to 0 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -100 to 49 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -50 to 99 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 0 to 150 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 50 to 200 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 99 to 249 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 150 to 300 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 199 to 350 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 250 to 400 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 300 to 450 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 350 to 500 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 400 to 550 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 449 to 600 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 500 to 650 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 550 to 700 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 600 to 750 ms, in frequency range 30 to 55 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -550 to -450 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -500 to -400 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -450 to -350 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -400 to -300 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -350 to -250 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -300 to -200 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -250 to -150 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -200 to -100 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -150 to -50 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -100 to 0 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window -50 to 49 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 0 to 100 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 50 to 150 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 99 to 199 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 150 to 250 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 199 to 299 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 250 to 350 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 300 to 400 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 350 to 449 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 400 to 500 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 449 to 549 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 500 to 600 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 550 to 650 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 600 to 700 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 650 to 750 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
Computing time-frequency DICS beamformer for time window 650 to 750 ms, in frequency range 65 to 300 Hz
Computing cross-spectral density from epochs...
    using FFT with a Hanning window to estimate spectra
[done]
    13 out of 366 channels remain after picking
Computing DICS source power...
[done]
</pre></div>
</div>
<p><strong>Total running time of the script:</strong>
(0 minutes 16.256 seconds)</p>
<p><strong>Download Python source code:</strong> <a class="reference download internal" href="../../_downloads/plot_tf_dics.py"><code class="xref download docutils literal"><span class="pre">plot_tf_dics.py</span></code></a></p>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2012-2015, MNE Developers.<br/>
    </p>
  </div>
</footer>
  </body>
</html>