<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Reading a .dip file form xfit and view with source space in 3D &mdash; MNE 0.11.dev0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.11.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="MNE 0.11.dev0 documentation" href="../../../index.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body role="document">

<div class="devbar">
This documentation is for the development version (0.11.dev0) - <a href="http://martinos.org/mne/stable">Stable version</a>
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><img src="../../../_static/mne_logo_small.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.11.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../tutorials.html">Tutorials</a></li>
                <li><a href="../../../auto_examples/index.html">Gallery</a></li>
                <li><a href="../../../manual/index.html">Manual</a></li>
                <li><a href="../../../python_reference.html">API</a></li>
                <li><a href="../../../faq.html">FAQ</a></li>
                <li><a href="../../../cite.html">Cite</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../whats_new.html">What&#8217;s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cite.html">Cite MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">Related publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/index.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual/index.html">Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../python_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced_setup.html">Advanced installation and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mne_cpp.html">MNE with CPP</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Reading a .dip file form xfit and view with source space in 3D</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Reading a .dip file form xfit and view with source space in 3D</a></li>
</ul>

<form action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12">
      
  <div class="section" id="reading-a-dip-file-form-xfit-and-view-with-source-space-in-3d">
<span id="example-inverse-plot-dipole-fit-result-py"></span><h1>Reading a .dip file form xfit and view with source space in 3D<a class="headerlink" href="#reading-a-dip-file-form-xfit-and-view-with-source-space-in-3d" title="Permalink to this headline">Â¶</a></h1>
<p>Here the .dip file was generated with the mne_dipole_fit command.</p>
<p>Detailed unix command is :</p>
<p>$mne_dipole_fit &#8211;meas sample_audvis-ave.fif &#8211;set 1 &#8211;meg &#8211;tmin 40 &#8211;tmax 95     &#8211;bmin -200 &#8211;bmax 0 &#8211;noise sample_audvis-cov.fif     &#8211;bem ../../subjects/sample/bem/sample-5120-bem-sol.fif     &#8211;origin 0:0:40 &#8211;mri sample_audvis-meg-oct-6-fwd.fif     &#8211;dip sample_audvis_set1.dip</p>
<img alt="../../../_images/plot_dipole_fit_result_1.png" class="align-center" src="../../../_images/plot_dipole_fit_result_1.png" />
<p><strong>Script output</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre>Time (ms): [ 40.   41.7  43.3  45.   46.7  48.3  50.   51.7  53.3  55.   56.6  58.3
  60.   61.6  63.3  65.   66.6  68.3  70.   71.6  73.3  75.   76.6  78.3
  80.   81.6  83.3  85.   86.6  88.3  89.9  91.6  93.3  94.9]
Amplitude (nAm): [ 16.363   7.204   6.303   7.55    7.152   7.335  17.149  17.414  22.821
  26.929  31.679  36.107  38.481  44.182  45.16   48.     50.67   55.408
  62.07   55.22   63.754  56.347  56.665  60.992  69.343  55.832  60.594
  54.541  52.57   34.17   37.244  39.864  41.987  46.065]
GOF (%): [ 14.1  12.7  13.6  15.4  14.6  18.9  25.6  32.2  38.2  43.8  48.2  51.3
  54.7  56.8  58.1  59.4  59.9  60.   60.9  60.5  59.8  58.   55.1  51.3
  46.2  42.5  37.5  33.3  29.1  31.2  35.6  39.8  43.7  47. ]
</pre></div>
</div>
<p><strong>Python source code:</strong> <a class="reference download internal" href="../../../_downloads/plot_dipole_fit_result.py"><code class="xref download docutils literal"><span class="pre">plot_dipole_fit_result.py</span></code></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Author: Alexandre Gramfort &lt;alexandre.gramfort@telecom-paristech.fr&gt;</span>
<span class="c">#</span>
<span class="c"># License: BSD (3-clause)</span>

<span class="k">print</span><span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">sample</span>

<span class="n">data_path</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">data_path</span><span class="p">()</span>
<span class="n">fwd_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis-meg-oct-6-fwd.fif&#39;</span>
<span class="n">dip_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis_set1.dip&#39;</span>
<span class="n">bem_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/subjects/sample/bem/sample-5120-bem-sol.fif&#39;</span>

<span class="n">brain_surface</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">read_bem_surfaces</span><span class="p">(</span><span class="n">bem_fname</span><span class="p">,</span> <span class="n">add_geom</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">brain_surface</span><span class="p">[</span><span class="s">&#39;rr&#39;</span><span class="p">]</span>
<span class="n">faces</span> <span class="o">=</span> <span class="n">brain_surface</span><span class="p">[</span><span class="s">&#39;tris&#39;</span><span class="p">]</span>

<span class="n">fwd</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">read_forward_solution</span><span class="p">(</span><span class="n">fwd_fname</span><span class="p">)</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">fwd</span><span class="p">[</span><span class="s">&#39;src&#39;</span><span class="p">]</span>

<span class="c"># read dipoles</span>
<span class="n">time</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span> <span class="n">ori</span><span class="p">,</span> <span class="n">gof</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">read_dip</span><span class="p">(</span><span class="n">dip_fname</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;Time (ms): </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">time</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Amplitude (nAm): </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">amplitude</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;GOF (</span><span class="si">%%</span><span class="s">): </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">gof</span><span class="p">)</span>

<span class="c"># only plot those for which GOF is above 50%</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">gof</span> <span class="o">&gt;</span> <span class="mf">50.</span><span class="p">]</span>
<span class="n">ori</span> <span class="o">=</span> <span class="n">ori</span><span class="p">[</span><span class="n">gof</span> <span class="o">&gt;</span> <span class="mf">50.</span><span class="p">]</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">gof</span> <span class="o">&gt;</span> <span class="mf">50.</span><span class="p">]</span>

<span class="c">###############################################################################</span>
<span class="c"># Show result on 3D source space</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">enthought.mayavi</span> <span class="kn">import</span> <span class="n">mlab</span>
<span class="k">except</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">mayavi</span> <span class="kn">import</span> <span class="n">mlab</span>

<span class="n">lh_points</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;rr&#39;</span><span class="p">]</span>
<span class="n">lh_faces</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;use_tris&#39;</span><span class="p">]</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="c"># show brain surface after proper coordinate system transformation</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">brain_surface</span><span class="p">[</span><span class="s">&#39;rr&#39;</span><span class="p">]</span>
<span class="n">faces</span> <span class="o">=</span> <span class="n">brain_surface</span><span class="p">[</span><span class="s">&#39;tris&#39;</span><span class="p">]</span>
<span class="n">coord_trans</span> <span class="o">=</span> <span class="n">fwd</span><span class="p">[</span><span class="s">&#39;mri_head_t&#39;</span><span class="p">][</span><span class="s">&#39;trans&#39;</span><span class="p">]</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">coord_trans</span><span class="p">[:</span><span class="mi">3</span><span class="p">,:</span><span class="mi">3</span><span class="p">],</span> <span class="n">points</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">coord_trans</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">triangular_mesh</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
                     <span class="n">faces</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c"># show one cortical surface</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">triangular_mesh</span><span class="p">(</span><span class="n">lh_points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">lh_points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">lh_points</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
                     <span class="n">lh_faces</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>

<span class="c"># show dipole as small cones</span>
<span class="n">dipoles</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">quiver3d</span><span class="p">(</span><span class="n">pos</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>
                        <span class="n">ori</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">ori</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">ori</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>
                        <span class="n">opacity</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">4e-4</span><span class="p">,</span> <span class="n">scalars</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
                        <span class="n">mode</span><span class="o">=</span><span class="s">&#39;cone&#39;</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">dipoles</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Dipole fit time (ms)&#39;</span><span class="p">)</span>

<span class="c"># proper 3D orientation</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">get_engine</span><span class="p">()</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">x_plus_view</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Total running time of the example:</strong>    0 seconds</p>
<div class="social-button-container">
    <div class="social-button">
        <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    </div>
    <div class="social-button">
        <g:plusone annotation="inline" width="120" size="medium"></g:plusone>
    </div>
    <div class="social-button">
        <div id="fb-root"></div>
        <script>(function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
            fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script>
        <div class="fb-like" data-send="false" data-width="450" data-show-faces="false"></div>
    </div>
</div></div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2012-2015, MNE Developers.<br/>
    </p>
  </div>
</footer>
  </body>
</html>